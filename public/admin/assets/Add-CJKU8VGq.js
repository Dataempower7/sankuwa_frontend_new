import{d as Q,r as i,b as $,ab as H,o as J,f as n,g as K,h as r,i as k,k as u,l as c,z as a,m as o,L as W,j as B,Q as m,t as y,O as X,P as I}from"./index-B52YIGC0.js";import"./index-KjhYqCTY.js";import{F as Y}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import"./vuedraggable.umd-BauR0rTv.js";import{g as Z}from"./merchant-DFkOu60N.js";import{e as ee,u as te}from"./shop-CBisV8Of.js";import{S as F}from"./StatusDot-DuKP0Xmc.js";import{_ as ae}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./format-BxqOrW-w.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";/* empty css                                                                    */const oe={class:"container"},se={class:"content_wrapper"},le={class:"lyecs-form-table"},re={class:"ssdw"},Ie=Q({__name:"Add",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(M,{expose:q,emit:R}){const p=R,d=M,f=i(!1),x=$().currentRoute.value.query,S=i(d.isDialog?d.act:String(x.act)),_=i(d.isDialog?d.id:Number(x.id)),T=S.value==="add"?"create":"update",L=H(),w=i(!1),s=i({shopType:1,merchantId:Number(x.id)}),G=async()=>{try{const t=await ee(S.value,{shopId:_.value});Object.assign(s.value,t)}catch(t){I.error(t.message),p("close")}finally{f.value=!1}},j=async()=>{try{const t=await Z({merchantId:_.value});s.value.merchantId=_.value,v.value=t.records}catch(t){I.error(t.message),p("close")}finally{f.value=!1}},v=i([]),A=async t=>{v.value=t.merchant,s.value.merchantId=t.merchantId};J(()=>{T==="update"&&G(),v.value=[],s.value.merchantId=0,_.value!=0&&(w.value=!0,j())});const D=async()=>{await L.value.validate();try{p("update:confirmLoading",!0);const t=await te(T,{id:_.value,...s.value});p("submitCallback",t),I.success("操作成功")}catch(t){I.error(t.message)}finally{p("update:confirmLoading",!1)}};return q({onFormSubmit:()=>{D()}}),(t,l)=>{const E=n("TigInput"),g=n("el-form-item"),N=n("el-button"),C=n("Tag"),b=n("el-table-column"),U=n("el-table"),z=n("el-form"),P=n("a-spin");return r(),K("div",oe,[k("div",se,[k("div",le,[f.value?c("",!0):(r(),u(z,{key:0,ref_key:"formRef",ref:L,model:s.value,"label-width":"auto"},{default:o(()=>[a(g,{label:"店铺名称",prop:"shopTitle",rules:[{required:!0,message:"店铺名称不能为空!"}]},{default:o(()=>[a(E,{classType:"tig-form-input",modelValue:s.value.shopTitle,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.shopTitle=e)},null,8,["modelValue"])]),_:1}),a(g,{label:"店铺LOGO",prop:"shopLogo",rules:[{required:!0,message:"请上传店铺LOGO!"}]},{default:o(()=>[f.value?c("",!0):(r(),u(B(Y),{key:0,photo:s.value.shopLogo,"onUpdate:photo":l[1]||(l[1]=e=>s.value.shopLogo=e)},null,8,["photo"])),l[2]||(l[2]=k("div",{class:"extra"},"请统一上传比例为2:1的图片，宽200px，高100px（高清）",-1))]),_:1}),a(g,{label:"所属商户",prop:"merchantId",rules:[{required:!0,message:"请选择所属商户!"}]},{default:o(()=>[w.value?c("",!0):(r(),u(B(ae),{key:0,params:{isMultiple:!1,selectedIds:[s.value.merchantId]},isDrawer:"",path:"adminMerchant/merchant/src/SelectMerchant",title:"选择商户",width:"900px",onOkCallback:A},{default:o(()=>[a(N,{type:"primary"},{default:o(()=>[...l[3]||(l[3]=[m("选择商户",-1)])]),_:1})]),_:1},8,["params"])),v.value.length>0?(r(),u(U,{key:1,data:v.value,"row-key":"merchantId",class:"mt10"},{default:o(()=>[a(b,{label:"商户所属单位"},{default:o(({row:e})=>[k("div",re,[e.type==1?(r(),u(C,{key:0,transparent:!0,text:"个人"})):(r(),u(C,{key:1,color:"#409EFF",transparent:!1,text:"企业"})),m(" "+y(e.type==1?""+e.corporateName:""+e.companyName),1)])]),_:1}),a(b,{label:"商户所属会员(ID)"},{default:o(({row:e})=>{var h,O,V;return[m(y((h=e.user)==null?void 0:h.username)+y((O=e.user)!=null&&O.userId?"("+((V=e.user)==null?void 0:V.userId)+")":""),1)]}),_:1}),a(b,{label:"商户类型",prop:"typeText",sortable:"custom"}),a(b,{label:"管理员",sortable:"custom"},{default:o(({row:e})=>{var h;return[m(y(((h=e.admin)==null?void 0:h.username)||"--"),1)]}),_:1}),a(b,{label:"认证状态",prop:"statusText",sortable:"custom"},{default:o(({row:e})=>[e.status==1?(r(),u(F,{key:0,color:"#52c41a",flicker:!0})):c("",!0),e.status==2?(r(),u(F,{key:1,color:"#f5222d",flicker:!1})):c("",!0),m(" "+y(e.statusText),1)]),_:1})]),_:1},8,["data"])):c("",!0)]),_:1}),W(a(g,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(N,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:D},{default:o(()=>[...l[4]||(l[4]=[m("提交",-1)])]),_:1},512)]),_:1},512),[[X,!d.isDialog]])]),_:1},8,["model"])),a(P,{spinning:f.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{Ie as default};

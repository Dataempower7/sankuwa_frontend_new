import{d as $,v as E,x as D,r as u,as as H,o as O,H as Q,f as I,g as a,h as s,z as C,m as x,i as o,F as z,p as S,l as d,j as N,A as q,n as A,t as g,k as G,Q as J,P as K,_ as W}from"./index-B52YIGC0.js";/* empty css                                                                    */import{P as X}from"./Pagination-C8J7-6Em.js";import Y from"./Collapse-2FXy6Pj8.js";import{a as Z,b as ee,c as te}from"./adminMsg-BS0ZiVYJ.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./format-BxqOrW-w.js";import"./order-BVunCi_y.js";import"./DetailBtn.vue_vue_type_script_setup_true_lang-BJTr0sSw.js";import"./index-KjhYqCTY.js";import"./index-C9ZdVeVx.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./aftersales-Bt16NHXV.js";const se="/admin/assets/empty-bg-CEmUzxL0.png",ae={class:"message_center"},ne={class:"tab_box tab_box1"},oe=["onClick"],le={key:0,class:"num"},ue=["onClick"],ie={key:0,class:"num"},ce={class:"tab_box tab_box2"},re=["onClick"],de={key:0,class:"num"},pe={class:"list_box"},ge={style:{"min-height":"200px"}},me={key:0,class:"item"},ve={key:1,class:"table-empty"},_e={key:0,class:"pagination-con"},ye={class:"btn"},he=$({__name:"AdminMsg",emits:["callback","update:confirmLoading","close"],setup(Ce,{emit:w}){const B=E(),f=w,P=D(),p=u([]),b=u([]),i=u(0),v=u(0),_=u(!0),y=u(!0),l=H({page:1,size:P.get("pageSize"),msgType:11}),c=u([]),k=u(0),m=async()=>{f("callback"),y.value=!0;try{const t=await Z({...l}),n=await ee();c.value=t.records,p.value=n,b.value=T(p.value[i.value].child),k.value=t.total,_.value=!1}catch(t){K.error(t.message)}finally{y.value=!1}},R=()=>{f("close")};O(()=>{localStorage.setItem("lastOpenTime",String(Q().unix())),m()});const U=async()=>{await te(),f("callback",!1),m()},L=t=>{i.value=t,v.value=0,c.value.length=0,l.msgType=T(p.value[i.value].child)[0].msgType,m()},V=t=>{l.page=1,v.value=t,c.value.length=0,l.msgType=T(p.value[i.value].child)[t].msgType,m()},j=()=>{p.value[i.value].unreadCount-=1,b.value[v.value].unreadCount-=1,B.messageCount-=1},T=t=>{if(typeof t=="object"){var n=[];for(let h in t)n.push(t[h]);return n}else return t};return(t,n)=>{const h=I("a-spin"),F=I("el-button");return s(),a("div",null,[C(h,{spinning:_.value},{default:x(()=>[o("div",ae,[o("div",ne,[(s(!0),a(z,null,S(p.value,(e,r)=>(s(),a("div",null,[e.catId==4&&N(q)()?(s(),a("div",{key:0,class:A(["tab",i.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,g(e.catName),1),e.unreadCount>0?(s(),a("p",le,g(e.unreadCount),1)):d("",!0)],10,oe)):e.catId!=4?(s(),a("div",{key:1,class:A(["tab",i.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,g(e.catName),1),e.unreadCount>0?(s(),a("p",ie,g(e.unreadCount),1)):d("",!0)],10,ue)):d("",!0)]))),256))]),o("div",ce,[(s(!0),a(z,null,S(b.value,(e,r)=>(s(),a("div",{class:A(["tab",v.value==r?"current":""]),onClick:M=>V(r)},[o("p",null,g(e.name),1),e.unreadCount>0?(s(),a("p",de,g(e.unreadCount),1)):d("",!0)],10,re))),256))]),o("div",pe,[C(h,{spinning:y.value&&!_.value,style:{width:"100%"}},{default:x(()=>[o("div",ge,[c.value.length>0?(s(),a("div",me,[(s(!0),a(z,null,S(c.value,e=>(s(),G(Y,{item:e,msgType:e.msgType,key:e.msgType,onSetReadedCallback:j,onClose:R},null,8,["item","msgType"]))),128))])):d("",!0),c.value.length===0&&!y.value&&!_.value?(s(),a("div",ve,[...n[2]||(n[2]=[o("img",{src:se,alt:""},null,-1),o("p",null,"当前暂无消息哟",-1)])])):d("",!0)])]),_:1},8,["spinning"]),c.value.length>0&&k.value>0?(s(),a("div",_e,[C(N(X),{page:l.page,"onUpdate:page":n[0]||(n[0]=e=>l.page=e),size:l.size,"onUpdate:size":n[1]||(n[1]=e=>l.size=e),background:!1,total:k.value,onCallback:m},null,8,["page","size","total"])])):d("",!0)]),o("div",ye,[C(F,{onClick:U},{default:x(()=>[...n[3]||(n[3]=[J("全部已读",-1)])]),_:1})])])]),_:1},8,["spinning"])])}}}),Be=W(he,[["__scopeId","data-v-3a60cb71"]]);export{Be as default};

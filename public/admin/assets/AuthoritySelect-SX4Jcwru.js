import{d as $,r as U,c as j,o as G,e as S,f,g as i,F as V,z as h,h as m,k as z,l as r,m as w,t as A,j as C,L as D,i as K,a4 as M,e9 as P,K as ee,_ as te}from"./index-BLXOA87U.js";const le={class:"right-body"},ne={class:"title"},oe={class:"left-div"},se={class:"left-div"},de={style:{"font-weight":"500"}},ae={class:"right-div"},ie={class:"ml10"},re={style:{"font-weight":"500"}},ue={key:1},ce={key:0,class:"child-box flex"},he={class:"flex align-center"},me={style:{"font-weight":"500"}},fe={key:1},_e=$({__name:"AuthoritySelect",props:{modelValue:{type:Array,default:[]}},emits:["update:modelValue"],setup(T,{emit:q}){const u=T,v=U(!0);U(!1);const H=j(()=>u.modelValue.includes("all")),J=j(()=>u.modelValue.length>0&&!u.modelValue.includes("all")),O=e=>{console.log(e),e===!1?k("update:modelValue",[]):k("update:modelValue",["all"])},N=()=>u.modelValue.includes("all")?Q(x.value):u.modelValue,Q=e=>{const n=[],t=o=>{o.forEach(l=>{var s,c;l.authoritySn&&n.push(l.authoritySn),(s=l.childAuth)!=null&&s.length&&l.childAuth.forEach(g=>{g.authSn&&n.push(g.authSn)}),(c=l.children)!=null&&c.length&&t(l.children)})};return t(e),n},y=e=>{var t;let n=[e.authoritySn];if(e.children&&e.children.length>0)e.children.forEach(o=>{var s;const l=((s=o.childAuth)==null?void 0:s.map(c=>c.authSn))||[];n.push(...l,...y(o))});else{const o=((t=e.childAuth)==null?void 0:t.map(l=>l.authSn))||[];n.push(...o)}return n},R=(e,n)=>{let t=[];t=N();const o=y(n);e===!1?t=t.filter(l=>!o.includes(l)):t=Array.from(new Set([...t,...o])),k("update:modelValue",t)},W=e=>u.modelValue.includes("all")?!0:y(e).every(t=>u.modelValue.includes(t)),X=e=>{const n=y(e);return!n.every(t=>u.modelValue.includes(t))&&n.some(t=>u.modelValue.includes(t))},b=(e,n,t,o)=>{let l=[];l=N();const s=y(n);e===!1?(l=l.filter(c=>!s.includes(c)),l.length<=2&&(l=l.filter(c=>!t.authoritySn.includes(c)),o&&(l=l.filter(c=>!o.authoritySn.includes(c))))):(l=Array.from(new Set([t.authoritySn,...l,...s])),o&&(l=Array.from(new Set([o.authoritySn,...l])))),k("update:modelValue",l)},B=e=>u.modelValue.includes("all")?!0:y(e).every(t=>u.modelValue.includes(t)),E=e=>{const n=y(e);return!n.every(t=>u.modelValue.includes(t))&&n.some(t=>u.modelValue.includes(t))},L=e=>!!(u.modelValue.includes("all")||u.modelValue.includes(e.authSn)),I=(e,n,t,o,l)=>{let s=[];s=N(),e===!1?s=s.filter(c=>c!==n.authSn):(s=Array.from(new Set([...s,n.authSn,t.authoritySn,o.authoritySn])),l&&(console.log(s),s=Array.from(new Set([...s,l.authoritySn])))),console.log(s),k("update:modelValue",s)},k=q,x=U([]),Y=async()=>{try{const e=await P({type:1});x.value=e}catch(e){ee.error(e.message)}finally{v.value=!1}};return G(()=>{Y().then(()=>{})}),(e,n)=>{const t=S("el-form"),o=S("el-checkbox"),l=S("a-spin"),s=S("el-icon"),c=S("el-dropdown-item"),g=S("el-dropdown-menu"),F=S("el-dropdown");return i(),f(V,null,[h(t,{"label-width":"auto"}),m("div",le,[m("div",ne,[m("div",oe,[h(o,{"model-value":H.value,"onUpdate:modelValue":O,indeterminate:J.value},{default:r(()=>n[0]||(n[0]=[m("span",{style:{"font-weight":"500"}},"全选",-1)])),_:1,__:[0]},8,["model-value","indeterminate"])]),n[1]||(n[1]=m("div",{class:"right-div"},"权限列表",-1))]),h(l,{spinning:v.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"]),v.value?z("",!0):(i(!0),f(V,{key:0},w(x.value,_=>(i(),f("div",{key:_.authorityId,class:"info"},[m("div",se,[h(o,{"model-value":W(_),indeterminate:X(_),"onUpdate:modelValue":d=>R(d,_)},{default:r(()=>[m("span",de,A(_.authorityName),1)]),_:2},1032,["model-value","indeterminate","onUpdate:modelValue"])]),m("div",ae,[(i(!0),f(V,null,w(_.children,d=>(i(),f("div",{class:"child-div mb10",key:d.authorityId},[m("div",ie,[h(o,{indeterminate:E(d),"model-value":B(d),"onUpdate:modelValue":a=>b(a,d,_)},{default:r(()=>[d.childAuth&&d.childAuth.length>0?(i(),C(F,{key:0,"hide-on-click":!1},{dropdown:r(()=>[h(g,null,{default:r(()=>[(i(!0),f(V,null,w(d.childAuth,a=>(i(),C(c,{onClick:()=>{}},{default:r(()=>[h(o,{style:{width:"100%"},"model-value":L(a),"onUpdate:modelValue":p=>I(p,a,d,_)},{default:r(()=>[m("span",re,A(a.authName),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:2},1024)]),default:r(()=>[m("span",null,[D(A(d.authorityName),1),h(s,{class:"el-icon--right"},{default:r(()=>[h(K(M))]),_:1})])]),_:2},1024)):(i(),f("span",ue,A(d.authorityName),1))]),_:2},1032,["indeterminate","model-value","onUpdate:modelValue"])]),d.children&&d.children.length>0?(i(),f("div",ce,[(i(!0),f(V,null,w(d.children,a=>(i(),f("div",{class:"child2-div",key:a.authorityId},[h(o,{indeterminate:E(a),"model-value":B(a),"onUpdate:modelValue":p=>b(p,a,d,_)},{default:r(()=>[a.childAuth&&a.childAuth.length>0?(i(),C(F,{key:0,"hide-on-click":!1},{dropdown:r(()=>[h(g,null,{default:r(()=>[(i(!0),f(V,null,w(a.childAuth,p=>(i(),C(c,{onClick:()=>{}},{default:r(()=>[h(o,{style:{width:"100%"},"model-value":L(p),"onUpdate:modelValue":Z=>I(Z,p,a,d,_)},{default:r(()=>[m("span",me,A(p.authName),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:2},1024)]),default:r(()=>[m("div",he,[D(A(a.authorityName),1),h(s,{class:"el-icon--right"},{default:r(()=>[h(K(M))]),_:1})])]),_:2},1024)):(i(),f("span",fe,A(a.authorityName),1))]),_:2},1032,["indeterminate","model-value","onUpdate:modelValue"])]))),128))])):z("",!0)]))),128))])]))),128))])],64)}}}),pe=te(_e,[["__scopeId","data-v-a1d8d12e"]]);export{pe as default};

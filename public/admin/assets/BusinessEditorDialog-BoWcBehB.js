import{d as D,r as n,b as I,ab as F,o as U,P as c,f as h,g as y,h as g,i as N,z as u,m as _,j as V,F as j,p as R,k as q,_ as z}from"./index-B52YIGC0.js";import{_ as L}from"./Editor.vue_vue_type_style_index_0_lang-ChPMQjFJ.js";import{g as M}from"./languagesList-C1QUNmfU.js";import{g as O,f as P}from"./currencyManagement-DNysi_dA.js";import"./index.esm-CBYqueH9.js";import"./index-KjhYqCTY.js";import"./index-C9ZdVeVx.js";import"./format-BxqOrW-w.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";const $={class:"container"},A={class:"content_wrapper"},G={class:"lyecs-form-table"},H=D({__name:"BusinessEditorDialog",props:{id:{type:Number,default:0},dataType:{type:Number,default:0},act:{type:String,default:""},translationName:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(C,{expose:k,emit:E}){const r=E,d=n(-1),t=C,m=n(!0),v=I().currentRoute.value.query,p=n(t.isDialog?t.act:String(v.act));n(t.isDialog?t.id:Number(v.id)),p.value,F();const o=n({translationName:t.translationName,dataType:t.dataType,items:[]}),T=a=>{d.value=a};U(()=>{p.value==="detail"?x():(m.value=!1,b())});const x=async()=>{try{const a=await O({dataType:t.dataType,dataId:0,translationName:t.translationName});o.value.items=a.items,b()}catch(a){c.error(a.message),r("close")}finally{m.value=!1}},i=n([]),b=async()=>{try{const a=await M({isEnabled:1,size:-1});a.records.forEach(e=>{e.translationValue=""}),Object.assign(i.value,a.records),p.value==="detail"&&o.value.items.length>0&&o.value.items.forEach(e=>{i.value.forEach(s=>{e.localeId===s.id&&(s.translationValue=e.translationValue)})})}catch(a){c.error(a.message),r("close")}finally{m.value=!1}},B=a=>{let e=[];return a.forEach(s=>{let f={localeId:s.id,translationValue:s.translationValue};e.push(f)}),e},S=async()=>{try{r("update:confirmLoading",!0);const a=await P({dataId:0,...o.value,items:B(i.value)});r("submitCallback",a),c.success("操作成功")}catch(a){c.error(a.message)}finally{r("update:confirmLoading",!1)}};return k({onFormSubmit:()=>{S()}}),(a,e)=>{const s=h("el-tab-pane"),f=h("el-tabs");return g(),y("div",$,[N("div",A,[N("div",G,[u(f,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),type:"card",class:"demo-tabs",onTabClick:T},{default:_(()=>[u(s,{label:"原文",name:-1},{default:_(()=>[u(V(L),{html:o.value.translationName,"onUpdate:html":e[0]||(e[0]=l=>o.value.translationName=l),height:"400px"},null,8,["html"])]),_:1}),(g(!0),y(j,null,R(i.value,l=>(g(),q(s,{label:l.language,name:l.id},{default:_(()=>[u(V(L),{html:l.translationValue,"onUpdate:html":w=>l.translationValue=w,height:"400px"},null,8,["html","onUpdate:html"])]),_:2},1032,["label","name"]))),256))]),_:1},8,["modelValue"])])])])}}}),sa=z(H,[["__scopeId","data-v-34739cc6"]]);export{sa as default};

import{d as D,r as n,a as I,a2 as F,o as U,K as c,e as b,f as y,g,h as N,z as u,l as _,i as V,F as j,m as R,j as q,_ as z}from"./index-BLXOA87U.js";import{_ as L}from"./Editor.vue_vue_type_style_index_0_lang-DAwN4rRQ.js";import{g as K}from"./languagesList-g8H0RafD.js";import{g as M,f as O}from"./currencyManagement-ZKRxsK3T.js";import"./index.esm-BvrkUkzo.js";import"./index-DpgvsnVO.js";import"./index-B16C4gX_.js";import"./format-DdZABYp4.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";const $={class:"container"},A={class:"content_wrapper"},G={class:"lyecs-form-table"},H=D({__name:"BusinessEditorDialog",props:{id:{type:Number,default:0},dataType:{type:Number,default:0},act:{type:String,default:""},translationName:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(C,{expose:E,emit:T}){const r=T,d=n(-1),t=C,m=n(!0),v=I().currentRoute.value.query,p=n(t.isDialog?t.act:String(v.act));n(t.isDialog?t.id:Number(v.id)),p.value,F();const o=n({translationName:t.translationName,dataType:t.dataType,items:[]}),k=a=>{d.value=a};U(()=>{p.value==="detail"?x():(m.value=!1,h())});const x=async()=>{try{const a=await M({dataType:t.dataType,dataId:0,translationName:t.translationName});o.value.items=a.items,h()}catch(a){c.error(a.message),r("close")}finally{m.value=!1}},i=n([]),h=async()=>{try{const a=await K({isEnabled:1,size:-1});a.records.forEach(e=>{e.translationValue=""}),Object.assign(i.value,a.records),p.value==="detail"&&o.value.items.length>0&&o.value.items.forEach(e=>{i.value.forEach(s=>{e.localeId===s.id&&(s.translationValue=e.translationValue)})})}catch(a){c.error(a.message),r("close")}finally{m.value=!1}},B=a=>{let e=[];return a.forEach(s=>{let f={localeId:s.id,translationValue:s.translationValue};e.push(f)}),e},S=async()=>{try{r("update:confirmLoading",!0);const a=await O({dataId:0,...o.value,items:B(i.value)});r("submitCallback",a),c.success("操作成功")}catch(a){c.error(a.message)}finally{r("update:confirmLoading",!1)}};return E({onFormSubmit:()=>{S()}}),(a,e)=>{const s=b("el-tab-pane"),f=b("el-tabs");return g(),y("div",$,[N("div",A,[N("div",G,[u(f,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),type:"card",class:"demo-tabs",onTabClick:k},{default:_(()=>[u(s,{label:"原文",name:-1},{default:_(()=>[u(V(L),{html:o.value.translationName,"onUpdate:html":e[0]||(e[0]=l=>o.value.translationName=l),height:"400px"},null,8,["html"])]),_:1}),(g(!0),y(j,null,R(i.value,l=>(g(),q(s,{label:l.language,name:l.id},{default:_(()=>[u(V(L),{html:l.translationValue,"onUpdate:html":w=>l.translationValue=w,height:"400px"},null,8,["html","onUpdate:html"])]),_:2},1032,["label","name"]))),256))]),_:1},8,["modelValue"])])])])}}}),sa=z(H,[["__scopeId","data-v-34739cc6"]]);export{sa as default};

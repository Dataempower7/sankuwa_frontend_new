import{F as E}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-DfcXXcrS.js";import"./index-DpgvsnVO.js";import"./vuedraggable.umd-OAFqtEpj.js";import{i as D}from"./format-DdZABYp4.js";import{d as F,r as i,a as R,a2 as j,o as q,K as f,e as c,f as z,g as V,h as l,j as U,k as A,l as m,z as s,i as w,_ as G}from"./index-BLXOA87U.js";import{g as K}from"./languagesList-g8H0RafD.js";import{g as M,f as O}from"./currencyManagement-ZKRxsK3T.js";import"./Image.vue_vue_type_script_setup_true_lang-BK00jvUw.js";import"./BusinessImg-C3Ug8bC9.js";import"./version-hjn5tnxG.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";import"./index-B16C4gX_.js";const H={class:"container"},J={class:"content_wrapper"},P={class:"lyecs-form-table"},Q={class:"item-image-src"},W={style:{padding:"10px 0"}},X=F({__name:"BusinessImgDialog",props:{id:{type:Number,default:0},dataType:{type:Number,default:0},act:{type:String,default:""},translationName:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(g,{expose:L,emit:k}){const r=k,t=g,u=i(!0),v=R().currentRoute.value.query,_=i(t.isDialog?t.act:String(v.act));i(t.isDialog?t.id:Number(v.id)),_.value;const y=j(),n=i({translationName:t.translationName,dataType:t.dataType,items:[]});q(()=>{_.value==="detail"?C():(u.value=!1,b())});const C=async()=>{try{const e=await M({dataType:t.dataType,dataId:0,translationName:t.translationName});n.value.items=e.items,b()}catch(e){f.error(e.message),r("close")}finally{u.value=!1}},d=i([]),b=async()=>{try{const e=await K({isEnabled:1,size:-1});e.records.forEach(a=>{a.translationValue=""}),Object.assign(d.value,e.records),_.value==="detail"&&n.value.items.length>0&&n.value.items.forEach(a=>{d.value.forEach(o=>{a.localeId===o.id&&(o.translationValue=a.translationValue)})})}catch(e){f.error(e.message),r("close")}finally{u.value=!1}},x=e=>{let a=[];return e.forEach(o=>{let p={localeId:o.id,translationValue:o.translationValue};a.push(p)}),a},B=async()=>{await y.value.validate();try{r("update:confirmLoading",!0);const e=await O({dataId:0,...n.value,items:x(d.value)});r("submitCallback",e),f.success("操作成功")}catch(e){f.error(e.message)}finally{r("update:confirmLoading",!1)}};return L({onFormSubmit:()=>{B()}}),(e,a)=>{const o=c("el-image"),p=c("el-form-item"),h=c("el-table-column"),I=c("el-table"),S=c("el-form");return V(),z("div",H,[l("div",J,[l("div",P,[u.value?A("",!0):(V(),U(S,{key:0,ref_key:"formRef",ref:y,model:n.value,"label-width":"auto"},{default:m(()=>[s(p,{prop:"translationName",label:"原图："},{default:m(()=>[l("div",null,[l("div",Q,[s(o,{class:"item-image",src:w(D)(g.translationName),fit:"scale-down"},null,8,["src"])]),a[0]||(a[0]=l("div",{class:"extra"},"如果未设置单独语言图片，则默认使用原图。",-1))])]),_:1}),s(p,{prop:"language",label:"翻译图片："},{default:m(()=>[s(I,{data:d.value,style:{width:"100%"}},{default:m(()=>[s(h,{prop:"language",label:"语言",width:"180"}),s(h,{prop:"translationValue",label:"翻译图片"},{default:m(({row:N})=>[l("div",W,[s(w(E),{photo:N.translationValue,"onUpdate:photo":T=>N.translationValue=T},null,8,["photo","onUpdate:photo"])])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"]))])])])}}}),me=G(X,[["__scopeId","data-v-e101f291"]]);export{me as default};

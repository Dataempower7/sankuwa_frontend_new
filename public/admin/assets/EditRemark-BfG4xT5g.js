import{d as B,r as u,b as O,ab as R,o as D,P as m,f as l,g as I,h as y,i as N,k as L,l as T,z as n,m as c,L as j,Q as q,O as E}from"./index-B52YIGC0.js";import{d as F,p as z,s as A}from"./order-BVunCi_y.js";const M={class:"container"},P={class:"content_wrapper"},Q={class:"lyecs-form-table"},H=B({__name:"EditRemark",props:{id:{type:Number,default:0},act:{type:String,default:""},valueName:{type:String,default:""},form:{type:Object,default:()=>({})},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(r,{expose:w,emit:h}){const s=h,e=r,i=u(!0),p=O().currentRoute.value.query,f=u(e.isDialog?e.act:String(p.act)),d=u(e.isDialog?e.id:Number(p.id));f.value;const v=R(),a=u(e.form);D(()=>{k()});const k=async()=>{try{i.value=!0;const t=await F(f.value,{id:d.value});Object.assign(a.value,t)}catch(t){m.error(t.message),s("close")}finally{i.value=!1}},g=async()=>{await v.value.validate();try{if(s("update:confirmLoading",!0),e.valueName=="addNote"){const t=await z({orderId:d.value,orderSn:a.value.orderSn,shopId:a.value.shopId,description:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}if(e.valueName=="adminNote"){const t=await A({id:d.value,adminNote:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}}catch(t){m.error(t.message)}finally{s("update:confirmLoading",!1)}};return w({onFormSubmit:()=>{g()}}),(t,o)=>{const S=l("TigInput"),b=l("el-form-item"),x=l("el-button"),C=l("el-form"),V=l("a-spin");return y(),I("div",M,[N("div",P,[N("div",Q,[i.value?T("",!0):(y(),L(C,{key:0,ref_key:"formRef",ref:v,model:a.value,"label-width":"auto"},{default:c(()=>[n(b,{label:"备注",prop:r.valueName},{default:c(()=>[n(S,{classType:"tig-form-input",modelValue:a.value[r.valueName],"onUpdate:modelValue":o[0]||(o[0]=_=>a.value[r.valueName]=_),rows:4,placeholder:"请输入备注",type:"textarea","show-word-limit":"",maxlength:200},null,8,["modelValue"])]),_:1},8,["prop"]),j(n(b,{"wrapper-col":{offset:4,span:16}},{default:c(()=>[n(x,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:o[1]||(o[1]=_=>g())},{default:c(()=>[...o[2]||(o[2]=[q("提交 ",-1)])]),_:1},512)]),_:1},512),[[E,!e.isDialog]])]),_:1},8,["model"])),n(V,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{H as default};

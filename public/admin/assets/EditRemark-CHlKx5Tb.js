import{d as B,r as u,a as R,a2 as D,o as I,K as m,e as l,f as L,g as y,h as N,j as O,k as T,z as n,l as c,G as j,L as q,J as E}from"./index-BLXOA87U.js";import{c as F,n as z,s as A}from"./order-na2xscMr.js";const G={class:"container"},J={class:"content_wrapper"},K={class:"lyecs-form-table"},H=B({__name:"EditRemark",props:{id:{type:Number,default:0},act:{type:String,default:""},valueName:{type:String,default:""},form:{type:Object,default:()=>({})},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(r,{expose:w,emit:h}){const s=h,e=r,i=u(!0),p=R().currentRoute.value.query,f=u(e.isDialog?e.act:String(p.act)),d=u(e.isDialog?e.id:Number(p.id));f.value;const v=D(),a=u(e.form);I(()=>{k()});const k=async()=>{try{i.value=!0;const t=await F(f.value,{id:d.value});Object.assign(a.value,t)}catch(t){m.error(t.message),s("close")}finally{i.value=!1}},g=async()=>{await v.value.validate();try{if(s("update:confirmLoading",!0),e.valueName=="addNote"){const t=await z({orderId:d.value,orderSn:a.value.orderSn,shopId:a.value.shopId,description:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}if(e.valueName=="adminNote"){const t=await A({id:d.value,adminNote:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}}catch(t){m.error(t.message)}finally{s("update:confirmLoading",!1)}};return w({onFormSubmit:()=>{g()}}),(t,o)=>{const S=l("TigInput"),_=l("el-form-item"),x=l("el-button"),C=l("el-form"),V=l("a-spin");return y(),L("div",G,[N("div",J,[N("div",K,[i.value?T("",!0):(y(),O(C,{key:0,ref_key:"formRef",ref:v,model:a.value,"label-width":"auto"},{default:c(()=>[n(_,{label:"备注",prop:r.valueName},{default:c(()=>[n(S,{classType:"tig-form-input",modelValue:a.value[r.valueName],"onUpdate:modelValue":o[0]||(o[0]=b=>a.value[r.valueName]=b),rows:4,placeholder:"请输入备注",type:"textarea","show-word-limit":"",maxlength:200},null,8,["modelValue"])]),_:1},8,["prop"]),j(n(_,{"wrapper-col":{offset:4,span:16}},{default:c(()=>[n(x,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:o[1]||(o[1]=b=>g())},{default:c(()=>o[2]||(o[2]=[q("提交 ",-1)])),_:1,__:[2]},512)]),_:1},512),[[E,!e.isDialog]])]),_:1},8,["model"])),n(V,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{H as default};

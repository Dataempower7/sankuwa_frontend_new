import"./index-KjhYqCTY.js";import{i as M}from"./format-BxqOrW-w.js";/* empty css                                                                    */import{P as re}from"./Pagination-C8J7-6Em.js";import{u as ce}from"./gallery-DcB9WyRo.js";import{h as H,i as ve,j as ue,k as pe}from"./gallery-BnfhcmY9.js";import{d as me,r as f,a5 as ye,c as fe,Y as _e,o as ge,P as k,f as p,g as c,h as n,i as l,l as m,n as $,j as a,F as L,p as z,t as h,z as i,m as d,Q as E,k as N,_ as ke}from"./index-B52YIGC0.js";import{_ as C}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import{M as be}from"./index-C9ZdVeVx.js";const Ce={class:"gallery_warp",id:"gallery_warp"},Ge={class:"lyecs_gallery_box"},Ie={class:"gallery-folder-warp"},Ve={class:"gallery-folder-list"},he=["onClick"],we={class:"item-name"},xe={class:"folder-item-edit"},Oe={class:"add-gallery-folder-con"},$e={class:"gallery-pics-warp"},Le={class:"gallery-main",id:"gallery-main"},ze={class:"gallery-pic-action"},Ee={class:"gallery-pic-action-l"},Ne={class:"gallery-pic-action-r"},Se={class:"gallery-list",suppressScrollX:!1},Te={key:0,class:"gallery-list-item"},Fe=["onClick"],Ue={key:0,class:"video-empty"},Be={class:"flex",style:{padding:"5px",gap:"5px"}},Me={class:"video-actions"},Re={class:"desc"},je={key:1,class:"gallery-list-ul"},De=["onClick"],Qe={class:"video-item-box-icon"},Xe=["src"],Ye={class:"video-actions"},qe={class:"flex flex-justify-between",style:{width:"100%"}},Ae={class:"duration"},He={class:"flex"},Je={class:"duration"},Ke={class:"desc"},We={key:2,class:"empty-warp"},Ze={key:0,class:"empty-bg"},Pe={class:"gallery-list-page"},el=me({__name:"GalleryVideo",props:{isMultiple:{type:Boolean,default:!1}},emits:["submitCallback","okType"],setup(J,{expose:K,emit:W}){const Z=J,o=ce(),w=f([]),R=f([]),j=f([]),D=f(),_=f({}),G=f([]),{isMultiple:P}=ye(Z),y=f([]),S=f(6),x=f(!0),g=fe(()=>j.value.concat(R.value)),I=async s=>{try{const e=await H({galleryId:s});Object.assign(w.value,e.records),u(s,o.page),T()}catch(e){k.error(e.message)}};_e(()=>o.isRefresh,s=>{s&&(o.isRefresh=!1,I(o.videoGalleryId))}),ge(()=>{o.page=1,o.videoGalleryId=0,o.topVideoGalleryId=0,T()});const T=async()=>{try{const s=await H({galleryId:0});w.value=s.records,u(o.videoGalleryId,o.page)}catch(s){k.error(s.message)}},Q=s=>{u(s),o.page=1,o.videoGalleryId=s,o.topVideoGalleryId=s},ee=s=>{u(o.videoGalleryId,s)},u=async(s,e=1)=>{x.value=!0,o.page=e;try{const r=await ve({id:s,page:e,sortOrder:o.sortOrder,size:S.value});j.value=[],R.value=r.galleryVideoInfoPage.records,G.value=r.childGalleryList,D.value=r.galleryVideoInfoPage.total,o.videoGalleryId=s,_.value=r.galleryVideo}catch(r){k.error(r.message)}finally{x.value=!1}},le=s=>{o.sortOrder=s,u(o.videoGalleryId)},F=(s,e)=>{e==!0?I(o.videoGalleryId):u(o.videoGalleryId)},U=s=>{s==0?I(o.videoGalleryId):u(o.videoGalleryId)},te=async s=>{try{const e=await ue({id:s});k.success("操作成功"),o.topVideoGalleryId=0,o.videoGalleryId=0,I(o.videoGalleryId)}catch(e){k.error(e.message)}},X=async(s,e)=>{try{const r=await pe({id:s});k.success("操作成功"),G.value.splice(e,1),o.topVideoGalleryId==s&&(o.topVideoGalleryId=0,o.videoGalleryId=0),I(o.videoGalleryId)}catch(r){k.error(r.message)}},oe=(s,e)=>{be.confirm({title:"您确认要删除所选相册吗？",okType:"danger",onOk(){X(s,e),T()}})},B=W;B("okType",!1);const se=(s,e)=>{let r=!1;if(y.value.length>0)for(let b in y.value)y.value[b].id==s.id&&(g.value[e].selected=!1,y.value.splice(b,1),r=!0);if(r==!1){if(P.value==!1){y.value=[];for(let b in g.value)g.value[b].selected=!1}g.value[e].selected=!0,y.value.push({id:s.id,videoId:s.id,videoCover:s.videoCover,videoUrl:s.videoUrl,videoName:s.videoName,format:s.format})}B("okType",y.value.length>0)};return K({onFormSubmit:()=>{B("submitCallback",y.value)}}),(s,e)=>{const r=p("el-dropdown-item"),b=p("el-dropdown-menu"),ae=p("el-dropdown"),O=p("el-button"),ie=p("el-space"),Y=p("el-option"),de=p("el-select"),q=p("el-image"),A=p("a-popconfirm"),ne=p("a-spin");return n(),c("div",Ce,[l("div",Ge,[l("div",Ie,[l("div",Ve,[w.value?(n(),c("div",{key:0,class:$("gallery-folder-item "+(a(o).topVideoGalleryId==0?"current":"")),onClick:e[0]||(e[0]=t=>Q(0))},[...e[9]||(e[9]=[l("div",{class:"folder-item-con"},[l("i",{class:"item-ico"}),l("div",{class:"item-name"},"全部")],-1)])],2)):m("",!0),(n(!0),c(L,null,z(w.value,(t,V)=>(n(),c("div",{class:$("gallery-folder-item "+(a(o).topVideoGalleryId==t.id?"current":""))},[l("div",{class:$("folder-item-con"),onClick:v=>Q(t.id)},[e[10]||(e[10]=l("i",{class:"item-ico"},null,-1)),l("div",we,h(t.name),1)],8,he),l("div",xe,[i(ae,{trigger:"click"},{dropdown:d(()=>[i(b,null,{default:d(()=>[i(a(C),{width:"400px",onOkCallback:v=>F(t.id,!0),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>[i(r,null,{default:d(()=>[...e[11]||(e[11]=[l("div",null,"编辑相册",-1)])]),_:1})]),_:1},8,["onOkCallback","params"]),i(r,{onClick:v=>oe(t.id,V)},{default:d(()=>[...e[12]||(e[12]=[l("div",null,"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:d(()=>[e[13]||(e[13]=l("i",{title:"编辑",class:"ico-font"},"",-1))]),_:2},1024)])],2))),256))]),l("div",Oe,[i(a(C),{width:"400px",onOkCallback:e[1]||(e[1]=t=>U(0)),title:"添加视频相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:0}},{default:d(()=>[i(O,{class:"add-gallery-folder-btn"},{default:d(()=>[...e[14]||(e[14]=[l("em",null,"+",-1),E(" 添加视频相册",-1)])]),_:1})]),_:1})])]),l("div",$e,[l("div",Le,[l("div",ze,[l("div",Ee,[i(ie,null,{default:d(()=>[i(a(C),{width:"700px",onOkCallback:e[2]||(e[2]=t=>u(a(o).videoGalleryId,a(o).page)),title:"上传视频",path:"gallery/video/VideoEdit",params:{act:"add",galleryId:a(o).videoGalleryId},onCallback:e[3]||(e[3]=t=>U(0))},{default:d(()=>[i(O,{type:"primary"},{default:d(()=>[...e[15]||(e[15]=[E("上传视频",-1)])]),_:1})]),_:1},8,["params"]),_.value&&_.value.parentId>0?(n(),N(O,{key:0,class:"lyecs-btn return-gallery-btn",onClick:e[4]||(e[4]=t=>u(_.value.parentId))},{default:d(()=>[...e[16]||(e[16]=[E("返回上一级",-1)])]),_:1})):m("",!0),_.value&&a(o).videoGalleryId>0?(n(),N(a(C),{key:1,width:"400px",onOkCallback:e[5]||(e[5]=t=>U(_.value.id)),title:"添加子相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:_.value.id}},{default:d(()=>[i(O,{class:"lyecs-btn add-gallery-btn"},{default:d(()=>[...e[17]||(e[17]=[E("添加子相册",-1)])]),_:1})]),_:1},8,["params"])):m("",!0)]),_:1})]),l("div",Ne,[e[18]||(e[18]=l("span",{style:{"word-break":"keep-all"}},"排序：",-1)),i(de,{onChange:le,class:"a-select-ui gallery_pic_sort",modelValue:a(o).sortOrder,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).sortOrder=t)},{default:d(()=>[i(Y,{label:"时间从先到后",value:"asc"}),i(Y,{label:"时间从后到先",value:"desc"})]),_:1},8,["modelValue"])])]),i(ne,{spinning:x.value},{default:d(()=>[l("div",Se,[G.value.length>0&&a(o).videoGalleryId>0?(n(),c("ul",Te,[(n(!0),c(L,null,z(G.value,(t,V)=>(n(),c("li",{key:t.id,class:"gallery-video-item"},[l("div",{class:"video-item-box",onClick:v=>u(t.id)},[t.galleryVideoInfoList.length==0?(n(),c("span",Ue,"相册为空")):m("",!0),l("div",Be,[(n(!0),c(L,null,z(t.galleryVideoInfoList,(v,tl)=>(n(),N(q,{fit:"cover",class:"gallery_pics",src:a(M)(v.videoCover)},null,8,["src"]))),256))])],8,Fe),l("p",Me,[i(a(C),{width:"400px",onOkCallback:v=>F(t.id,!1),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id,parentId:t.parentId}},{default:d(()=>[...e[19]||(e[19]=[l("a",{class:"btn-edit ico-font"},"",-1)])]),_:1},8,["onOkCallback","params"]),i(A,{title:"您确认要删掉该相册吗？",onConfirm:v=>X(t.id,V),placement:"bottom"},{default:d(()=>[...e[20]||(e[20]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])]),_:1},8,["onConfirm"])]),l("div",Re,h(t.name)+" - 子相册",1)]))),128))])):m("",!0),g.value.length>0?(n(),c("ul",je,[(n(!0),c(L,null,z(g.value,(t,V)=>(n(),c("li",{class:$("gallery-video-item "+(y.value.some(v=>v.id===t.id)?"selected":""))},[l("div",null,[l("div",{class:"video-item-box",onClick:v=>se(t,V)},[l("div",Qe,[i(a(C),{width:"600px",onOkCallback:v=>F(t.id,!1),title:"编辑视频",path:"gallery/video/VideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>[...e[21]||(e[21]=[l("i",{class:"iconfont-admin icon-shipin"},null,-1)])]),_:1},8,["onOkCallback","params"])]),t.videoCover?(n(),N(q,{key:0,fit:"cover",class:"gallery_pics",style:{width:"100%",height:"100%"},src:a(M)(t.videoCover)},null,8,["src"])):m("",!0),t.videoCover?m("",!0):(n(),c("video",{key:1,src:a(M)(t.videoUrl)},null,8,Xe))],8,De),l("div",Ye,[l("div",qe,[l("p",Ae,h(t.duration),1),l("div",He,[l("p",Je,h(t.size),1),i(A,{title:"您确认要删掉该视频吗？",onConfirm:v=>te(t.id),placement:"bottom"},{default:d(()=>[...e[22]||(e[22]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])]),_:1},8,["onConfirm"])])])]),l("div",Ke,h(t.videoName),1),e[23]||(e[23]=l("div",{class:"img-selected-box"},[l("div",{class:"img-selected-box-angle"}),l("div",{class:"img-selected-box-sort ico-font"},"")],-1))])],2))),256))])):m("",!0),g.value.length==0&&G.value.length==0?(n(),c("div",We,[x.value?m("",!0):(n(),c("div",Ze,"暂无数据"))])):m("",!0)]),l("div",Pe,[i(a(re),{page:a(o).page,"onUpdate:page":e[7]||(e[7]=t=>a(o).page=t),size:S.value,"onUpdate:size":e[8]||(e[8]=t=>S.value=t),total:D.value,onCallback:ee,layout:"slot ,prev, pager, next",background:!1},null,8,["page","size","total"])])]),_:1},8,["spinning"])])])])])}}}),ul=ke(el,[["__scopeId","data-v-a809d200"]]);export{ul as default};

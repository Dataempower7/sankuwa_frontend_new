import"./index-DpgvsnVO.js";import{i as M}from"./format-DdZABYp4.js";import{d as re,r as y,a0 as ce,c as ue,o as pe,K as k,e as v,f as c,g as n,h as l,k as m,n as $,i as a,F as L,m as z,t as h,z as i,l as d,L as E,j as N,_ as ve}from"./index-BLXOA87U.js";/* empty css                                                                    */import{P as me}from"./Pagination-w0YHSLYy.js";import{u as _e}from"./gallery-DNIPSvyh.js";import{h as J,i as ye,j as fe,k as ge}from"./gallery-FWj2DHMt.js";import{_ as C}from"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";import{M as ke}from"./index-B16C4gX_.js";const be={class:"gallery_warp",id:"gallery_warp"},Ce={class:"lyecs_gallery_box"},Ie={class:"gallery-folder-warp"},we={class:"gallery-folder-list"},he=["onClick"],xe={class:"item-name"},Ve={class:"folder-item-edit"},Ge={class:"add-gallery-folder-con"},Oe={class:"gallery-pics-warp"},$e={class:"gallery-main",id:"gallery-main"},Le={class:"gallery-pic-action"},ze={class:"gallery-pic-action-l"},Ee={class:"gallery-pic-action-r"},Ne={class:"gallery-list",suppressScrollX:!1},Se={key:0},Te=["onClick"],Fe={key:0,class:"video-empty"},Ue={class:"video-actions"},Be={class:"desc"},Me={key:1,class:"gallery-list-ul"},je=["onClick"],Re={class:"video-item-box-icon"},De=["src"],Ke={class:"video-actions"},Xe={class:"flex flex-justify-between",style:{width:"100%"}},qe={class:"duration"},Ae={class:"flex"},He={class:"duration"},Je={class:"desc"},Qe={key:2,class:"empty-warp"},We={key:0,class:"empty-bg"},Ye={class:"gallery-list-page"},Ze=re({__name:"GalleryVideo",props:{isMultiple:{type:Boolean,default:!1}},emits:["submitCallback","okType"],setup(Q,{expose:W,emit:Y}){const Z=Q,o=_e(),x=y([]),j=y([]),R=y([]),D=y(),f=y({}),I=y([]),{isMultiple:P}=ce(Z),_=y([]),S=y(6),V=y(!0),g=ue(()=>R.value.concat(j.value)),G=async s=>{try{const e=await J({galleryId:s});Object.assign(x.value,e.records),p(s,o.page),T()}catch(e){k.error(e.message)}};pe(()=>{o.page=1,o.galleryId=0,o.topGalleryId=0,T()});const T=async()=>{try{const s=await J({galleryId:0});x.value=s.records,p(o.galleryId,o.page)}catch(s){k.error(s.message)}},K=s=>{p(s),o.page=1,o.topGalleryId=s},ee=s=>{p(o.galleryId,s)},p=async(s,e=1)=>{V.value=!0,o.page=e;try{const r=await ye({id:s,page:e,sortOrder:o.sortOrder,size:S.value});R.value=[],j.value=r.galleryVideoInfoPage.records,I.value=r.childGalleryList,D.value=r.galleryVideoInfoPage.total,o.galleryId=s,f.value=r.galleryVideo}catch(r){k.error(r.message)}finally{V.value=!1}},le=s=>{o.sortOrder=s,p(o.galleryId)},F=(s,e)=>{e==!0?G(o.galleryId):p(o.galleryId)},U=s=>{s==0?G(o.galleryId):p(o.galleryId)},te=async s=>{try{const e=await fe({id:s});k.success("操作成功"),o.topGalleryId=0,o.galleryId=0,G(o.galleryId)}catch(e){k.error(e.message)}},X=async(s,e)=>{try{const r=await ge({id:s});k.success("操作成功"),I.value.splice(e,1),o.galleryId==s&&(o.topGalleryId=0,o.galleryId=0),G(o.galleryId)}catch(r){k.error(r.message)}},oe=(s,e)=>{ke.confirm({title:"您确认要删除所选相册吗？",okType:"danger",onOk(){X(s,e),T()}})},B=Y;B("okType",!1);const se=(s,e)=>{let r=!1;if(_.value.length>0)for(let b in _.value)_.value[b].id==s.id&&(g.value[e].selected=!1,_.value.splice(b,1),r=!0);if(r==!1){if(P.value==!1){_.value=[];for(let b in g.value)g.value[b].selected=!1}g.value[e].selected=!0,_.value.push({id:s.id,videoId:s.id,videoCover:s.videoCover,videoUrl:s.videoUrl,videoName:s.videoName,format:s.format})}B("okType",_.value.length>0)};return W({onFormSubmit:()=>{B("submitCallback",_.value)}}),(s,e)=>{const r=v("el-dropdown-item"),b=v("el-dropdown-menu"),ae=v("el-dropdown"),O=v("el-button"),ie=v("el-space"),q=v("el-option"),de=v("el-select"),A=v("el-image"),H=v("a-popconfirm"),ne=v("a-spin");return n(),c("div",be,[l("div",Ce,[l("div",Ie,[l("div",we,[x.value?(n(),c("div",{key:0,class:$("gallery-folder-item "+(a(o).topGalleryId==0?"current":"")),onClick:e[0]||(e[0]=t=>K(0))},e[9]||(e[9]=[l("div",{class:"folder-item-con"},[l("i",{class:"item-ico"}),l("div",{class:"item-name"},"全部")],-1)]),2)):m("",!0),(n(!0),c(L,null,z(x.value,(t,w)=>(n(),c("div",{class:$("gallery-folder-item "+(a(o).topGalleryId==t.id?"current":""))},[l("div",{class:$("folder-item-con"),onClick:u=>K(t.id)},[e[10]||(e[10]=l("i",{class:"item-ico"},null,-1)),l("div",xe,h(t.name),1)],8,he),l("div",Ve,[i(ae,{trigger:"click"},{dropdown:d(()=>[i(b,null,{default:d(()=>[i(a(C),{width:"400px",onOkCallback:u=>F(t.id,!0),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>[i(r,null,{default:d(()=>e[11]||(e[11]=[l("div",null,"编辑相册",-1)])),_:1,__:[11]})]),_:2},1032,["onOkCallback","params"]),i(r,{onClick:u=>oe(t.id,w)},{default:d(()=>e[12]||(e[12]=[l("div",null,"删除",-1)])),_:2,__:[12]},1032,["onClick"])]),_:2},1024)]),default:d(()=>[e[13]||(e[13]=l("i",{title:"编辑",class:"ico-font"},"",-1))]),_:2,__:[13]},1024)])],2))),256))]),l("div",Ge,[i(a(C),{width:"400px",onOkCallback:e[1]||(e[1]=t=>U(0)),title:"添加视频相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:0}},{default:d(()=>[i(O,{class:"add-gallery-folder-btn"},{default:d(()=>e[14]||(e[14]=[l("em",null,"+",-1),E(" 添加视频相册",-1)])),_:1,__:[14]})]),_:1})])]),l("div",Oe,[l("div",$e,[l("div",Le,[l("div",ze,[i(ie,null,{default:d(()=>[i(a(C),{width:"700px",onOkCallback:e[2]||(e[2]=t=>p(a(o).galleryId,a(o).page)),title:"上传视频",path:"gallery/video/VideoEdit",params:{act:"add"},onCallback:e[3]||(e[3]=t=>U(0))},{default:d(()=>[i(O,{type:"primary"},{default:d(()=>e[15]||(e[15]=[E("上传视频",-1)])),_:1,__:[15]})]),_:1}),f.value&&f.value.parentId>0?(n(),N(O,{key:0,class:"lyecs-btn return-gallery-btn",onClick:e[4]||(e[4]=t=>p(f.value.parentId))},{default:d(()=>e[16]||(e[16]=[E("返回上一级",-1)])),_:1,__:[16]})):m("",!0),f.value&&a(o).galleryId>0?(n(),N(a(C),{key:1,width:"400px",onOkCallback:e[5]||(e[5]=t=>U(f.value.id)),title:"添加子相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:f.value.id}},{default:d(()=>[i(O,{class:"lyecs-btn add-gallery-btn"},{default:d(()=>e[17]||(e[17]=[E("添加子相册",-1)])),_:1,__:[17]})]),_:1},8,["params"])):m("",!0)]),_:1})]),l("div",Ee,[e[18]||(e[18]=l("span",{style:{"word-break":"keep-all"}},"排序：",-1)),i(de,{onChange:le,class:"a-select-ui gallery_pic_sort",modelValue:a(o).sortOrder,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).sortOrder=t)},{default:d(()=>[i(q,{label:"时间从先到后",value:"asc"}),i(q,{label:"时间从后到先",value:"desc"})]),_:1},8,["modelValue"])])]),i(ne,{spinning:V.value},{default:d(()=>[l("div",Ne,[I.value.length>0&&a(o).galleryId>0?(n(),c("ul",Se,[(n(!0),c(L,null,z(I.value,(t,w)=>(n(),c("li",{key:t.id,class:"gallery-video-item"},[l("div",{class:"video-item-box",onClick:u=>p(t.id)},[t.galleryVideoInfoList.length==0?(n(),c("span",Fe,"相册为空")):m("",!0),(n(!0),c(L,null,z(t.galleryVideoInfoList,(u,el)=>(n(),N(A,{fit:"cover",class:"gallery_pics",src:a(M)(u.videoCover)},null,8,["src"]))),256))],8,Te),l("p",Ue,[i(a(C),{width:"400px",onOkCallback:u=>F(t.id,!1),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id,parentId:t.parentId}},{default:d(()=>e[19]||(e[19]=[l("a",{class:"btn-edit ico-font"},"",-1)])),_:2,__:[19]},1032,["onOkCallback","params"]),i(H,{title:"您确认要删掉该相册吗？",onConfirm:u=>X(t.id,w),placement:"bottom"},{default:d(()=>e[20]||(e[20]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2,__:[20]},1032,["onConfirm"])]),l("div",Be,h(t.name),1)]))),128))])):m("",!0),g.value.length>0?(n(),c("ul",Me,[(n(!0),c(L,null,z(g.value,(t,w)=>(n(),c("li",{class:$("gallery-video-item "+(_.value.some(u=>u.id===t.id)?"selected":""))},[l("div",null,[l("div",{class:"video-item-box",onClick:u=>se(t,w)},[l("div",Re,[i(a(C),{width:"600px",onOkCallback:u=>F(t.id,!1),title:"编辑视频",path:"gallery/video/VideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>e[21]||(e[21]=[l("i",{class:"iconfont-admin icon-shipin"},null,-1)])),_:2,__:[21]},1032,["onOkCallback","params"])]),t.videoCover?(n(),N(A,{key:0,fit:"cover",class:"gallery_pics",style:{width:"100%",height:"100%"},src:a(M)(t.videoCover)},null,8,["src"])):m("",!0),t.videoCover?m("",!0):(n(),c("video",{key:1,src:a(M)(t.videoUrl)},null,8,De))],8,je),l("div",Ke,[l("div",Xe,[l("p",qe,h(t.duration),1),l("div",Ae,[l("p",He,h(t.size),1),i(H,{title:"您确认要删掉该视频吗？",onConfirm:u=>te(t.id),placement:"bottom"},{default:d(()=>e[22]||(e[22]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2,__:[22]},1032,["onConfirm"])])])]),l("div",Je,h(t.videoName),1),e[23]||(e[23]=l("div",{class:"img-selected-box"},[l("div",{class:"img-selected-box-angle"}),l("div",{class:"img-selected-box-sort ico-font"},"")],-1))])],2))),256))])):m("",!0),g.value.length==0&&I.value.length==0?(n(),c("div",Qe,[V.value?m("",!0):(n(),c("div",We,"暂无数据"))])):m("",!0)]),l("div",Ye,[i(a(me),{page:a(o).page,"onUpdate:page":e[7]||(e[7]=t=>a(o).page=t),size:S.value,"onUpdate:size":e[8]||(e[8]=t=>S.value=t),total:D.value,onCallback:ee,layout:"slot ,prev, pager, next",background:!1},null,8,["page","size","total"])])]),_:1},8,["spinning"])])])])])}}}),cl=ve(Ze,[["__scopeId","data-v-d9a1e355"]]);export{cl as default};

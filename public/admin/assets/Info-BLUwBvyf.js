import{d as k,aq as q,r as y,ar as L,f as h,g as b,h as m,z as f,i as l,m as g,l as x,t as P,j as N,k as B,Q as R,P as S,_ as C,b as $,ab as F,Y as T,o as j}from"./index-B52YIGC0.js";import{e as E,u as U}from"./buyShow-GI1gwX70.js";import"./index-KjhYqCTY.js";/* empty css                                                                    */import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import{d as z}from"./vuedraggable.umd-BauR0rTv.js";import"./buyShowProductGroupSelect.vue_vue_type_style_index_0_scoped_8e785396_lang-D9c7S773.js";import"./lodash-DLXBIuYo.js";import{g as A}from"./productGroup-DmZc4IJt.js";import{_ as O}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";import"./time-EzYK4E-P.js";const Q={class:"dec-goods-group-item"},Y={class:"dec-edit-group"},H={key:0,class:"productGroupName"},J={class:"gallery-list-warp"},K={class:"dec-pic-group"},W={class:"dec-pic-add-con"},X={key:1,class:"btn-link"},Z=k({__name:"buyShowProductGroupSelect",props:q({productIds:{type:Boolean,default:!1},type:{type:String,default:"goods"},isMultiple:{type:Boolean,default:!1}},{productGroups:{default:[]},productGroupsModifiers:{}}),emits:["update:productGroups"],setup(v){const I=v,G=y([]),r=L(v,"productGroups"),c=async d=>{_(d.ids)},_=async(d,t=-1,i=6)=>{try{const u=await A({productGroupIds:d.join(","),size:i,page:1});r.value=u.records.map(a=>({productGroupId:a.productGroupId,productGroupName:a.productGroupName})),G.value=r.value.map(a=>a.productGroupId)}catch(u){S.error(u.message)}};return(d,t)=>{const i=h("el-button");return m(),b("div",null,[f(N(z),{class:"dec-goods-group-list","item-key":"productGroupId",list:r.value,"ghost-class":"ghost","chosen-class":"chosenClass",animation:"300",onStart:t[0]||(t[0]=()=>{}),onEnd:t[1]||(t[1]=()=>{})},{item:g(({element:u,index:a})=>[l("div",Q,[l("div",Y,[u.productGroupName?(m(),b("div",H,P(u.productGroupName),1)):x("",!0)])])]),_:1},8,["list"]),l("div",J,[l("div",K,[l("div",W,[f(N(O),{isDrawer:"",onOkCallback:c,title:"选择商品分组",width:"600px",path:"product/productGroup/src/SelectProductGroup",params:{selectedIds:G.value,isMultiple:I.isMultiple,buyShowSelectedIds:r.value},style:{width:"100%"}},{default:g(()=>[r.value.length<1?(m(),B(i,{key:0},{default:g(()=>[...t[2]||(t[2]=[R("选择商品分组",-1)])]),_:1})):(m(),b("a",X,"修改"))]),_:1},8,["params"])])])])])}}}),ee=C(Z,[["__scopeId","data-v-8e785396"]]),oe={class:"container"},te={class:"content_wrapper"},re={class:"lyecs-form-table"},ae=k({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isSelf:{type:Number,default:0},examine:{type:Number,default:0},isDialog:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},type:{type:String,default:""}},emits:["submitCallback","update:confirmLoading","close"],setup(v,{expose:I,emit:G}){const r=G,c=v,_=y(!0),d=$().currentRoute.value.query,t=y(c.isDialog?c.act:String(d.act)),i=y(c.isDialog?c.id:Number(d.id)),u=t.value==="add"?"create":"update",a=F(),s=y({}),M=async()=>{try{const o=await E({buyerShowGroupId:i.value}),e=o.groupIds.map((p,n)=>({productGroupId:p,productGroupName:o.productGroupName[n]}));s.value={...o,productGroups:e}}catch(o){S.error(o.message),r("close")}finally{_.value=!1}},V=async()=>{var o;await a.value.validate();try{const e={buyerShowGroupId:i.value,groupName:s.value.groupName,groupIds:(o=s.value.productGroups)==null?void 0:o.map(n=>n.productGroupId)};t.value==="add"&&delete e.buyerShowGroupId,r("update:confirmLoading",!0);const p=await U(u,e);r("submitCallback",p),S.success("操作成功")}catch(e){S.error(e.message)}finally{r("update:confirmLoading",!1)}};return I({onFormSubmit:()=>{V()}}),T(()=>s.value.productGroups,o=>{var e,p;(o==null?void 0:o.length)>0?(e=a.value)==null||e.clearValidate("productGroups"):(p=a.value)==null||p.validateField("productGroups")}),j(()=>{t.value==="detail"?M():_.value=!1}),(o,e)=>{const p=h("TigInput"),n=h("el-form-item"),D=h("el-form");return m(),b("div",oe,[l("div",te,[l("div",re,[_.value?x("",!0):(m(),B(D,{key:0,ref_key:"formRef",ref:a,model:s.value,"label-width":"auto"},{default:g(()=>[f(n,{prop:"groupName",label:"分组名称",rules:[{required:!0,message:"分组名称不能为空!"}]},{default:g(()=>[f(p,{modelValue:s.value.groupName,"onUpdate:modelValue":e[0]||(e[0]=w=>s.value.groupName=w),placeholder:"请输入分组名称"},null,8,["modelValue"])]),_:1}),f(n,{prop:"productGroups",label:"关联商品分组",rules:[{required:!0,message:"关联商品不能为空!",trigger:"change",type:"array"}]},{default:g(()=>[f(N(ee),{productGroups:s.value.productGroups,"onUpdate:productGroups":e[1]||(e[1]=w=>s.value.productGroups=w),isMultiple:""},null,8,["productGroups"])]),_:1})]),_:1},8,["model"]))])])])}}}),Ie=C(ae,[["__scopeId","data-v-c8cc4607"]]);export{Ie as default};

import{d as W,e as x,f as c,g as i,z as o,l,h as a,aO as st,k as n,t as u,_ as j,x as lt,r as h,a as ot,a2 as it,o as rt,K as f,j as v,L as s,F as $,i as p,m as nt}from"./index-BLXOA87U.js";import{c as dt,d as ut,o as q,g as pt,a as ct,u as mt}from"./order-na2xscMr.js";import"./index-DpgvsnVO.js";import{O as vt}from"./OrderMoney-C6nVMKal.js";import{p as A}from"./format-DdZABYp4.js";import"./Verify.vue_vue_type_style_index_0_lang-6inGDsc1.js";import"./zh-cn-DldQh89R.js";/* empty css                                                                    */import{P as _t}from"./ProductCard-BBAaRBt1.js";import ft from"./OperationLog-BCUezeFx.js";import yt from"./LogisticsTracking-BbLbrpHN.js";import{M as bt}from"./MobileCard-SOyZaJkK.js";import{_ as gt}from"./EditSign.vue_vue_type_style_index_0_lang-C6R0r1Bw.js";import kt from"./SignTag-7kvqhm5a.js";import{h as ht,t as xt}from"./receiptPrint-DJsFTiP7.js";import{a as Ct}from"./version-hjn5tnxG.js";import{_ as y}from"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";import{M}from"./index-B16C4gX_.js";import{S as Ot}from"./index-Cy1X1TwA.js";import"./Pagination-w0YHSLYy.js";const St={class:"tooltip-con"},wt={class:"tooltip-title"},It={key:0,class:"iconfont-admin icon-yiwen"},Nt={style:{"max-width":"300px"}},At=W({__name:"Tooltip",props:{content:{type:String,default:""},ico:{type:Boolean,default:!1},placement:{type:String,default:"top"}},setup(P){const w=P;return(T,C)=>{const b=x("el-tooltip");return i(),c("div",St,[o(b,{effect:"light",placement:w.placement,"show-after":100},{content:l(()=>[a("div",Nt,u(w.content),1)]),default:l(()=>[a("div",wt,[st(T.$slots,"default",{},void 0,!0),w.ico?(i(),c("i",It)):n("",!0)])]),_:3},8,["placement"])])}}}),Pt=j(At,[["__scopeId","data-v-52ec2082"]]),Tt={key:0},Dt={key:0,class:"container-card"},zt={class:"border-bottom"},Bt={key:0},$t={key:0,style:{"margin-left":"10px"}},Mt={class:"mt10"},Vt={key:1,class:"button-card babyBlue pd20"},Lt={class:"container-card"},Rt={class:"info-card"},Et={class:"card-title"},Ft={class:"min-title"},qt={class:"card-li"},Wt={class:"li-info"},jt={class:"card-li"},Ut={class:"li-info"},Gt={class:"card-li"},Kt={class:"li-info"},Ht={key:0,class:"card-li"},Jt={class:"li-info"},Qt={key:1,class:"card-li"},Xt={class:"li-info"},Yt={key:2,class:"card-li"},Zt={class:"li-info"},te={class:"card-li"},ee={class:"li-info"},ae={class:"card-li"},se={class:"li-info"},le={class:"card-title"},oe={class:"min-title"},ie={class:"card-li"},re={class:"li-info"},ne={class:"card-li"},de={class:"li-info"},ue={class:"card-li"},pe={class:"li-info"},ce={class:"card-li"},me={class:"li-info"},ve={class:"card-title"},_e={class:"card-li"},fe={class:"li-info"},ye={class:"card-li"},be={class:"li-info"},ge={class:"container-card"},ke={class:"title"},he={class:"product-card-tp"},xe={key:0,class:"gift"},Ce={key:1},Oe={class:"total"},Se={class:"gray",style:{"margin-right":"16px"}},we={class:"title"},Ie={key:1,class:"container-card"},Ne=W({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isParent:{type:Boolean,default:!1},isDialog:Boolean},emits:["submitCallback","callback","update:confirmLoading","close"],setup(P,{expose:w,emit:T}){lt();const C=T,b=P,k=h(!0),D=ot().currentRoute.value.query,V=h(b.isDialog?b.act:String(D.act)),O=h(b.isDialog?b.id:Number(D.id)),S=h(b.isDialog?b.isParent:!!D.isParent),U=V.value==="add"?"create":"update",G=it(),t=h({balance:0,couponAmount:0,pointsAmount:0,productAmount:0,totalProductWeight:0,orderId:0,items:[],payType:0,availableActions:{},totalAmount:0,paidAmount:0,updateOrderSn:0,unpaidAmount:0,discountAmount:0}),L=h(!1);rt(()=>{k.value=!0,z(),Y()});const z=async()=>{try{const r=await dt(V.value,{id:O.value});Object.assign(t.value,r)}catch(r){f.error(r.message),C("close")}finally{k.value=!1}},K=()=>{M.confirm({title:"确认拆分订单吗？",onOk:async()=>{try{const r=await ut({id:O.value});f.success("操作成功"),_()}catch(r){f.error(r.message)}finally{k.value=!1}}})},H=()=>{M.confirm({title:"确认删除订单吗？",content:"被删除的订单可以通过筛选查找并恢复",onOk:async()=>{try{const r=await q("delOrder",{id:O.value});f.success("操作成功"),_()}catch(r){f.error(r.message)}finally{k.value=!1}}})},J=()=>{M.confirm({title:"确认订单已收货吗？",onOk:async()=>{try{const r=await q("confirmReceipt",{id:O.value});f.success("操作成功"),_()}catch(r){f.error(r.message)}finally{k.value=!1}}})},_=(r={})=>{z(),C("callback",r)},Q=async()=>{await G.value.validate();try{C("update:confirmLoading",!0);const r=await mt(U,{id:O.value,...t.value});C("submitCallback",r),f.success("操作成功")}catch(r){f.error(r.message)}finally{C("update:confirmLoading",!1)}},X=()=>{Q()},R=async(r,e)=>{try{e==="order"&&await pt({ids:t.value.orderId}),e==="waybill"&&await ct({id:t.value.orderId}),window.open(r,"_blank")}catch(I){f.error(I.message)}},Y=async()=>{try{let r=await ht();L.value=!0}catch(r){console.log(r)}},B=h(!1),Z=async()=>{B.value=!0;try{let r=await xt({ids:[O.value]});f.success("正在打印中~")}catch(r){console.log(r)}finally{B.value=!1}};return w({onFormSubmit:X}),(r,e)=>{var E,F;const I=x("el-divider"),m=x("el-button"),tt=x("el-space"),g=x("el-table-column"),et=x("el-table"),at=x("a-spin");return i(),c($,null,[k.value?n("",!0):(i(),c("div",Tt,[S.value?n("",!0):(i(),c("div",Dt,[a("div",zt,[s(" 订单编号："+u(t.value.orderSn)+" ",1),o(I,{direction:"vertical"}),s(" 下单时间："+u(t.value.addTime)+" ",1),t.value.storeTitle?(i(),c($,{key:0},[o(I,{direction:"vertical"}),a("span",null,"下单店铺："+u(t.value.storeTitle),1)],64)):n("",!0)]),o(tt,{size:10,class:"button-card"},{default:l(()=>[t.value.isChangeOrderStatus?(i(),c("div",Bt,[t.value.availableActions.deliver?(i(),v(p(y),{key:0,params:{id:t.value.orderId,preOrderStatus:t.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消订单",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[4]||(e[4]=[s(" 取消订单 ",-1)])),_:1,__:[4]})]),_:1},8,["params"])):n("",!0),t.value.availableActions.confirmReceipt?(i(),v(p(y),{key:1,params:{id:t.value.orderId,preOrderStatus:t.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消发货",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[5]||(e[5]=[s(" 取消发货 ",-1)])),_:1,__:[5]})]),_:1},8,["params"])):n("",!0)])):n("",!0),t.value.availableActions.setPaid?(i(),v(p(y),{key:1,params:{act:"setPaid",id:t.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"设置为已支付",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[6]||(e[6]=[s(" 设置为已支付 ",-1)])),_:1,__:[6]})]),_:1},8,["params"])):n("",!0),t.value.availableActions.cancelOrder?(i(),v(p(y),{key:2,params:{act:"cancelOrder",id:t.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"取消订单",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[7]||(e[7]=[s(" 取消订单 ",-1)])),_:1,__:[7]})]),_:1},8,["params"])):n("",!0),t.value.availableActions.delOrder?(i(),v(m,{key:3,bg:"",size:"small",text:"",type:"primary",onClick:H},{default:l(()=>e[8]||(e[8]=[s(" 删除订单 ",-1)])),_:1,__:[8]})):n("",!0),t.value.availableActions.deliver?(i(),v(p(y),{key:4,params:{act:"detail",id:t.value.orderId},title:"订单发货 "+t.value.orderSn,isDrawer:"",path:"order/order/src/ToShip",width:"900px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",size:"small",text:"",type:"danger"},{default:l(()=>e[9]||(e[9]=[s(" 去发货 ",-1)])),_:1,__:[9]})]),_:1},8,["params","title"])):n("",!0),t.value.availableActions.confirmReceipt?(i(),v(m,{key:5,bg:"",size:"small",text:"",type:"primary",onClick:J},{default:l(()=>e[10]||(e[10]=[s(" 确认已收货 ",-1)])),_:1,__:[10]})):n("",!0),t.value.availableActions.splitOrder?(i(),v(m,{key:6,bg:"",size:"small",text:"",type:"danger",onClick:K},{default:l(()=>[e[11]||(e[11]=s(" 拆分店铺订单",-1)),o(p(Pt),{ico:"",content:"该订单来自多个店铺且还未拆分，在做任何操作前，您需要先拆分该订单"})]),_:1,__:[11]})):n("",!0),o(m,{bg:"",size:"small",text:"",type:"primary",onClick:e[0]||(e[0]=d=>R(`/admin/print/orderPrint?ids=${t.value.orderId}`,"order"))},{default:l(()=>e[12]||(e[12]=[s(" 打印配送单 ",-1)])),_:1,__:[12]}),t.value.wayBill?(i(),v(m,{key:7,bg:"",size:"small",text:"",type:"primary",onClick:e[1]||(e[1]=d=>R(`/admin/print/waybill?id=${t.value.orderId}`,"waybill"))},{default:l(()=>e[13]||(e[13]=[s(" 打印面单 ",-1)])),_:1,__:[13]})):n("",!0),p(Ct)()&&L.value?(i(),v(m,{key:8,bg:"",size:"small",text:"",type:"primary",loading:B.value,onClick:Z},{default:l(()=>e[14]||(e[14]=[s(" 打印小票 ",-1)])),_:1,__:[14]},8,["loading"])):n("",!0)]),_:1}),t.value.mark?(i(),c("div",$t,[o(gt,{title:"编辑标记",item:t.value,onCallBack:z},{default:l(()=>[o(m,{link:"",type:"primary",style:{"font-size":"12px"}},{default:l(()=>e[15]||(e[15]=[s("标记订单",-1)])),_:1,__:[15]}),a("div",Mt,[o(kt,{class:"check-box tag",value:t.value.mark},null,8,["value"]),s(" "+u(t.value.adminNote),1)])]),_:1},8,["item"])])):n("",!0),t.value.stepStatus?(i(),c("div",Vt,[o(p(Ot),{current:t.value.stepStatus.current,size:"small",status:t.value.stepStatus.status,items:t.value.stepStatus.steps},null,8,["current","status","items"])])):n("",!0)])),a("div",Lt,[e[35]||(e[35]=a("div",{class:"title"},"订单明细",-1)),a("div",Rt,[a("div",Et,[a("div",Ft,[e[17]||(e[17]=s(" 收货人信息 ",-1)),S.value?n("",!0):(i(),v(p(y),{key:0,params:{act:"detail",id:t.value.orderId,form:t.value},isDrawer:"",path:"order/order/src/EditConsignee",title:"编辑收货人信息",width:"550px",onOkCallback:_},{default:l(()=>[o(m,{bg:"",class:"ml10",size:"small",text:"",type:"primary"},{default:l(()=>e[16]||(e[16]=[s(" 编辑 ",-1)])),_:1,__:[16]})]),_:1},8,["params"]))]),a("ul",null,[a("li",qt,[e[18]||(e[18]=s(" 会员名称：",-1)),a("span",Wt,u(((E=t.value.user)==null?void 0:E.nickname)||((F=t.value.user)==null?void 0:F.username)||"--"),1)]),a("li",jt,[e[19]||(e[19]=s("     收货人：",-1)),a("span",Ut,u(t.value.consignee?t.value.consignee:"--"),1)]),a("li",Gt,[e[20]||(e[20]=s(" 联系电话：",-1)),a("span",Kt,[o(bt,{mobile:t.value.mobile},null,8,["mobile"])])]),t.value.telephone?(i(),c("li",Ht,[e[21]||(e[21]=s(" 手机：",-1)),a("span",Jt,u(t.value.telephone?t.value.telephone:"--"),1)])):n("",!0),t.value.email?(i(),c("li",Qt,[e[22]||(e[22]=s(" 电子邮件：",-1)),a("span",Xt,u(t.value.email),1)])):n("",!0),t.value.postcode?(i(),c("li",Yt,[e[23]||(e[23]=s(" 邮政编码：",-1)),a("span",Zt,u(t.value.postcode),1)])):n("",!0),a("li",te,[e[24]||(e[24]=s(" 收货地址： ",-1)),a("span",ee,u(t.value.userAddress?t.value.userAddress:"--"),1)]),a("li",ae,[e[25]||(e[25]=s(" 订单备注： ",-1)),a("span",se,u(t.value.buyerNote?t.value.buyerNote:"--"),1)])])]),a("div",le,[a("div",oe,[e[27]||(e[27]=s(" 配送信息 ",-1)),S.value?n("",!0):(i(),v(p(y),{key:0,params:{act:"detail",id:t.value.orderId},isDrawer:"",path:"order/order/src/EditShipping",title:"编辑配送方式",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{disabled:!t.value.availableActions.modifyShippingInfo,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[26]||(e[26]=[s(" 编辑 ",-1)])),_:1,__:[26]},8,["disabled"])]),_:1},8,["params"]))]),a("ul",null,[a("li",ie,[e[28]||(e[28]=s(" 配送方式：",-1)),a("span",re,u(t.value.shippingTypeName),1)]),a("li",ne,[e[29]||(e[29]=s(" 发货时间：",-1)),a("span",de,u(t.value.shippingTime?t.value.shippingTime:"--"),1)]),a("li",ue,[e[30]||(e[30]=s(" 物流名称：",-1)),a("span",pe,u(t.value.logisticsName?t.value.logisticsName:"--"),1)]),a("li",ce,[e[31]||(e[31]=s(" 发货单号：",-1)),a("span",me,u(t.value.trackingNo?t.value.trackingNo:"--"),1)])])]),a("div",ve,[e[34]||(e[34]=a("div",{class:"min-title"},"付款信息",-1)),a("ul",null,[a("li",_e,[e[32]||(e[32]=s(" 支付方式：",-1)),a("span",fe,u(t.value.payTypeId===1?"在线支付":t.value.payTypeId===2?"货到付款":"线下支付"),1)]),a("li",ye,[e[33]||(e[33]=s(" 付款时间：",-1)),a("span",be,u(t.value.payTime?t.value.payTime:"--"),1)])])])])]),a("div",ge,[a("div",ke,[e[37]||(e[37]=s(" 商品信息 ",-1)),S.value?n("",!0):(i(),v(p(y),{key:0,params:{act:"detail",id:t.value.orderId},isDrawer:"",path:"order/order/src/EditProduct",title:"编辑商品信息",width:"1050px",onOkCallback:_},{default:l(()=>[o(m,{disabled:!t.value.availableActions.modifyOrder,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[36]||(e[36]=[s(" 编辑 ",-1)])),_:1,__:[36]},8,["disabled"])]),_:1},8,["params"]))]),o(et,{data:t.value.items},{default:l(()=>[o(g,{label:"商品名称",prop:"productId",width:"220"},{default:l(({row:d})=>[a("div",he,[d.isGift?(i(),c("div",xe,"赠")):n("",!0),o(p(_t),{picThumb:d.picThumb,productId:d.productId,productName:d.productName,productType:d.productType,url:d.url},null,8,["picThumb","productId","productName","productType","url"])])]),_:1}),o(g,{label:"属性",prop:"productAttr"},{default:l(({row:d})=>[s(u(d.skuValue||"无属性"),1)]),_:1}),o(g,{label:"附加规格",prop:"extraSkuData"},{default:l(({row:d})=>[d.extraSkuData&&d.extraSkuData.length>0?(i(!0),c($,{key:0},nt(d.extraSkuData,N=>(i(),c("div",{class:"extraskudata",key:N},u(N.attrName+N.attrValue+p(A)(N.totalAttrPrice)),1))),128)):(i(),c("div",Ce,"无附加规格"))]),_:1}),o(g,{label:"商品编号",width:"150"},{default:l(({row:d})=>[s(u(d.productSn),1)]),_:1}),o(g,{label:"价格",prop:"price"},{default:l(({row:d})=>[s(u(p(A)(d.price)),1)]),_:1}),o(g,{label:"数量",prop:"quantity"}),o(g,{label:"库存",prop:"stock"},{default:l(({row:d})=>[s(u(d.stock||"-"),1)]),_:1}),o(g,{label:"小计",prop:"subtotal"},{default:l(({row:d})=>[s(u(p(A)(d.subtotal)),1)]),_:1})]),_:1},8,["data"]),a("div",Oe,[a("span",Se,"商品总重量："+u(t.value.totalProductWeight)+"kg",1),a("span",null,"合计："+u(p(A)(Number(t.value.productAmount)-Number(t.value.couponAmount)-Number(t.value.discountAmount))),1)]),a("div",we,[e[39]||(e[39]=s(" 订单金额 ",-1)),S.value?n("",!0):(i(),v(p(y),{key:0,params:{act:"detail",id:t.value.orderId},isDrawer:"",path:"order/order/src/EditMoney",title:"编辑金额",width:"600px",onOkCallback:_},{default:l(()=>[o(m,{disabled:!t.value.availableActions.modifyOrderMoney,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:l(()=>e[38]||(e[38]=[s(" 编辑 ",-1)])),_:1,__:[38]},8,["disabled"])]),_:1},8,["params"]))]),o(p(vt),{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=d=>t.value=d)},null,8,["modelValue"])]),t.value.orderId&&(t.value.orderStatus===2||t.value.orderStatus===5)?(i(),c("div",Ie,[e[40]||(e[40]=a("div",{class:"title"},"物流追踪",-1)),o(yt,{trackingNo:t.value.trackingNo,logisticsName:t.value.logisticsName,shippingMethod:t.value.shippingMethod,id:t.value.orderId,"onUpdate:id":e[3]||(e[3]=d=>t.value.orderId=d)},null,8,["trackingNo","logisticsName","shippingMethod","id"])])):n("",!0),S.value?n("",!0):(i(),v(ft,{key:2,orderId:t.value.orderId},null,8,["orderId"]))])),o(at,{spinning:k.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])],64)}}}),Je=j(Ne,[["__scopeId","data-v-e9477c0d"]]);export{Je as default};

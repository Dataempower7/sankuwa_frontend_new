import{d as L,r as u,a as I,a2 as j,o as G,e as s,f as z,g as d,h as c,z as t,l,j as v,k as A,G as E,i as Y,L as b,J,K as f}from"./index-BLXOA87U.js";import{F as O}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-DfcXXcrS.js";import"./index-DpgvsnVO.js";import"./vuedraggable.umd-OAFqtEpj.js";import{_ as $}from"./Editor.vue_vue_type_style_index_0_lang-DAwN4rRQ.js";import{b as P,c as Q}from"./notice-BgfaWkBb.js";import"./Image.vue_vue_type_script_setup_true_lang-BK00jvUw.js";import"./format-DdZABYp4.js";import"./BusinessImg-C3Ug8bC9.js";import"./currencyManagement-ZKRxsK3T.js";import"./version-hjn5tnxG.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";import"./index-B16C4gX_.js";import"./index.esm-BvrkUkzo.js";const W={class:"container"},X={class:"content_wrapper"},Z={class:"lyecs-form-table"},h={class:"lyecs-form-table"},_e=L({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(B,{expose:C,emit:S}){const m=S,i=B,g=u(1),p=u(!0),y=I().currentRoute.value.query,_=u(i.isDialog?i.act:String(y.act)),V=u(i.isDialog?i.id:Number(y.id)),q=_.value==="add"?"create":"update",T=j(),o=u({isTop:0,content:""}),N=async()=>{try{const r=await P(_.value,{id:V.value});Object.assign(o.value,r)}catch(r){f.error(r.message),m("close")}finally{p.value=!1}};G(()=>{_.value==="detail"?N():p.value=!1});const k=async()=>{if(await T.value.validate(),o.value.content===""){f.error("正文内容不能为空!");return}try{m("update:confirmLoading",!0);const r=await Q(q,{id:V.value,...o.value});m("submitCallback",r),f.success("操作成功")}catch(r){f.error(r.message)}finally{m("update:confirmLoading",!1)}};return C({onFormSubmit:()=>{k()}}),(r,e)=>{const w=s("TigInput"),n=s("el-form-item"),x=s("el-date-picker"),D=s("el-radio"),K=s("el-radio-group"),M=s("el-button"),R=s("el-form"),U=s("el-tab-pane"),F=s("el-tabs"),H=s("a-spin");return d(),z("div",W,[c("div",X,[c("div",Z,[t(F,{activeKey:g.value,"onUpdate:activeKey":e[7]||(e[7]=a=>g.value=a),class:"lyecs-tabs","tab-position":"top"},{default:l(()=>[(d(),v(U,{key:1,label:"基础设置"},{default:l(()=>[c("div",h,[p.value?A("",!0):(d(),v(R,{key:0,ref_key:"formRef",ref:T,model:o.value,"label-width":"auto"},{default:l(()=>[t(n,{rules:[{required:!0,message:"页面名称不能为空!"}],label:"页面名称",prop:"title"},{default:l(()=>[t(w,{classType:"tig-form-input",modelValue:o.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.title=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"封面图片",prop:"img",rules:[{required:!0,message:"封面图片不能为空!"}]},{default:l(()=>[t(Y(O),{photo:o.value.img,"onUpdate:photo":e[1]||(e[1]=a=>o.value.img=a)},null,8,["photo"]),e[8]||(e[8]=c("div",{class:"extra"},"请统一上传比例为2:1的图片，宽600px，高450px（高清）",-1))]),_:1,__:[8]}),t(n,{label:"推送时间",prop:"startTime",rules:[{required:!0,message:"推送时间不能为空!"}]},{default:l(()=>[t(x,{modelValue:o.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.startTime=a),type:"datetime",placeholder:"请选择推送时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(n,{label:"失效时间",prop:"endTime"},{default:l(()=>[t(x,{modelValue:o.value.endTime,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.endTime=a),type:"datetime",placeholder:"请选择失效时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(n,{label:"页面描述",prop:"describe",rules:[{required:!0,message:"页面描述不能为空!"}]},{default:l(()=>[t(w,{classType:"tig-form-input",modelValue:o.value.describe,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.describe=a),row:3,type:"textarea"},null,8,["modelValue"])]),_:1}),t(n,{label:"是否置顶",prop:"isTop"},{default:l(()=>[t(K,{modelValue:o.value.isTop,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.isTop=a)},{default:l(()=>[t(D,{value:1},{default:l(()=>e[9]||(e[9]=[b("置顶",-1)])),_:1,__:[9]}),t(D,{value:0},{default:l(()=>e[10]||(e[10]=[b("不置顶",-1)])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1}),E(t(n,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(M,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:k},{default:l(()=>e[11]||(e[11]=[b("提交",-1)])),_:1,__:[11]},512)]),_:1},512),[[J,!i.isDialog]])]),_:1},8,["model"]))])]),_:1})),(d(),v(U,{key:2,label:"正文内容"},{default:l(()=>[t(Y($),{html:o.value.content,"onUpdate:html":e[6]||(e[6]=a=>o.value.content=a)},null,8,["html"])]),_:1}))]),_:1},8,["activeKey"]),t(H,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{_e as default};

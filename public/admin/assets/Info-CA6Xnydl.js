import{_ as H}from"./AdvancedInfo.vue_vue_type_script_setup_true_lang-CAqr3bgn.js";import J from"./BasicInfo-waUX8cSJ.js";import{_ as K}from"./DescInfo.vue_vue_type_script_setup_true_lang-DjUH2ygF.js";import X from"./LogisticsInfo-DYB_nTP_.js";import{_ as Z}from"./PriceInfo.vue_vue_type_script_setup_true_lang-D2efPsOb.js";import{_}from"./VendorPriceInfo.vue_vue_type_script_setup_true_lang-BjmmMeNN.js";import ee from"./OrderInfo-j7XeY-4u.js";import{d as te,W as ae,r as l,b as ie,ab as oe,Y as re,o as se,P as I,f as N,g as A,h as c,i as r,z as k,m as P,F as le,p as ne,n as F,t as ue,k as L,l as x,Q as T,j as v,s as U,_ as de}from"./index-B52YIGC0.js";import{e as pe,f as me,h as ce,i as ve}from"./product-hE35r0Q_.js";/* empty css                                                                  */import"./Checkbox.vue_vue_type_script_setup_true_lang-CA619vaZ.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import"./time-EzYK4E-P.js";import"./index-KjhYqCTY.js";import"./index-C9ZdVeVx.js";import"./SelectProduct-C4WsEKWV.js";import"./format-BxqOrW-w.js";/* empty css                                                                    */import"./Pagination-C8J7-6Em.js";import"./SelectSku-ZXdrD9qH.js";/* empty css                                                                  */import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./article-rWlGXn3e.js";/* empty css                                                                              *//* empty css                                                                     *//* empty css             */import"./productBrief-qpyE78uP.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import"./vuedraggable.umd-BauR0rTv.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";/* empty css                                                                    */import"./FormAddGalleryVideo-0HIZtwZ5.js";import"./RadioType-_K8vK_oe.js";import"./SelectBrand-tHlymKqU.js";import"./brand-CyfpB5Ly.js";import"./SelectCategory.vue_vue_type_script_setup_true_lang-Bb2xH4oQ.js";import"./category-BhaHXalE.js";import"./category-D6KF81Ae.js";import"./SelectShopProductCategory.vue_vue_type_script_setup_true_lang-DmdbWE5K.js";import"./shopProductCategory-DyQBhq8U.js";import"./BusinessData-Dbgv1FCM.js";import"./seo-C1Ho1LwZ.js";import"./ProductDesc-C-kyH0wg.js";import"./Editor.vue_vue_type_style_index_0_lang-ChPMQjFJ.js";import"./index.esm-CBYqueH9.js";import"./PriceInput.vue_vue_type_script_setup_true_lang-DpJJvzpB.js";import"./pickupSetting-CaGqQdmm.js";import"./Attr-D1_OGRv9.js";import"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-CRFq-JzZ.js";import"./VendorAttr-BIT-kbDu.js";import"./product-CL06FDSJ.js";import"./appointmentTpl-DplhS7jl.js";const fe={class:"product-container"},ge={class:"anchor"},ye={class:"tab-row"},Ie={id:"part1",class:"form-warp"},Se={id:"part2",class:"form-warp"},he={id:"part3",class:"form-warp"},ke={id:"part4",class:"form-warp"},Le={id:"part5",class:"form-warp"},xe=te({__name:"Info",props:{id:{type:Number,default:0},shopId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},examine:{type:Number,default:0},storeSettingInfo:{type:Object,default:{}},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close","closeConfirm"],setup(s,{expose:q,emit:E}){ae();const f=E,p=s,$=[{title:"基本信息",id:"part1"},{title:"价格及库存",id:"part2"},{title:"物流及配送",id:"part3"},{title:"商品详情",id:"part4"},{title:"高级信息",id:"part5"}],u=l(p.type),V=l(null),S=l(""),j=a=>{a.preventDefault()},z=a=>{S.value=a},n=l(!0),D=ie().currentRoute.value.query,g=l(p.isDialog?p.act:String(D.act)),d=l(p.isDialog?p.id:Number(D.id)),O=g.value==="add"?"create":g.value==="copy"?"copy":"update",w=oe(),m=l(!1),t=l({snType:1,productType:1,freeShipping:0,shopCategoryId:0,productStatus:1,giveIntegral:-1,rankIntegral:-1,integral:0,isSupportCod:0,productVideoInfo:[],productDescArr:[],productRelated:[],serviceList:[],eCardList:[],productList:[],limitNumber:"",virtualSample:"",paidContent:[],productArticleList:[],noShipping:0,fixedShippingType:1,isShopPickup:1,isLogistics:1,attrList:{normal:[],spe:[],extra:[]},vendorProductId:0,reservationTplId:null,reservationTimes:[],isShopDelivery:1});re(t.value,a=>{a.productType!=1&&(t.value.noShipping=1)});const M=l([]);se(async()=>{await W(!1),M.value=[{key:1,title:"普通商品",desc:"物流配送"},{key:3,title:"卡密商品",tips:"可以在菜单中【营销>电子卡券组】创建卡券组，然后在【查看卡列表】添加单个卡密或通过下载【批量导入模板文件】填好卡密后在通过批量导入电子卡券按钮上传该文件批量导入。",desc:"无需物流"},{key:2,title:"虚拟商品",tips:"网盘链接、视频链接，在添加商品添加虚拟商品。用户购买后将在订单详情直接展示。",desc:"无需物流"},{key:4,title:"付费内容",tips:"软件授权、在线课程等。通过简单的操作，即可将这些商品添加到您的商店中，为客户提供更丰富的选择。立即体验，享受便捷的付费内容管理服务。",desc:"无需物流"}],g.value==="detail"||g.value==="copy"||g.value==="again"?await Q():n.value=!1,setTimeout(()=>{f("closeConfirm",!0)},1e4)});const C=l([]),Q=async()=>{try{const a=await pe("detail",{id:d.value});a.productRelated==null&&(a.productRelated=[]),a.brandId==0&&(a.brandId=""),a.shippingTplId==0&&(a.shippingTplId=""),a.limitNumber===0?(a.limitNumber="",m.value=!1):m.value=!0,a.vendorId&&(u.value="vendor"),t.value.serviceList=t.value.serviceList.map(e=>{var i;return{...e,check:(i=a.productServiceIds)!=null&&i.includes(e.productServiceId)?1:0}}),Object.assign(t.value,a,a)}catch(a){I.error(a.message),f("close")}finally{n.value=!1}},W=async(a=!0)=>{var e;try{const i=await me({shopId:p.shopId});C.value=i.attrTplList,t.value.serviceList=i.serviceList,t.value.serviceList=(e=i.serviceList)==null?void 0:e.map(y=>{var b;return{...y,check:(b=i.item.productServiceIds)!=null&&b.includes(y.productServiceId)?1:0}}),t.value.suppliersList=i.suppliersList,t.value.shippingTplList=i.shippingTplList,t.value.eCardList=i.eCardList}catch(i){I.error(i.message),f("close")}finally{n.value=!1}};function Y(a){for(let e=0;e<a.length;e++){const i=a[e];if(!i.attrValues||i.attrValues.length===0||i.attrValues.some(y=>y==="")||i.skuStock===null||i.skuStock===void 0)return console.error("请填写完整的规格信息"),!1}return!0}const h=l(),G=async()=>{try{if(await w.value.validate(),t.value.productType==4&&t.value.paidContent.length==0){I.error("付费内容信息不能为空!"),await U(),R(".goods-info-edit-row");return}if(t.value.productType!==3&&t.value.productType!==5&&t.value.productType!==6){if(!Y(t.value.productList)&&u.value!=="vendor"){I.error("请将商品规格的信息填写完整!"),h.value.skuErrorText="请将商品规格的信息填写完整",await U(),R(".sku-error");return}else h.value.skuErrorText="";await h.value.attrForm.validateProductSku()}t.value.attrList.spe.length>0&&(t.value.productStock=0);try{f("update:confirmLoading",!0),t.value.productServiceIds=t.value.serviceList.filter(e=>e.check===1).map(e=>e.productServiceId),t.value.limitNumber=m.value?t.value.limitNumber:0;const a=await ce(O,{...t.value});p.act==="again"&&await ve({id:d.value}),f("submitCallback",a),I.success(a)}catch(a){I.error(a.message)}finally{console.log("提交完成"),f("update:confirmLoading",!1)}}catch(a){await U(),R(),console.error("表单验证失败:",a)}},R=(a=".el-form-item.is-error")=>{const e=document.querySelector(a);if(e){e.scrollIntoView({behavior:"instant",block:"center"});const i=e.querySelector("input, textarea, select");i&&(i==null||i.focus())}};return q({onFormSubmit:()=>{G()}}),(a,e)=>{const i=N("el-anchor-link"),y=N("el-anchor"),b=N("el-form");return c(),A("div",fe,[r("div",ge,[k(y,{container:V.value,offset:10,direction:"horizontal",onChange:z,onClick:j},{default:P(()=>[r("div",ye,[(c(),A(le,null,ne($,(o,B)=>k(i,{key:o.id,class:F({active:S.value===""&&B===0?!0:S.value==="#"+o.id}),href:"#"+o.id},{default:P(()=>[r("div",{class:F([{active:S.value===""&&B===0?!0:S.value==="#"+o.id},"item"])},ue(o.title),3)]),_:2},1032,["class","href"])),64))])]),_:1},8,["container"])]),r("div",{ref_key:"containerRef",ref:V,class:"form-container"},[n.value?x("",!0):(c(),L(b,{key:0,ref_key:"formRef",ref:w,model:t.value,"label-width":"110px",name:"form_in_modal"},{default:P(()=>[r("div",Ie,[e[9]||(e[9]=r("div",{class:"title"},[r("p",{class:"xian"}),T(" 基本信息 ")],-1)),k(v(J),{type:u.value,id:d.value,shopId:s.shopId,examine:s.examine,loading:n.value,action:g.value,storeSettingInfo:s.storeSettingInfo,"form-state":t.value,"onUpdate:formState":e[0]||(e[0]=o=>t.value=o),formRef:w.value},null,8,["type","id","shopId","examine","loading","action","storeSettingInfo","form-state","formRef"])]),r("div",Se,[e[10]||(e[10]=r("div",{class:"title"},[r("p",{class:"xian"}),T(" 价格及库存 ")],-1)),u.value!=="vendor"?(c(),L(v(Z),{key:0,ref_key:"priceInfoRef",ref:h,id:d.value,shopId:s.shopId,act:s.act,examine:s.examine,attrTplList:C.value,isLimit:m.value,"onUpdate:isLimit":e[1]||(e[1]=o=>m.value=o),loading:n.value,"form-state":t.value,"onUpdate:formState":e[2]||(e[2]=o=>t.value=o),storeSettingInfo:s.storeSettingInfo},null,8,["id","shopId","act","examine","attrTplList","isLimit","loading","form-state","storeSettingInfo"])):x("",!0),u.value=="vendor"?(c(),L(v(_),{key:1,ref_key:"priceInfoRef",ref:h,id:d.value,shopId:s.shopId,act:s.act,examine:s.examine,attrTplList:C.value,isLimit:m.value,"onUpdate:isLimit":e[3]||(e[3]=o=>m.value=o),loading:n.value,"form-state":t.value,"onUpdate:formState":e[4]||(e[4]=o=>t.value=o)},null,8,["id","shopId","act","examine","attrTplList","isLimit","loading","form-state"])):x("",!0)]),r("div",he,[e[11]||(e[11]=r("div",{class:"title"},[r("p",{class:"xian"}),T(" 物流及配送 ")],-1)),u.value!=="vendor"||u.value=="vendor"&&t.value.vendorProductId>0&&t.value.productType!=5&&t.value.productType!=6?(c(),L(v(X),{key:0,id:d.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[5]||(e[5]=o=>t.value=o),act:s.act},null,8,["id","shopId","examine","loading","form-state","act"])):x("",!0),t.value.productType==5||t.value.productType==6?(c(),L(v(ee),{key:1,"form-state":t.value,"onUpdate:formState":e[6]||(e[6]=o=>t.value=o)},null,8,["form-state"])):x("",!0)]),r("div",ke,[e[12]||(e[12]=r("div",{class:"title"},[r("p",{class:"xian"}),T(" 商品详情 ")],-1)),k(v(K),{type:u.value,id:d.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[7]||(e[7]=o=>t.value=o)},null,8,["type","id","shopId","examine","loading","form-state"])]),r("div",Le,[e[13]||(e[13]=r("div",{class:"title"},[r("p",{class:"xian"}),T(" 高级信息 ")],-1)),k(v(H),{id:d.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[8]||(e[8]=o=>t.value=o)},null,8,["id","shopId","examine","loading","form-state"])])]),_:1},8,["model"]))],512)])}}}),bt=de(xe,[["__scopeId","data-v-d496a3af"]]);export{bt as default};

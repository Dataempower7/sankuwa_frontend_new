import{d as M,r as f,Y as P,o as O,eA as $,P as T,k,h as N,j as D,dx as F,a as Q,b as Y,ab as Z,f as m,g as G,i as w,l as L,z as a,m as l,L as H,Q as v,O as J,eD as K,eE as W,dT as X,_ as ee}from"./index-B52YIGC0.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import"./index-KjhYqCTY.js";/* empty css                                                                    */import{D as te}from"./DynamicList-BsIHXkEq.js";/* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import{S as ae}from"./SelectIco-DM14tB3B.js";import"./time-EzYK4E-P.js";import"./index-C9ZdVeVx.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";const le=M({__name:"SelectAuthority",props:{authorityId:{type:[Number,Array],default:0},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},adminType:{type:String,default:"admin"}},emits:["update:authorityId"],setup(h,{emit:x}){const i=h,C={label:"authorityName",value:"authorityId",children:"children",multiple:i.multiple,checkStrictly:!0},y=f([]),u=f(!1),n=f();f(!1);const g=x;P(()=>i.adminType,t=>{u.value=!1,d()}),O(()=>{i.authorityId&&d()});const d=async()=>{if(!u.value){u.value=!0;try{const t=await $({adminType:i.adminType});y.value=t,n.value=i.authorityId}catch(t){T.error(t.message)}}},V=t=>{if(i.multiple==!0){const b=t.map(c=>c[c.length-1]);g("update:authorityId",b)}else g("update:authorityId",t?t[t.length-1]:0)},_=t=>{t&&d()},I=()=>{i.multiple==!0?n.value=[]:n.value=0};return(t,b)=>(N(),k(D(F),{class:"cascader",props:C,disabled:h.disabled,placeholder:"顶级权限",options:y.value,modelValue:n.value,"onUpdate:modelValue":b[0]||(b[0]=c=>n.value=c),clearable:"",onChange:V,onClear:I,onVisibleChange:_},null,8,["disabled","options","modelValue"]))}}),oe={class:"container"},ue={class:"content_wrapper"},ne={class:"lyecs-form-table"},re=M({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Number,default:0},act:{type:String,default:""},adminType:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(h,{expose:x,emit:i}){const C=Q(),y=i,u=h,n=f(!0),g=Y().currentRoute.value.query,d=f(u.isDialog?u.act:String(g.act)),V=f(u.isDialog?u.id:Number(g.id)),_=d.value==="add"?"create":"update",I=Z(),t=f({childAuth:[],adminType:u.isDialog?u.adminType:String(g.adminType),isShow:1}),b=async()=>{try{const s=await K(d.value,{id:V.value});Object.assign(t.value,s)}catch(s){T.error(s.message),y("close")}finally{n.value=!1}};O(()=>{d.value==="detail"?b():n.value=!1,_==="create"&&(t.value.parentId=u.parentId)});const c=async()=>{await I.value.validate();try{y("update:confirmLoading",!0);const s=await W(_,{id:V.value,...t.value});y("submitCallback",s),T.success("操作成功"),C.mainMenu=await X()}catch(s){T.error(s.message)}finally{y("update:confirmLoading",!1)}},z=()=>{c()},E=(s,e,p)=>{/^[a-zA-Z]+$/.test(e)?p():p(new Error("只能输入英文字母"))};return x({onFormSubmit:z}),(s,e)=>{const p=m("TigInput"),r=m("el-form-item"),S=m("el-radio"),B=m("el-radio-group"),U=m("el-space"),R=m("el-button"),q=m("el-form"),j=m("a-spin");return N(),G("div",oe,[w("div",ue,[w("div",ne,[n.value?L("",!0):(N(),k(q,{key:0,ref_key:"formRef",ref:I,model:t.value,"label-width":"auto"},{default:l(()=>[a(r,{rules:[{required:!0,message:"权限名称不能为空!"}],label:"权限名称",prop:"authorityName"},{default:l(()=>[a(p,{classType:"tig-form-input",modelValue:t.value.authorityName,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.authorityName=o)},null,8,["modelValue"])]),_:1}),a(r,{rules:[{required:!0,message:"唯一编号不能为空!"},{validator:E,trigger:"blur"}],label:"唯一编号",prop:"authoritySn"},{default:l(()=>[a(p,{classType:"tig-form-input",modelValue:t.value.authoritySn,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.authoritySn=o)},null,8,["modelValue"]),e[8]||(e[8]=w("div",{class:"extra"},"只能为英文字母，推荐小驼峰，非目录权限则以Manage结尾，如：productManage",-1))]),_:1},8,["rules"]),a(r,{label:"上级分类",prop:"parentId"},{default:l(()=>[n.value?L("",!0):(N(),k(D(le),{key:0,authorityId:t.value.parentId,"onUpdate:authorityId":e[2]||(e[2]=o=>t.value.parentId=o),multiple:!1,style:{width:"100%"},disabled:d.value=="add"&&!h.parentId,adminType:t.value.adminType},null,8,["authorityId","disabled","adminType"]))]),_:1}),a(r,{label:"ICO编码",prop:"authorityIco"},{default:l(()=>[a(ae,{modelValue:t.value.authorityIco,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.authorityIco=o)},null,8,["modelValue"]),e[9]||(e[9]=w("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1}),a(r,{label:"排序",prop:"sortOrder"},{default:l(()=>[a(p,{classType:"tig-form-input",TigInput:"",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.sortOrder=o)},null,8,["modelValue"])]),_:1}),a(r,{label:"权限所属系统",prop:"adminType"},{default:l(()=>[a(B,{modelValue:t.value.adminType,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.adminType=o),disabled:""},{default:l(()=>[a(S,{value:"admin"},{default:l(()=>[...e[10]||(e[10]=[v("管理后台",-1)])]),_:1}),a(S,{value:"shop"},{default:l(()=>[...e[11]||(e[11]=[v("店铺后台",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"是否显示",prop:"isShow"},{default:l(()=>[a(B,{modelValue:t.value.isShow,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.isShow=o)},{default:l(()=>[a(S,{value:1},{default:l(()=>[...e[12]||(e[12]=[v("是",-1)])]),_:1}),a(S,{value:0},{default:l(()=>[...e[13]||(e[13]=[v("否",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"细分权限"},{default:l(()=>[a(D(te),{modelValue:t.value.childAuth,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.childAuth=o),templateList:["authName","authSn"],buttonName:"新增细分权限"},{dynamicSlot:l(o=>[a(U,{size:16},{default:l(()=>[a(U,{size:0},{default:l(()=>[e[14]||(e[14]=v(" 权限名称： ",-1)),a(p,{modelValue:o.item.authName,"onUpdate:modelValue":A=>o.item.authName=A,placeholder:"权限名称",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(U,{size:0},{default:l(()=>[e[15]||(e[15]=v(" 权限编码： ",-1)),a(p,{modelValue:o.item.authSn,"onUpdate:modelValue":A=>o.item.authSn=A,placeholder:"权限编码",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),H(a(r,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[a(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:c},{default:l(()=>[...e[16]||(e[16]=[v("提交 ",-1)])]),_:1},512)]),_:1},512),[[J,!u.isDialog]])]),_:1},8,["model"])),a(j,{spinning:n.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),_e=ee(re,[["__scopeId","data-v-49f0a1e7"]]);export{_e as default};

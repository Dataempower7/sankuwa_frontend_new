import{p as W,i as ie}from"./format-BxqOrW-w.js";import{_ as me}from"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import{d as J,aH as re,aN as de,c as U,z as o,aC as D,eV as ue,f5 as ce,aJ as pe,aK as ve,ay as le,b5 as fe,f1 as ge,f6 as _e,bT as he,aD as se,aE as ae,r as w,b as be,ab as ye,o as $e,f as B,a7 as Se,L as Ie,g as r,h as a,l as m,i,m as f,j as h,t as u,k as z,Q as N,F as ne,p as oe,P as H,_ as xe}from"./index-B52YIGC0.js";import{F as Ce}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import"./index-KjhYqCTY.js";import"./vuedraggable.umd-BauR0rTv.js";import{c as Le,d as Te,e as we,f as Be}from"./aftersales-Bt16NHXV.js";/* empty css                                                                    */import{P as Ne}from"./ProductCard-8OYszTHR.js";import{_ as He}from"./InfoBtn.vue_vue_type_script_setup_true_lang-f1w7IU5B.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";/* empty css                                                                    */const Pe=()=>({prefixCls:String,color:String,dot:D.any,pending:ue(),position:D.oneOf(ce("left","right","")).def(""),label:D.any}),A=J({compatConfig:{MODE:3},name:"ATimelineItem",props:re(Pe(),{color:"blue",pending:!1}),slots:Object,setup(e,s){let{slots:g}=s;const{prefixCls:v}=de("timeline",e),d=U(()=>({[`${v.value}-item`]:!0,[`${v.value}-item-pending`]:e.pending})),b=U(()=>/blue|red|green|gray/.test(e.color||"")?void 0:e.color||"blue"),P=U(()=>({[`${v.value}-item-head`]:!0,[`${v.value}-item-head-${e.color||"blue"}`]:!b.value}));return()=>{var C,S,l;const{label:_=(C=g.label)===null||C===void 0?void 0:C.call(g),dot:p=(S=g.dot)===null||S===void 0?void 0:S.call(g)}=e;return o("li",{class:d.value},[_&&o("div",{class:`${v.value}-item-label`},[_]),o("div",{class:`${v.value}-item-tail`},null),o("div",{class:[P.value,!!p&&`${v.value}-item-head-custom`],style:{borderColor:b.value,color:b.value}},[p]),o("div",{class:`${v.value}-item-content`},[(l=g.default)===null||l===void 0?void 0:l.call(g)])])}}}),ze=e=>{const{componentCls:s}=e;return{[s]:le(le({},fe(e)),{margin:0,padding:0,listStyle:"none",[`${s}-item`]:{position:"relative",margin:0,paddingBottom:e.timeLineItemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize,insetInlineStart:(e.timeLineItemHeadSize-e.timeLineItemTailWidth)/2,height:`calc(100% - ${e.timeLineItemHeadSize}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px ${e.lineType} ${e.colorSplit}`},"&-pending":{[`${s}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${s}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.timeLineItemHeadSize,height:e.timeLineItemHeadSize,backgroundColor:e.colorBgContainer,border:`${e.timeLineHeadBorderWidth}px ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize/2,insetInlineStart:e.timeLineItemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.timeLineItemCustomHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.lineWidth,marginInlineStart:e.margin+e.timeLineItemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${s}-item-tail`]:{display:"none"},[`> ${s}-item-content`]:{minHeight:e.controlHeightLG*1.2}}},[`&${s}-alternate,
        &${s}-right,
        &${s}-label`]:{[`${s}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${e.marginXXS}px`,"&-custom":{marginInlineStart:e.timeLineItemTailWidth/2}},"&-left":{[`${s}-item-content`]:{insetInlineStart:`calc(50% - ${e.marginXXS}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}},"&-right":{[`${s}-item-content`]:{width:`calc(50% - ${e.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${s}-right`]:{[`${s}-item-right`]:{[`${s}-item-tail,
            ${s}-item-head,
            ${s}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(e.timeLineItemHeadSize+e.timeLineItemTailWidth)/2}px)`},[`${s}-item-content`]:{width:`calc(100% - ${e.timeLineItemHeadSize+e.marginXS}px)`}}},[`&${s}-pending
        ${s}-item-last
        ${s}-item-tail`]:{display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`&${s}-reverse
        ${s}-item-last
        ${s}-item-tail`]:{display:"none"},[`&${s}-reverse ${s}-item-pending`]:{[`${s}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`${s}-item-content`]:{minHeight:e.controlHeightLG*1.2}},[`&${s}-label`]:{[`${s}-item-label`]:{position:"absolute",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.timeLineItemTailWidth,width:`calc(50% - ${e.marginSM}px)`,textAlign:"end"},[`${s}-item-right`]:{[`${s}-item-label`]:{insetInlineStart:`calc(50% + ${e.marginSM}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${s}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},De=pe("Timeline",e=>{const s=ve(e,{timeLineItemPaddingBottom:e.padding*1.25,timeLineItemHeadSize:10,timeLineItemCustomHeadPaddingVertical:e.paddingXXS,timeLinePaddingInlineEnd:2,timeLineItemTailWidth:e.lineWidthBold,timeLineHeadBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3});return[ze(s)]}),Oe=()=>({prefixCls:String,pending:D.any,pendingDot:D.any,reverse:ue(),mode:D.oneOf(ce("left","alternate","right",""))}),M=J({compatConfig:{MODE:3},name:"ATimeline",inheritAttrs:!1,props:re(Oe(),{reverse:!1,mode:""}),slots:Object,setup(e,s){let{slots:g,attrs:v}=s;const{prefixCls:d,direction:b}=de("timeline",e),[P,C]=De(d),S=(l,_)=>{const p=l.props||{};return e.mode==="alternate"?p.position==="right"?`${d.value}-item-right`:p.position==="left"?`${d.value}-item-left`:_%2===0?`${d.value}-item-left`:`${d.value}-item-right`:e.mode==="left"?`${d.value}-item-left`:e.mode==="right"?`${d.value}-item-right`:p.position==="right"?`${d.value}-item-right`:""};return()=>{var l,_,p;const{pending:$=(l=g.pending)===null||l===void 0?void 0:l.call(g),pendingDot:V=(_=g.pendingDot)===null||_===void 0?void 0:_.call(g),reverse:O,mode:E}=e,q=typeof $=="boolean"?null:$,j=ge((p=g.default)===null||p===void 0?void 0:p.call(g)),c=$?o(A,{pending:!!$,dot:V||o(_e,null,null)},{default:()=>[q]}):null;c&&j.push(c);const t=O?j.reverse():j,y=t.length,F=`${d.value}-item-last`,L=t.map((I,x)=>{const T=x===y-2?F:"",n=x===y-1?F:"";return he(I,{class:se([!O&&$?T:n,S(I,x)])})}),X=t.some(I=>{var x,T;return!!(!((x=I.props)===null||x===void 0)&&x.label||!((T=I.children)===null||T===void 0)&&T.label)}),G=se(d.value,{[`${d.value}-pending`]:!!$,[`${d.value}-reverse`]:!!O,[`${d.value}-${E}`]:!!E&&!X,[`${d.value}-label`]:X,[`${d.value}-rtl`]:b.value==="rtl"},v.class,C.value);return P(o("ul",ae(ae({},v),{},{class:G}),[L]))}}});M.Item=A;M.install=function(e){return e.component(M.name,M),e.component(A.name,A),e};const Re={class:"container"},We={key:0,class:"content_wrapper"},Me={class:"lyecs-form-table"},Ae={class:"flex"},Ve={class:"container-card"},Ee={class:"title flex flex-justify-between"},je={class:"info-card"},Fe={class:"card-title"},Xe={class:"card-li"},qe={class:"li-info red"},Ge={class:"card-li"},Ue={class:"li-info"},Je={class:"card-li"},Ke={class:"li-info"},Qe={class:"card-li"},Ye={class:"li-info"},Ze={class:"card-li"},ke={class:"li-info"},et={class:"card-title"},tt={key:0,class:"card-li"},it={class:"li-info"},lt={class:"refund-info flex"},st={class:"li-info"},at={style:{"margin-left":"10px"}},nt={class:"refund-info flex"},ot={class:"li-info"},rt={style:{"margin-left":"10px"}},dt={class:"flex"},ut={class:"li-info"},ct={style:{"margin-left":"10px"}},mt={key:1,class:"card-li"},pt={class:"li-info"},vt={class:"card-li"},ft={class:"li-info"},gt={class:"card-li"},_t={class:"li-info"},ht={key:2,class:"card-li"},bt={class:"li-info"},yt={class:"negotiation-box"},$t={class:"negotiation-title flex flex-justify-between"},St={key:0,class:"btn"},It={class:"btn-box"},xt={class:"negotiation-content"},Ct={key:0,class:"logo"},Lt={key:1,class:"logo-b"},Tt={key:0},wt={key:1},Bt={class:"info-box"},Nt={class:"tit"},Ht={key:0,class:"txt"},Pt={key:1,class:"txt"},zt={key:0},Dt={key:1},Ot={key:0},Rt={key:1},Wt={class:"time"},Mt={class:"detail"},At={key:0,class:"content"},Vt={key:1,class:"card-li"},Et={class:"li-info"},jt={key:2,class:"card-li"},Ft={class:"li-info"},Xt={key:3,class:"card-li"},qt={class:"li-info"},Gt={key:4,class:"card-li"},Ut={class:"li-info"},Jt=J({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},type:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(e,{expose:s,emit:g}){w(localStorage.getItem("adminType"));const v=g,d=e,b=w(!0),P=be().currentRoute.value.query,C=w(d.isDialog?d.act:String(P.act)),S=w(d.isDialog?d.id:Number(P.id));C.value,ye();const l=w({picThumb:"",number:1}),_=w(!1),p=w({logInfo:"",returnPic:[]}),$=async()=>{try{const c=await Le(C.value,{id:S.value});Object.assign(l.value,c),l.value.aftersalesTypeConfig=V(l.value.aftersalesTypeConfig),l.value.statusConfig=V(l.value.statusConfig),l.value.modifyNumber=l.value.number,v("submitCallback","",!1)}catch(c){H.error(c.message),v("close")}finally{b.value=!1}},V=c=>{if(typeof c=="object"){var t=[];for(let y in c)t.push(c[y]);return t}else return c},O=async c=>{if(p.value.logInfo=="")return H.error("请输入留言内容"),!1;try{const t=await Te({aftersaleId:c,...p.value});_.value=!1;let y={logInfo:"",returnPic:[]};p.value=y,$()}catch(t){H.error(t.message)}finally{b.value=!1}};$e(()=>{$()});const E=async()=>{try{const c=await we({id:S.value});H.success("操作成功"),v("submitCallback")}catch(c){H.error(c.message)}},q=async()=>{try{const c=await Be({id:S.value});H.success("操作成功"),v("submitCallback")}catch(c){H.error(c.message)}};return s({onFormSubmit:()=>{v("submitCallback")}}),(c,t)=>{const y=B("el-table-column"),F=B("el-table"),L=B("el-button"),X=B("el-popover"),G=B("TigInput"),I=B("el-form-item"),x=B("el-form"),T=Se("loading");return Ie((a(),r("div",Re,[b.value?m("",!0):(a(),r("div",We,[i("div",Me,[o(F,{data:l.value.aftersalesItems,style:{width:"100%","margin-bottom":"20px"},border:""},{default:f(()=>[o(y,{label:"商品信息",width:"400"},{default:f(({row:n})=>[i("div",Ae,[o(h(Ne),{picThumb:n.picThumb,productId:n.productId,productName:n.productName},null,8,["picThumb","productId","productName"])])]),_:1}),o(y,{label:"商品价格",align:"center"},{default:f(({row:n})=>[i("div",null,u(h(W)(n.price)),1)]),_:1}),o(y,{prop:"quantity",label:"商品数量",align:"center"}),o(y,{prop:"number",label:"退货数量",align:"center"})]),_:1},8,["data"]),i("div",Ve,[i("div",Ee,[t[5]||(t[5]=i("p",null,"售后明细",-1)),o(He,{formState:l.value,type:e.type,onCallback:$,onCloseOrder:q,onConfirmReceipt:E},null,8,["formState","type"])]),i("div",je,[i("div",Fe,[i("ul",null,[i("li",Xe,[t[6]||(t[6]=i("div",null,"售后方式：",-1)),i("div",qe,u(l.value.aftersalesTypeName),1)]),i("li",Ge,[t[7]||(t[7]=i("div",null,"售后状态：",-1)),i("div",Ue,u(l.value.statusName),1)]),i("li",Je,[t[8]||(t[8]=i("div",null,"申请时间：",-1)),i("div",Ke,u(l.value.addTime?l.value.addTime:"--"),1)]),i("li",Qe,[t[9]||(t[9]=i("div",null,"退款原因：",-1)),i("div",Ye,u(l.value.aftersaleReason),1)]),i("li",Ze,[t[10]||(t[10]=i("div",null,"退款说明：",-1)),i("div",ke,u(l.value.description?l.value.description:"--"),1)])])]),i("div",et,[i("ul",null,[l.value.refund?(a(),r("li",tt,[t[16]||(t[16]=i("div",null,"退款进度：",-1)),i("div",it,[o(X,{width:220,"popper-style":"box-shadow: rgb(14 18 22 / 35%) 0px 10px 38px -10px, rgb(14 18 22 / 20%) 0px 10px 20px -15px; padding: 20px;"},{reference:f(()=>[l.value.refund.refundStatus==2?(a(),z(L,{key:0,type:"primary",link:""},{default:f(()=>[...t[11]||(t[11]=[N("退款完成",-1)])]),_:1})):(a(),z(L,{key:1,type:"danger",link:""},{default:f(()=>[...t[12]||(t[12]=[N("退款中",-1)])]),_:1}))]),default:f(()=>[i("div",lt,[t[13]||(t[13]=i("div",{style:{color:"#666"}},"线上退款：",-1)),i("div",st,u(h(W)(l.value.refund.onlineBalance)||"0"),1),i("div",at," ( "+u(l.value.refund.isOnline==2?"退款成功":l.value.refund.isOnline==1?"退款中":"无需退款")+" ) ",1)]),i("div",nt,[t[14]||(t[14]=i("div",{style:{color:"#666"}},"线下退款：",-1)),i("div",ot,u(h(W)(l.value.refund.offlineBalance)||"0"),1),i("div",rt," ( "+u(l.value.refund.isOffline==2?"退款成功":l.value.refund.isOffline==1?"退款中":"无需退款")+" ) ",1)]),i("div",dt,[t[15]||(t[15]=i("div",{style:{color:"#666"}},"余额退款：",-1)),i("div",ut,u(h(W)(l.value.refund.refundBalance)||"0"),1),i("div",ct," ( "+u(l.value.refund.isReceive==2?"退款成功":l.value.refund.isReceive==1?"退款中":"无需退款")+" ) ",1)])]),_:1})])])):m("",!0),l.value.status==2?(a(),r("li",mt,[t[17]||(t[17]=i("div",null,"退款金额：",-1)),i("div",pt,u(h(W)(l.value.suggestRefundAmount)||"0"),1)])):m("",!0),i("li",vt,[t[18]||(t[18]=i("div",null,"物流公司：",-1)),i("div",ft,u(l.value.logisticsName||"--"),1)]),i("li",gt,[t[19]||(t[19]=i("div",null,"物流单号：",-1)),i("div",_t,u(l.value.trackingNo||"--"),1)]),l.value.aftersalesItems?(a(),r("li",ht,[t[20]||(t[20]=N(" 订单编号：",-1)),i("span",bt,u(l.value.aftersalesItems[0].orderSn),1)])):m("",!0)])])])]),i("div",yt,[i("div",$t,[t[22]||(t[22]=i("div",null,"协商记录",-1)),l.value.status==1&&e.type!=2?(a(),r("div",St,[o(L,{bg:"",size:"small",text:"",type:"primary",disabled:_.value,onClick:t[0]||(t[0]=n=>_.value=!0)},{default:f(()=>[...t[21]||(t[21]=[N(" 点击发表留言 ",-1)])]),_:1},8,["disabled"])])):m("",!0)]),_.value?(a(),z(x,{key:0,model:p.value,"label-width":"auto",style:{"margin-top":"20px"}},{default:f(()=>[o(I,{label:"留言内容：",prop:"logInfo"},{default:f(()=>[o(G,{width:"100%",modelValue:p.value.logInfo,"onUpdate:modelValue":t[1]||(t[1]=n=>p.value.logInfo=n),rows:4,type:"textarea",maxlength:300,"show-word-limit":"",placeholder:"你可以在这里给买家留言, 为了保证你的权益, 请尽可能详细的上传留言资料"},null,8,["modelValue"])]),_:1}),o(I,{label:"上传凭证：",prop:"returnPic"},{default:f(()=>[b.value?m("",!0):(a(),z(h(Ce),{key:0,photos:p.value.returnPic,"onUpdate:photos":t[2]||(t[2]=n=>p.value.returnPic=n),isMultiple:!0},null,8,["photos"]))]),_:1}),o(I,null,{default:f(()=>[i("div",It,[o(L,{type:"primary",onClick:t[3]||(t[3]=n=>O(l.value.aftersaleId))},{default:f(()=>[...t[23]||(t[23]=[N("发表留言",-1)])]),_:1}),o(L,{onClick:t[4]||(t[4]=n=>_.value=!1)},{default:f(()=>[...t[24]||(t[24]=[N("取消",-1)])]),_:1})])]),_:1})]),_:1},8,["model"])):m("",!0),i("div",xt,[o(h(M),null,{default:f(()=>[(a(!0),r(ne,null,oe(l.value.aftersalesLog,(n,R)=>(a(),z(h(A),null,{dot:f(()=>[n.userName?(a(),r("div",Ct,"买")):m("",!0),n.adminName?(a(),r("div",Lt,[n.shopId>0?(a(),r("span",Tt,"商")):m("",!0),n.vendorId>0?(a(),r("span",wt,"供")):m("",!0)])):m("",!0)]),default:f(()=>{var K,Q,Y,Z,k,ee;return[i("div",Bt,[i("div",Nt,[R+1==((K=l.value.aftersalesLog)==null?void 0:K.length)?(a(),r("div",Ht,u(n.logInfo),1)):(a(),r("div",Pt,[n.userName?(a(),r("span",zt,"买家")):m("",!0),n.adminName?(a(),r("span",Dt,[n.shopId>0?(a(),r("span",Ot,"商家")):m("",!0),n.vendorId>0?(a(),r("span",Rt,"供应商")):m("",!0)])):m("",!0),t[25]||(t[25]=N(" 留言 ",-1))])),i("div",Wt,u(n.addTime),1)]),i("div",Mt,[R+1!=((Q=l.value.aftersalesLog)==null?void 0:Q.length)?(a(),r("div",At,u(n.logInfo),1)):m("",!0),R+1==((Y=l.value.aftersalesLog)==null?void 0:Y.length)?(a(),r("div",Vt,[t[26]||(t[26]=i("span",null,"售后方式：",-1)),i("span",Et,u(l.value.aftersalesTypeName),1)])):m("",!0),R+1==((Z=l.value.aftersalesLog)==null?void 0:Z.length)?(a(),r("div",jt,[t[27]||(t[27]=i("span",null,"退款原因：",-1)),i("span",Ft,u(l.value.aftersaleReason),1)])):m("",!0),R+1==((k=l.value.aftersalesLog)==null?void 0:k.length)?(a(),r("div",Xt,[t[28]||(t[28]=i("span",null,"退款说明：",-1)),i("span",qt,u(l.value.description),1)])):m("",!0),((ee=n.returnPic)==null?void 0:ee.length)>0?(a(),r("div",Gt,[t[29]||(t[29]=i("span",null,"上传凭证：",-1)),i("span",Ut,[(a(!0),r(ne,null,oe(n.returnPic,te=>(a(),z(h(me),{style:{"margin-right":"10px",border:"1px solid rgba(5, 5, 5, 0.06)"},width:"60",height:"60",src:h(ie)(te.picThumb),"preview-src-list":[h(ie)(te.picUrl)],fit:"cover"},null,8,["src","preview-src-list"]))),256))])])):m("",!0)])])]}),_:2},1024))),256))]),_:1})])])])]))])),[[T,b.value]])}}}),ui=xe(Jt,[["__scopeId","data-v-f4bc9299"]]);export{ui as default};

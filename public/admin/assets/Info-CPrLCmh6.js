import j from"./BasicInfo-BurVH0Px.js";import{_ as A}from"./DescInfo.vue_vue_type_script_setup_true_lang-zvSvbSil.js";import{_ as $}from"./PriceInfo.vue_vue_type_script_setup_true_lang-BH2iYEjC.js";import{d as G,W as M,r as s,b as O,ab as Q,o as H,P as k,f as y,g as N,h as g,i as o,z as p,m as _,F as J,p as K,n as T,t as X,k as Y,l as Z,Q as b,j as x,s as R,_ as ee}from"./index-B52YIGC0.js";import{e as te,f as oe}from"./product-CL06FDSJ.js";import"./productBrief-qpyE78uP.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import"./index-KjhYqCTY.js";import"./index-C9ZdVeVx.js";import"./vuedraggable.umd-BauR0rTv.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./format-BxqOrW-w.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";/* empty css                                                                    */import"./FormAddGalleryVideo-0HIZtwZ5.js";import"./SelectBrand-tHlymKqU.js";import"./brand-CyfpB5Ly.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import"./time-EzYK4E-P.js";import"./SelectCategory.vue_vue_type_script_setup_true_lang-Bb2xH4oQ.js";import"./category-BhaHXalE.js";import"./category-D6KF81Ae.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import"./BusinessData-Dbgv1FCM.js";import"./ProductDesc-CBUomGql.js";import"./Editor.vue_vue_type_style_index_0_lang-ChPMQjFJ.js";import"./index.esm-CBYqueH9.js";import"./Attr-jd_8xuy6.js";import"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-CRFq-JzZ.js";import"./PriceInput.vue_vue_type_script_setup_true_lang-DpJJvzpB.js";const ae={class:"product-container"},re={class:"anchor"},ie={class:"tab-row"},se={id:"part1",class:"form-warp"},ne={id:"part2",class:"form-warp"},le={id:"part3",class:"form-warp"},ce=G({__name:"Info",props:{id:{type:Number,default:0},shopId:{type:Number,default:0},act:{type:String,default:""},examine:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close","closeConfirm"],setup(n,{expose:P,emit:B}){M();const u=B,m=n,D=[{title:"基本信息",id:"part1"},{title:"价格及库存",id:"part2"},{title:"商品详情",id:"part3"}],h=s(null),d=s(""),E=e=>{e.preventDefault()},F=e=>{d.value=e},l=s(!0),S=O().currentRoute.value.query,c=s(m.isDialog?m.act:String(S.act)),f=s(m.isDialog?m.id:Number(S.id)),L=c.value==="add"?"create":c.value==="copy"?"copy":"update",w=Q(),a=s({productType:1,productState:1,skuType:1,productDesc:[],productSnGenerateType:1,video:[],skus:[],skuAttrs:[]});H(async()=>{c.value==="detail"||c.value==="copy"||c.value==="again"?await V():l.value=!1,m.examine!==1&&setTimeout(()=>{u("closeConfirm",!0)},1e4)});const V=async()=>{try{const e=await te("detail",{id:f.value});e.video==null&&(e.video=[]),e.brandId==0&&(e.brandId=""),console.log("详情数据:",e.skus),Object.assign(a.value,e,e)}catch(e){k.error(e.message),u("close")}finally{l.value=!1}};function q(e){for(let t=0;t<e.length;t++){const i=e[t];if(i.skuStock===null||i.skuStock===void 0)return console.error("请填写完整的规格信息"),!1}return!0}const v=s(),W=async()=>{a.value.skus.forEach(e=>{(e.skuWeight||e.supplyPrice)&&(e.skuWeight=Number(e.skuWeight),e.supplyPrice=Number(e.supplyPrice))});try{if(await w.value.validate(),q(a.value.skus))v.value.skuErrorText="";else{k.error("请将商品规格的信息填写完整!"),v.value.skuErrorText="请将商品规格的信息填写完整",await R(),I(".sku-error");return}await v.value.attrForm.validateProductSku();try{u("update:confirmLoading",!0);const e=await oe(L,{...a.value});u("submitCallback",e),k.success(e)}catch(e){k.error(e.message)}finally{u("update:confirmLoading",!1)}}catch{await R(),I()}},I=(e=".el-form-item.is-error")=>{const t=document.querySelector(e);if(t){t.scrollIntoView({behavior:"instant",block:"center"});const i=t.querySelector("input, textarea, select");i&&(i==null||i.focus())}};return P({onFormSubmit:()=>{W()}}),(e,t)=>{const i=y("el-anchor-link"),z=y("el-anchor"),U=y("el-form");return g(),N("div",ae,[o("div",re,[p(z,{container:h.value,offset:10,direction:"horizontal",onChange:F,onClick:E},{default:_(()=>[o("div",ie,[(g(),N(J,null,K(D,(r,C)=>p(i,{key:r.id,class:T({active:d.value===""&&C===0?!0:d.value==="#"+r.id}),href:"#"+r.id},{default:_(()=>[o("div",{class:T([{active:d.value===""&&C===0?!0:d.value==="#"+r.id},"item"])},X(r.title),3)]),_:2},1032,["class","href"])),64))])]),_:1},8,["container"])]),o("div",{ref_key:"containerRef",ref:h,class:"form-container"},[l.value?Z("",!0):(g(),Y(U,{key:0,ref_key:"formRef",ref:w,model:a.value,"label-width":"110px",name:"form_in_modal"},{default:_(()=>[o("div",se,[t[3]||(t[3]=o("div",{class:"title"},[o("p",{class:"xian"}),b(" 基本信息 ")],-1)),p(x(j),{id:f.value,shopId:n.shopId,examine:n.examine,loading:l.value,action:c.value,"form-state":a.value,"onUpdate:formState":t[0]||(t[0]=r=>a.value=r)},null,8,["id","shopId","examine","loading","action","form-state"])]),o("div",ne,[t[4]||(t[4]=o("div",{class:"title"},[o("p",{class:"xian"}),b(" 价格及库存 ")],-1)),p(x($),{ref_key:"priceInfoRef",ref:v,id:f.value,act:n.act,examine:n.examine,loading:l.value,"form-state":a.value,"onUpdate:formState":t[1]||(t[1]=r=>a.value=r)},null,8,["id","act","examine","loading","form-state"])]),o("div",le,[t[5]||(t[5]=o("div",{class:"title"},[o("p",{class:"xian"}),b(" 商品详情 ")],-1)),p(x(A),{id:f.value,examine:n.examine,loading:l.value,formState:a.value,"onUpdate:formState":t[2]||(t[2]=r=>a.value=r)},null,8,["id","examine","loading","formState"])])]),_:1},8,["model"]))],512)])}}}),Qe=ee(ce,[["__scopeId","data-v-0499d80c"]]);export{Qe as default};

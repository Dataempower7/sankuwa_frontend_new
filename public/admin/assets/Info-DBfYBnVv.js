import{d as P,ab as W,r as f,b as z,as as E,o as K,f as s,g as N,h as L,i as n,z as t,m as a,j as x,dw as Y,Q as v,t as C,l as Z,P as y,_ as $}from"./index-B52YIGC0.js";import{a as A,u as H}from"./levelManage-bxq0v_1U.js";import{F as J}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import"./index-KjhYqCTY.js";import"./vuedraggable.umd-BauR0rTv.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./format-BxqOrW-w.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";/* empty css                                                                    */const ee={class:"container"},te={class:"content_wrapper"},ae={class:"lyecs-form-table"},oe={class:"flex mb10"},le={class:"flex"},se={class:"level_txt"},ne={class:"flex flex-align-center"},ie={key:0},re=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(U,{expose:B,emit:V}){const p=V,d=U,m=W(),c=f(!0),b=z().currentRoute.value.query,_=f(d.isDialog?d.act:String(b.act)),D=f(d.isDialog?d.id:Number(b.id)),S=_.value==="add"?"create":"update",T={2:"铂金会员",3:"黑金会员",4:"钻石会员",5:"至尊会员"},e=f({data:[{rankLevel:1,rankName:"黄金会员",rankLogo:"https://oss.tigshop.com/img/gallery/202501/1735803176Yh9mCaE2r9ebXK3bGm.png"}]}),k=E({rankName:[{required:!0,message:"请输入",trigger:"blur"}]}),I=async()=>{try{c.value=!0;const o=await A(_.value);e.value.data=o.userRankList}catch(o){y.error(o.message),p("close")}finally{c.value=!1}},R=["https://oss.tigshop.com/img/gallery/202501/1737524324ro1DJxNm3aQowZKnPU.png","https://oss.tigshop.com/img/gallery/202501/1737524324ZUrDWMFqTPMBTCOlhg.png","https://oss.tigshop.com/img/gallery/202501/1737524324ptLNB2WynLJBBwSHHj.png","https://oss.tigshop.com/img/gallery/202501/1737524324hhmoz188M0ejyXEBhT.png","https://oss.tigshop.com/img/gallery/202501/1737524324O1BXVeurAyDMj9QG8f.png","https://oss.tigshop.com/img/gallery/202501/1737524324T7eKXTpMiCeVQOyFb6.png","https://oss.tigshop.com/img/gallery/202501/1737524324bUufpiVaGcaUad1CWd.png","https://oss.tigshop.com/img/gallery/202501/1737524324NhZbUn45wj1eSaIbjY.png","https://oss.tigshop.com/img/gallery/202501/1737524324bv68MBsoQXa2rLUO9i.png","https://oss.tigshop.com/img/gallery/202501/1737524324urqONY3QDjaTqW7d56.png"],j=async()=>{if(await m.value.validate(),e.value.data.length<=10){let o={rankLevel:e.value.data.length+1,rankName:T[e.value.data.length+1],rankLogo:R[e.value.data.length]};e.value.data.push(o),await m.value.validate()}},M=o=>{e.value.data.splice(o,1)};K(()=>{_.value==="detail"?I():c.value=!1});const q=async()=>{await m.value.validate();try{p("update:confirmLoading",!0);const o=await H(S,{id:D.value,...e.value});p("submitCallback",o),y.success("操作成功")}catch(o){y.error(o.message)}finally{p("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{q()}}),(o,i)=>{const w=s("el-button"),h=s("el-form-item"),u=s("el-table-column"),F=s("el-image"),Q=s("el-tooltip"),O=s("TigInput"),X=s("el-table"),G=s("el-form");return L(),N("div",ee,[n("div",te,[n("div",ae,[i[2]||(i[2]=n("div",{class:"title"},"等级方案",-1)),t(G,{ref_key:"formRef",ref:m,rules:k,model:e.value,"label-width":"auto"},{default:a(()=>[t(h,{prop:"data",style:{"margin-bottom":"0"}},{default:a(()=>[n("div",oe,[n("div",le,[t(w,{type:"primary",icon:x(Y),link:"",onClick:j,disabled:e.value.data.length>=10},{default:a(()=>[v(C(e.value.data.length>=10?"多添加10级":`添加等级(${e.value.data.length}/10)`),1)]),_:1},8,["icon","disabled"])])])]),_:1}),t(h,{prop:"data"},{default:a(()=>[t(X,{data:e.value.data,loading:c.value,"row-key":"userId"},{default:a(()=>[t(u,{width:120,label:"等级",prop:"level"},{default:a(({row:l,$index:r})=>[n("div",se,"vip"+C(l.rankLevel),1)]),_:1}),t(u,{width:130,label:"会员图标",prop:"rankLogo",align:"center"},{default:a(({row:l,$index:r})=>[t(Q,{effect:"light",placement:"bottom","show-after":150},{content:a(()=>[...i[0]||(i[0]=[v(" 点击修改 ",-1)])]),default:a(()=>[n("div",null,[t(x(J),{photo:l.rankLogo,"onUpdate:photo":g=>l.rankLogo=g,type:2},{default:a(()=>[t(F,{style:{height:"20px"},src:l.rankLogo},null,8,["src"])]),_:2},1032,["photo","onUpdate:photo"])])]),_:2},1024)]),_:1}),t(u,{width:300,label:"会员名称*",prop:"rankName"},{default:a(({row:l,$index:r})=>[t(h,{prop:"data."+r+".rankName",rules:k.rankName},{default:a(()=>[n("div",ne,[t(O,{modelValue:l.rankName,"onUpdate:modelValue":g=>l.rankName=g,width:"100px"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["prop","rules"])]),_:1}),t(u,{fixed:"right",width:80,label:"操作",class:"setBtn"},{default:a(({row:l,$index:r})=>[r===e.value.data.length-1&&e.value.data.length>1?(L(),N("div",ie,[t(w,{type:"primary",link:"",size:"mini",onClick:g=>M(r)},{default:a(()=>[...i[1]||(i[1]=[v("删除",-1)])]),_:1},8,["onClick"])])):Z("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1},8,["rules","model"])])])])}}}),we=$(re,[["__scopeId","data-v-88e9b87f"]]);export{we as default};

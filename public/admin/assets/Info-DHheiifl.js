import{d as A,r as s,a as I,a2 as j,c as V,o as $,e as c,j as g,k as N,g as d,l,G as z,z as u,f as G,F as J,m as K,L as M,t as O,J as P,K as v}from"./index-BLXOA87U.js";import{a as X,b as H,u as Q}from"./account-CilAGqUr.js";const Z=A({__name:"Info",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(w,{expose:C,emit:B}){const y=B,i=w,m=s(!0),k=I().currentRoute.value.query,b=s(i.isDialog?i.act:String(k.act)),h=s(i.isDialog?i.id:Number(k.id)),E=b.value==="add"?"create":"update",p=j(),e=s({accountType:1}),_=V(()=>{switch(e.value.accountType){case 1:return"银行卡";case 2:return"支付宝";case 3:return"微信";default:return""}}),S=async()=>{await p.value.resetFields()};V(()=>[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:(a,t,r)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?r():r(new Error("请输入正确的身份证号码"))},trigger:"blur"}]);const q=V(()=>[{required:!0,message:"请输入"+_.value+"号!",trigger:"blur"},{validator:(a,t,r)=>{!/^\d{6,}$/.test(t)&&e.value.accountType===1?r(new Error("请输入正确的银行卡号")):r()},trigger:"blur"}]),L=async()=>{await p.value.validate();try{y("update:confirmLoading",!0);const a=await Q(E,{id:h.value,...e.value});await p.value.resetFields(),v.success("操作成功"),e.value.accountType=1,y("submitCallback",a)}catch(a){v.error(a.message)}finally{y("update:confirmLoading",!1)}},R=()=>{L()},D=async()=>{try{m.value=!0;const a=await X(b.value,{id:h.value});Object.assign(e.value,a)}catch(a){v.error(a.message)}finally{m.value=!1}},x=s([]),F=async()=>{try{const a=await H();x.value=a}catch(a){v.error(a.message)}};return $(()=>{b.value==="detail"?D():m.value=!1,F()}),C({onFormSubmit:R}),(a,t)=>{const r=c("el-radio-button"),T=c("el-radio-group"),n=c("el-form-item"),f=c("TigInput"),U=c("el-form");return m.value?N("",!0):(d(),g(U,{key:0,ref_key:"formRef",ref:p,model:e.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:l(()=>[z(u(n,{rules:[{required:!0,message:"请选择卡类型!"}],label:"卡类型"},{default:l(()=>[u(T,{modelValue:e.value.accountType,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.accountType=o),onChange:S},{default:l(()=>[(d(!0),G(J,null,K(x.value,o=>(d(),g(r,{value:o.accountType},{default:l(()=>[M(O(o.accountTypeText),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1},512),[[P,w.page]]),u(n,{rules:[{required:!0,message:"请输入真实姓名!"}],label:"真实姓名",prop:"accountName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.accountName=o),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),u(n,{label:_.value+"号",rules:q.value,prop:"accountNo"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountNo,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.accountNo=o),placeholder:"请输入"+_.value},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e.value.accountType===1?(d(),g(n,{key:0,label:"分行名称",prop:"bankBranch"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankBranch,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.bankBranch=o),placeholder:"请输入分行名称"},null,8,["modelValue"])]),_:1})):N("",!0),e.value.accountType===1?(d(),g(n,{key:1,label:"银行卡详情",prop:"bankName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankName,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.bankName=o),rows:4,placeholder:"请选择银行卡账号",type:"textarea"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"]))}}});export{Z as default};

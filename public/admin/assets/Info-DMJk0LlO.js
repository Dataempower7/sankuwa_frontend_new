import{d as q,r as m,b as D,ab as U,o as z,P as p,f as n,g as F,h as N,i as w,k as O,l as M,m as r,z as o,Q as P}from"./index-B52YIGC0.js";import{g as Q}from"./languagesList-C1QUNmfU.js";import{e as $,c as A,u as G}from"./translationContent-BL0TsTHo.js";const H={class:"container"},J={class:"content_wrapper"},K={class:"lyecs-form-table"},ee=q({__name:"Info",props:{id:{type:Number,default:0},dataType:{type:Number,default:0},act:{type:String,default:""},translationName:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(L,{expose:T,emit:k}){const i=k,s=L,f=m(!0),g=D().currentRoute.value.query,_=m(s.isDialog?s.act:String(g.act)),y=m(s.isDialog?s.id:Number(g.id)),x=_.value==="add"?"create":"update",v=U(),l=m({translationName:s.translationName,dataType:s.dataType,items:[]});z(()=>{_.value==="detail"?C():(f.value=!1,b())});const C=async()=>{try{const a=await $(_.value,{id:y.value});Object.assign(l.value,a),b()}catch(a){p.error(a.message),i("close")}finally{f.value=!1}},u=m([]),b=async()=>{try{const a=await Q({isEnabled:1,size:-1});a.records.forEach(e=>{e.translationValue=""}),Object.assign(u.value,a.records),_.value==="detail"&&l.value.items.length>0&&l.value.items.forEach(e=>{u.value.forEach(t=>{e.localeId===t.id&&(t.translationValue=e.translationValue)})})}catch(a){p.error(a.message),i("close")}finally{f.value=!1}},E=async a=>{await v.value.validate();try{u.value.forEach(async e=>{let t={code:e.localeCode,text:a};const c=await A(t);e.translationValue=c.translation})}catch(e){p.error(e.message)}},S=a=>{let e=[];return a.forEach(t=>{let c={localeId:t.id,translationValue:t.translationValue};e.push(c)}),e},B=async()=>{await v.value.validate();try{i("update:confirmLoading",!0);const a=await G(x,{id:y.value,...l.value,items:S(u.value)});i("submitCallback",a),p.success("操作成功")}catch(a){p.error(a.message)}finally{i("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{B()}}),(a,e)=>{const t=n("TigInput"),c=n("el-button"),V=n("el-form-item"),h=n("el-table-column"),I=n("el-table"),R=n("el-form");return N(),F("div",H,[w("div",J,[w("div",K,[f.value?M("",!0):(N(),O(R,{key:0,ref_key:"formRef",ref:v,model:l.value,"label-width":"auto"},{default:r(()=>[o(V,{prop:"translationName",label:"翻译原文：",rules:[{required:!0,message:"翻译原文不能为空!"}]},{default:r(()=>[o(t,{type:"text",modelValue:l.value.translationName,"onUpdate:modelValue":e[0]||(e[0]=d=>l.value.translationName=d),width:"300px;",class:"mr10"},null,8,["modelValue"]),o(c,{type:"primary",onClick:e[1]||(e[1]=d=>E(l.value.translationName))},{default:r(()=>[...e[2]||(e[2]=[P("一键生成翻译 ",-1)])]),_:1})]),_:1}),o(V,{prop:"language",label:"翻译列表："},{default:r(()=>[o(I,{data:u.value,style:{width:"100%"}},{default:r(()=>[o(h,{prop:"language",label:"语言",width:"180"}),o(h,{prop:"translationValue",label:"翻译内容"},{default:r(({row:d})=>[o(t,{type:"text",modelValue:d.translationValue,"onUpdate:modelValue":j=>d.translationValue=j},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"]))])])])}}});export{ee as default};

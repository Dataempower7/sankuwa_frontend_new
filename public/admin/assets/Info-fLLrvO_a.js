import{d as Q,r as h,b as Y,ab as H,Y as O,o as J,f as y,g as l,h as a,i as d,k as f,l as L,m as n,z as u,j as p,t as _,F as S,p as D,Q as V,V as K,n as W,P as C,_ as X}from"./index-B52YIGC0.js";import{i as Z,j as ee}from"./buyShow-GI1gwX70.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import"./index-KjhYqCTY.js";import{i as U}from"./format-BxqOrW-w.js";import{S as te}from"./SelectProduct-C4WsEKWV.js";/* empty css                                                                    *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import{F as ae}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import{F as oe}from"./FormAddGalleryVideo-0HIZtwZ5.js";import le from"./BuyerInfo-CKIe2J3E.js";import{_ as re}from"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import{_ as T}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./time-EzYK4E-P.js";import"./index-C9ZdVeVx.js";import"./product-hE35r0Q_.js";import"./Pagination-C8J7-6Em.js";import"./SelectSku-ZXdrD9qH.js";/* empty css                                                                  */import"./vuedraggable.umd-BauR0rTv.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";/* empty css                                                                    */const se={class:"content_wrapper"},ie={class:"lyecs-form-table"},ue={key:0},ne={key:0,class:"flex"},de={key:0,class:"video-preview"},pe=["src"],me={key:1},ce={key:1,class:"flex-column"},ve={key:0},fe={key:0,class:"imgList"},ge={key:1},ye={key:1,class:"flex-column"},_e={key:0,style:{width:"100%"}},be={key:0},he={class:"groupDataBox"},ke={key:1},we={key:1,style:{width:"100%"}},Se={key:0,style:{width:"100%"}},De={class:"flex"},xe={class:"groupDataBox"},Le={key:0},Ve=Q({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isSelf:{type:Number,default:0},examine:{type:Number,default:0},isDialog:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},type:{type:String,default:""}},emits:["submitCallback","update:confirmLoading","close"],setup(b,{expose:$,emit:q}){const k=q,s=b,c=h(!0),I=Y().currentRoute.value.query,x=h(s.isDialog?s.act:String(I.act)),N=h(s.isDialog?s.id:Number(I.id)),B=x.value==="add"?"create":"update",w=H(),e=h({sortOrder:0});O(()=>s.act,o=>{o=="add"&&(e.value={sortOrder:0,rangeData:[]})},{deep:!0,immediate:!0});const g=h([]),F=o=>{e.value.groupData=o.map(t=>t.buyerShowGroupId),g.value=o.map(t=>t.groupName)},G=o=>{var t;g.value.splice(o,1),(t=e.value.groupData)==null||t.splice(o,1)},R=async()=>{try{c.value=!1;const o=await Z({buyerShowId:N.value});Object.assign(e.value,{...o,buyerShowVideoList:o.videoList,groupData:o.groupIdList}),g.value=o.groupNameList,c.value=!0}catch(o){C.error(o.message),k("close")}finally{c.value=!1}},j=async()=>{await w.value.validate();try{const o={buyerShowId:N.value,...e.value};B==="create"&&delete o.buyerShowId,k("update:confirmLoading",!0);const t=await ee(B,o);k("submitCallback",t),C.success("操作成功")}catch(o){C.error(o.message)}finally{k("update:confirmLoading",!1)}};return $({onFormSubmit:()=>{j()}}),O(()=>e.value.rangeData,o=>{(o==null?void 0:o.length)>0?w.value.clearValidate("rangeData"):w.value.validateField("rangeData")},{deep:!0}),J(()=>{x.value==="detail"||x.value==="edit"?R():c.value=!1}),(o,t)=>{const v=y("el-form-item"),z=y("TigInput"),A=y("el-icon"),M=y("el-button"),P=y("el-input-number"),E=y("el-form");return a(),l("div",{class:W(["container",{"container-detail":s.act==="detail"}])},[d("div",se,[d("div",ie,[c.value?L("",!0):(a(),f(E,{key:0,ref_key:"formRef",ref:w,model:e.value,"label-width":"auto"},{default:n(()=>[u(v,{prop:"rangeData",label:"关联商品",rules:[{required:!0,message:"请选择关联商品!",trigger:"change"}]},{default:n(()=>[u(p(te),{act:s.act,ids:e.value.rangeData,"onUpdate:ids":t[0]||(t[0]=r=>e.value.rangeData=r),isSelf:s.isSelf},null,8,["act","ids","isSelf"])]),_:1}),u(v,{prop:"buyerName",label:"买家信息",rules:[{required:!0,message:"请选择买家信息!"}]},{default:n(()=>[u(le,{formState:e.value,"onUpdate:formState":t[1]||(t[1]=r=>e.value=r),act:s.act},null,8,["formState","act"])]),_:1}),u(v,{prop:"content",label:"文字内容",rules:[{required:!0,message:"请输入文字内容!"}]},{default:n(()=>[s.act==="detail"?(a(),l("div",ue,_(e.value.content),1)):(a(),f(z,{key:1,style:{width:"100%"},classType:"tig-form-input",type:"textarea",placeholder:"请输入",modelValue:e.value.content,"onUpdate:modelValue":t[2]||(t[2]=r=>e.value.content=r),maxlength:"500","show-word-limit":""},null,8,["modelValue"]))]),_:1}),u(v,{label:"视频内容",prop:"productVideoInfo"},{default:n(()=>{var r;return[s.act==="detail"?(a(),l("div",ne,[(r=e.value.buyerShowVideoList)!=null&&r.length?(a(),l("div",de,[(a(!0),l(S,null,D(e.value.buyerShowVideoList,(i,m)=>(a(),l("video",{key:m,src:p(U)(i.videoUrl),controls:""},null,8,pe))),128))])):(a(),l("div",me,"--"))])):(a(),l("div",ce,[c.value?L("",!0):(a(),f(p(oe),{key:0,video:e.value.buyerShowVideoList,"onUpdate:video":t[3]||(t[3]=i=>e.value.buyerShowVideoList=i),disabled:b.examine==1||b.type!==""},null,8,["video","disabled"])),t[7]||(t[7]=d("div",{class:"extra"},"文字内容选填，视频或图片内容至少上传一项",-1))]))]}),_:1}),u(v,{label:"商品图片",prop:"imgList"},{default:n(()=>{var r;return[s.act==="detail"?(a(),l("div",ve,[(r=e.value.imgList)!=null&&r.length?(a(),l("div",fe,[(a(!0),l(S,null,D(e.value.imgList,(i,m)=>(a(),f(p(re),{style:{width:"80px",height:"80px"},key:m,class:"gallery-img",big:i.picUrl,src:p(U)(i.picThumb)},null,8,["big","src"]))),128))])):(a(),l("div",ge,"--"))])):(a(),l("div",ye,[c.value?L("",!0):(a(),f(p(ae),{key:0,photos:e.value.imgList,"onUpdate:photos":t[4]||(t[4]=i=>e.value.imgList=i),maxCount:8,disabled:b.examine==1||b.type!=="",isMultiple:!0,pageType:"product"},null,8,["photos","disabled"])),t[8]||(t[8]=d("div",{class:"extra"},"最多支持8张图片",-1))]))]}),_:1}),u(v,{prop:"groupData",label:"所属分组"},{default:n(()=>{var r;return[s.act==="detail"?(a(),l("div",_e,[e.value.groupData?(a(),l("div",be,[d("div",null,_(`共${e.value.groupData.length}个分组`),1),d("div",he,[(a(!0),l(S,null,D(g.value,(i,m)=>(a(),l("div",{class:"groupName",key:m},_(i),1))),128))])])):(a(),l("div",ke,"--"))])):(a(),l("div",we,[(r=e.value.groupData)!=null&&r.length&&g.value.length?(a(),l("div",Se,[d("div",De,[V(_(`共${e.value.groupData.length}个分组`)+" ",1),u(p(T),{isDrawer:"",title:"修改分组",width:"600px",path:"promotion/buyerShow/buyerShowListings/groupInfo",onOkCallback:F,params:{groupData:e.value.groupData}},{default:n(()=>[...t[9]||(t[9]=[d("a",{class:"btn-link mr10 ml5 cursor-pointer"},"修改",-1)])]),_:1},8,["params"]),d("a",{class:"btn-link cursor-pointer",onClick:t[5]||(t[5]=i=>e.value.groupData=[])},"清除")]),d("div",xe,[(a(!0),l(S,null,D(g.value,(i,m)=>(a(),l("div",{class:"groupName",key:m},[V(_(i)+" ",1),u(A,{onClick:Ie=>G(m)},{default:n(()=>[u(p(K))]),_:1},8,["onClick"])]))),128))])])):(a(),f(p(T),{key:1,isDrawer:"",title:"修改分组",width:"600px",path:"promotion/buyerShow/buyerShowListings/groupInfo",style:{width:"100%"},onOkCallback:F,params:{groupData:e.value.groupData}},{default:n(()=>[u(M,null,{default:n(()=>[...t[10]||(t[10]=[V("选择分组",-1)])]),_:1})]),_:1},8,["params"]))]))]}),_:1}),u(v,{label:"排序",prop:"sortOrder"},{default:n(()=>[s.act==="detail"?(a(),l("div",Le,_(e.value.sortOrder),1)):(a(),f(P,{key:1,modelValue:e.value.sortOrder,"onUpdate:modelValue":t[6]||(t[6]=r=>e.value.sortOrder=r),min:0,"controls-position":"right"},null,8,["modelValue"]))]),_:1})]),_:1},8,["model"]))])])],2)}}}),tt=X(Ve,[["__scopeId","data-v-d9c566a2"]]);export{tt as default};

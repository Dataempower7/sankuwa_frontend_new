import{d as G,r as d,b as H,ab as M,as as P,o as Q,f as m,g as w,h as i,i as L,k as p,l as _,z as o,m as s,L as $,j as T,F as h,p as J,Q as x,O as K,fG as W,C as X,P as b,fH as Y,_ as Z}from"./index-B52YIGC0.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import"./index-KjhYqCTY.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import{_ as ee}from"./SelectVendor.vue_vue_type_script_setup_true_lang-BoLpkKlM.js";import"./vuedraggable.umd-BauR0rTv.js";/* empty css                                                                    */import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BGZZHoO-.js";import{U as ae}from"./UploadAvatar-BguCYe-c.js";import{f as te}from"./adminUser-Irb9OB0N.js";import oe from"./AuthoritySelect-DfiWAvdD.js";import"./time-EzYK4E-P.js";import"./index-C9ZdVeVx.js";import"./suppliers-C_UEn0j3.js";import"./Image.vue_vue_type_script_setup_true_lang-B8qXJKJq.js";import"./format-BxqOrW-w.js";import"./BusinessImg-B_fZOjqm.js";import"./currencyManagement-DNysi_dA.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";const le={class:"container"},re={class:"content_wrapper"},se={class:"lyecs-form-table"},ne=G({__name:"Info",props:{id:{type:Number,default:0},suppliersId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:B,emit:q}){const y=d(localStorage.getItem("adminType")),c=q,u=N,f=d(!0),U=H().currentRoute.value.query,g=d(u.isDialog?u.act:String(U.act)),k=d(u.isDialog?u.id:Number(U.id)),C=g.value==="add"?"create":"update",S=M(),e=P({userId:"",roleId:0}),I=d(),D=d({}),V=d(!0),R=async()=>{var l,a;try{const n=await W(g.value,{id:k.value});D.value=n.user,Object.assign(e,n),(l=I.value)!=null&&l.some(v=>v.roleId===e.roleId)||(e.roleId=0),e.mobile=((a=n.adminUser)==null?void 0:a.mobile)||n.mobile;let r=X(String(e.avatar));r=="one"?V.value=!0:r=="def"&&(V.value=!1)}catch(n){b.error(n.message),c("close")}finally{f.value=!1}},F=async()=>{try{const l=await te();I.value=l}catch(l){b.error(l.message)}};Q(()=>{y.value==="vendor"&&F(),g.value==="detail"?R():f.value=!1,C!="update"&&u.type==="suppliers"&&(e.roleId=2,e.suppliersId=u.suppliersId)});const A=async()=>{await S.value.validate();try{c("update:confirmLoading",!0);let l={avatar:""};!e.avatar&&e.defAvatar?l.avatar=e.defAvatar:l.avatar=e.avatar;const a=await Y(C,{id:k.value,...e,avatar:l.avatar});c("submitCallback",a),b.success("操作成功")}catch(l){b.error(l.message)}finally{c("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{A()}}),(l,a)=>{const n=m("TigInput"),r=m("el-form-item"),v=m("el-option"),j=m("el-select"),O=m("el-button"),z=m("el-form"),E=m("a-spin");return i(),w("div",le,[L("div",re,[L("div",se,[f.value?_("",!0):(i(),p(z,{key:0,ref_key:"formRef",ref:S,model:e,"label-width":"auto"},{default:s(()=>[o(r,{rules:[{required:!0,message:"管理员名称不能为空!"}],label:"管理员名称",prop:"username"},{default:s(()=>[o(n,{width:"100%",modelValue:e.username,"onUpdate:modelValue":a[0]||(a[0]=t=>e.username=t)},null,8,["modelValue"])]),_:1}),o(r,{label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:s(()=>[o(n,{width:"100%",modelValue:e.mobile,"onUpdate:modelValue":a[1]||(a[1]=t=>e.mobile=t)},null,8,["modelValue"])]),_:1}),o(r,{label:"邮箱",prop:"email"},{default:s(()=>[o(n,{width:"100%",modelValue:e.email,"onUpdate:modelValue":a[2]||(a[2]=t=>e.email=t)},null,8,["modelValue"])]),_:1}),o(r,{label:"头像",prop:"avatar"},{default:s(()=>[o(T(ae),{avatar:e.avatar,"onUpdate:avatar":a[3]||(a[3]=t=>e.avatar=t),avatarType:V.value,loading:f.value},null,8,["avatar","avatarType","loading"])]),_:1}),y.value=="admin"?(i(),p(r,{key:0,label:"所属供应商",prop:"vendorId",rules:[{required:!0,message:"所属供应商不能为空!"}]},{default:s(()=>[o(T(ee),{vendorId:e.vendorId,"onUpdate:vendorId":a[4]||(a[4]=t=>e.vendorId=t)},null,8,["vendorId"])]),_:1})):_("",!0),y.value=="vendor"?(i(),p(r,{key:1,label:"员工权限组",prop:"roleId"},{default:s(()=>[e.roleId!=2?(i(),p(j,{key:0,modelValue:e.roleId,"onUpdate:modelValue":a[5]||(a[5]=t=>e.roleId=t),style:{width:"100%"}},{default:s(()=>[o(v,{value:0,label:"自定义权限"}),(i(!0),w(h,null,J(I.value,t=>(i(),p(v,{label:t.roleName,value:t.roleId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(i(),w(h,{key:1},[x(" 供应商")],64))]),_:1})):_("",!0),e.roleId===0?(i(),p(r,{key:2,label:"",prop:"authList"},{default:s(()=>[o(oe,{modelValue:e.authList,"onUpdate:modelValue":a[6]||(a[6]=t=>e.authList=t),adminType:"vendor"},null,8,["modelValue"])]),_:1})):_("",!0),$(o(r,{"wrapper-col":{offset:4,span:16}},{default:s(()=>[o(O,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:A},{default:s(()=>[...a[7]||(a[7]=[x("提交",-1)])]),_:1},512)]),_:1},512),[[K,!u.isDialog]])]),_:1},8,["model"])),o(E,{spinning:f.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Ne=Z(ne,[["__scopeId","data-v-2322cf35"]]);export{Ne as default};

/* empty css             */import"./index-KjhYqCTY.js";import{g as z,a as O,e as Q}from"./statementDownload-XgKTVaBc.js";import{d as A,r as b,au as _,g as T,i as n,z as s,m as o,P as w,f as i,h as d,F as N,p as S,k,Q as f,t as v,j as G,l as H,_ as J}from"./index-B52YIGC0.js";import{r as K}from"./export-Ds6vL4MA.js";import{_ as R}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";const W={class:"container"},X={class:"content_wrapper"},Z={class:"lyecs-table-list-warp"},ee={class:"list-table-tool lyecs-search-warp"},te={class:"list-table-tool-row"},ae={class:"simple-form-warp"},le={class:"simple-form-field"},ne={class:"form-group"},se={class:"simple-form-field"},oe={class:"form-group"},re={class:"control-container"},ie={class:"simple-form-field"},ce={class:"simple-form-field"},ue={class:"table-container"},me={class:"green"},de={class:"empty-warp"},pe={key:0,class:"empty-bg"},_e=A({__name:"List",props:{source:{type:String,default:"shop"}},setup(F){const C=F,L=[{label:"日汇总",value:"day"},{label:"月汇总",value:"month"},{label:"年汇总",value:"year"}],y=b(!1),V=b([]),x=_(new Date),m=b(x?x.split("-"):""),l=b({source:C.source,statementDate:`${m.value[0]}-${m.value[1]}`,statementDateType:"day",accountType:""}),p=async()=>{try{const a=await O({...l.value});V.value=a}catch(a){w.error(a.message)}finally{y.value=!1}},Y=b({});(async()=>{try{const a=await z();Y.value=a,l.value.accountType=a.accountType[0].code,await p()}catch(a){w.error(a.message)}finally{y.value=!1}})();const B=a=>{if(l.value.statementDateType=a,a=="day"&&(l.value.statementDate=`${m.value[0]}-${m.value[1]}`),a=="month"&&(l.value.statementDate=`${m.value[0]}`),a=="year"){const e=new Date;e.setFullYear(e.getFullYear()-1);const r=_(e),c=r?r.split("-"):"";l.value.statementDate=`${c[0]}`}p()},U=()=>{l.value={statementDate:`${m.value[0]}-${m.value[1]}`,statementDateType:"day",accountType:""},p()},E=async a=>{try{const e=await Q({statementDate:a.statementDate,statementDateType:l.value.statementDateType,accountType:a.accountType});K(e,`【${a.statementDate}对账单】`)}catch(e){w.error(e.message)}},$=(a,e)=>{let r="";if(l.value.statementDateType==="day"&&(r=a),l.value.statementDateType==="month"){const[c,u]=a.split("-");if(e==="start"){const D=new Date(Number(c),Number(u)-1,1);r=_(D)||""}if(e==="end"){const D=new Date(Number(c),Number(u),0);r=_(D)||""}}if(l.value.statementDateType==="year"){const c=a;if(e==="start"){const u=new Date(Number(c),0,1);r=_(u)||""}if(e==="end"){const u=new Date(Number(c),11,31);r=_(u)||""}}return e==="start"&&(r+=" 00:00:00"),e==="end"&&(r+=" 23:59:59"),r};return(a,e)=>{const r=i("el-tab-pane"),c=i("el-tabs"),u=i("el-date-picker"),D=i("el-option"),I=i("el-select"),h=i("el-button"),M=i("el-form"),g=i("el-table-column"),P=i("el-divider"),j=i("el-table"),q=i("a-spin");return d(),T("div",W,[n("div",X,[n("div",Z,[s(c,{modelValue:l.value.statementDateType,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.statementDateType=t),type:"card",onTabChange:B},{default:o(()=>[(d(),T(N,null,S(L,t=>s(r,{label:t.label,name:t.value},null,8,["label","name"])),64))]),_:1},8,["modelValue"]),n("div",ee,[s(M,{model:l.value},{default:o(()=>[n("div",te,[n("div",ae,[n("div",le,[n("div",ne,[l.value.statementDateType==="day"?(d(),k(u,{key:0,modelValue:l.value.statementDate,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.statementDate=t),type:"month","value-format":"YYYY-MM",placeholder:"请选择日期"},null,8,["modelValue"])):(d(),k(u,{key:1,modelValue:l.value.statementDate,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.statementDate=t),type:"year","value-format":"YYYY",placeholder:"请选择日期"},null,8,["modelValue"]))])]),n("div",se,[n("div",oe,[n("div",re,[s(I,{clearable:"",placeholder:"请选择账户",modelValue:l.value.accountType,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.accountType=t),onChange:p},{default:o(()=>[(d(!0),T(N,null,S(Y.value.accountType,t=>(d(),k(D,{label:t.description,value:t.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])])])]),n("div",ie,[s(h,{type:"primary",plain:"",onClick:p},{default:o(()=>[...e[4]||(e[4]=[f("搜索",-1)])]),_:1})]),n("div",ce,[s(h,{plain:"",onClick:U},{default:o(()=>[...e[5]||(e[5]=[f("重置",-1)])]),_:1})])])])]),_:1},8,["model"])]),n("div",ue,[s(q,{spinning:y.value},{default:o(()=>[s(j,{data:V.value,loading:y.value,"row-key":"invoiceId"},{empty:o(()=>[n("div",de,[y.value?H("",!0):(d(),T("div",pe,"暂无数据"))])]),default:o(()=>[s(g,{label:"日期",prop:"statementDate"},{default:o(({row:t})=>[f(v(t.statementDate||"--"),1)]),_:1}),s(g,{label:"账户",prop:"accountType"},{default:o(({row:t})=>[f(v(t.accountTypeText||"--"),1)]),_:1}),s(g,{label:"收入(元)",prop:"income",width:150,align:"right"},{default:o(({row:t})=>[n("p",me,"+ "+v(t.income||"0.00"),1),n("p",null,v(t.incomeCount||"0")+"笔",1)]),_:1}),s(g,{label:"支出(元)",prop:"expenditure",width:150,align:"right"},{default:o(({row:t})=>[n("p",null,"- "+v(t.expenditure||"0.00"),1),n("p",null,v(t.expenditureCount||"0")+"笔",1)]),_:1}),s(g,{width:210,fixed:"right",label:"操作",align:"right"},{default:o(({row:t})=>[s(h,{link:"",type:"primary",onClick:ve=>E(t)},{default:o(()=>[...e[6]||(e[6]=[f("下载报表",-1)])]),_:1},8,["onClick"]),s(P,{direction:"vertical"}),s(G(R),{params:{source:C.source,startDateTime:$(t.statementDate,"start"),endDateTime:$(t.statementDate,"end")},isDrawer:"",path:"finance/shopFunds/statementDetails/List",title:"查看明细",width:"1100px",onOkCallback:p},{default:o(()=>[s(h,{link:"",type:"primary"},{default:o(()=>[...e[7]||(e[7]=[f("查看明细",-1)])]),_:1})]),_:1},8,["params"])]),_:1})]),_:1},8,["data","loading"])]),_:1},8,["spinning"])])])])])}}}),ke=J(_e,[["__scopeId","data-v-c6d80177"]]);export{ke as default};

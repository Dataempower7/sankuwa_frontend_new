/* empty css             */import"./index-KjhYqCTY.js";import{_ as B}from"./Switch.vue_vue_type_script_setup_true_lang-D-71VfIC.js";import{D as M}from"./DeleteRecord-BTXBpwL2.js";/* empty css                                                                    */import{P as de}from"./Pagination-C8J7-6Em.js";import{i as ie}from"./format-BxqOrW-w.js";import{d as pe,b as ce,x as ue,r as m,as as $,X as me,o as ge,P as O,f as d,g as v,h as c,i as n,z as a,m as o,k as A,l as f,Q as y,j as l,ae as _e,t as I,ax as fe,F as ye}from"./index-B52YIGC0.js";import{P as V}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-CRFq-JzZ.js";import{g as S,u as b,d as E,b as ve}from"./category-BhaHXalE.js";import{u as he}from"./category-D6KF81Ae.js";import{_ as U}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";const ke=["href"],Ie={class:"container"},be={class:"content_wrapper"},Ce={class:"lyecs-table-list-warp"},xe={class:"list-table-tool lyecs-search-warp"},ze={class:"list-table-tool-row"},qe={class:"list-table-tool-col"},Ae={key:2},Se={class:"table-container"},Ue=["onClick"],De={key:1},Ne={key:0},we={class:"empty-warp"},Oe={key:0,class:"empty-bg"},Ve={key:0,class:"pagination-con"},Je=pe({__name:"List",setup(Pe){const H=he(),{currentRoute:L}=ce(),P=ue(),j=m(P.icoDefinedCss),F=m([]),C=m(!0),x=m(0),h=m([]),Q=m([]),i=$({page:1,size:P.get("pageSize"),sortField:"",sortOrder:"",keyword:"",isShow:-1,parentId:0}),z=m([0]);m();const X=me(),k=$({});ge(()=>{const s=L.value.query;s.id>0&&(i.parentId=s.id),X.meta.title="",u()});const u=async()=>{C.value=!0;try{const s=await S({...i});F.value=s.records,x.value=s.total}catch(s){O.error(s.message)}finally{C.value=!1}},G=async(s,t,r)=>{k[s.categoryId]={},k[s.categoryId].resolve=r,k[s.categoryId].expandCount=0;const g=await S({page:1,parentId:s.categoryId,size:1e3});r(g.records),s.children=g.records},J=async(s,t)=>{const r=k[s.categoryId];if(r.expandCount++,t&&r.expandCount>1&&!r.prevStatus){const g=await S({page:1,parentId:s.categoryId,size:1e3});r.resolve(g.records)}r.prevStatus=t},q=m(),D=async(s,t)=>{const r=k[t.parentId];if(r){const g=await S({page:1,parentId:t.parentId,size:1e3});q.value.store.states.lazyTreeNodeMap.value[t.parentId].length>1?q.value.store.states.lazyTreeNodeMap[t.parentId]=[]:q.value.store.states.lazyTreeNodeMap.value[t.parentId]=[],r.resolve(g.records)}else u()},N=()=>{H.clearCategory()},K=s=>{z.value.push(s),i.parentId=s,u()},W=()=>{z.value.pop(),i.parentId=z.value[z.value.length-1],u()},Y=async s=>{try{const t=await ve(s,{ids:h.value});O.success("操作成功"),u()}catch(t){O.error(t.message)}},Z=s=>{h.value=s.map(t=>t.categoryId)};return(s,t)=>{const r=d("el-button"),g=d("router-link"),ee=d("el-popconfirm"),w=d("el-space"),te=d("el-form"),_=d("el-table-column"),ae=d("el-image"),R=d("el-divider"),oe=d("el-icon"),T=d("el-dropdown-item"),se=d("el-dropdown-menu"),le=d("el-dropdown"),re=d("el-table"),ne=d("a-spin");return c(),v(ye,null,[n("link",{href:j.value,rel:"stylesheet"},null,8,ke),n("div",Ie,[n("div",be,[n("div",Ce,[n("div",xe,[a(te,{model:i,name:"form"},{default:o(()=>[n("div",ze,[n("div",qe,[a(w,null,{default:o(()=>[i.parentId>0?(c(),A(r,{key:0,onClick:W},{default:o(()=>[...t[3]||(t[3]=[n("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),y(" 返回上一级 ",-1)])]),_:1})):f("",!0),a(l(U),{params:{act:"add",parentId:i.parentId},isDrawer:"",path:"product/category/Info",title:"添加分类",width:"600px",onOkCallback:u},{default:o(()=>[a(r,{type:"primary"},{default:o(()=>[...t[4]||(t[4]=[y("添加分类",-1)])]),_:1})]),_:1},8,["params"]),l(_e)()?(c(),A(g,{key:1,to:{path:"/setting/translationContent/list",query:{type:"category"}}},{default:o(()=>[a(r,null,{default:o(()=>[...t[5]||(t[5]=[y("批量翻译分类名称",-1)])]),_:1})]),_:1})):f("",!0),a(ee,{title:"您确认要批量删除所选数据吗？",onConfirm:t[0]||(t[0]=e=>Y("del"))},{reference:o(()=>[a(r,{disabled:h.value.length===0},{default:o(()=>[...t[6]||(t[6]=[y("批量删除",-1)])]),_:1},8,["disabled"])]),_:1}),h.value.length>0?(c(),v("span",Ae,[t[7]||(t[7]=y(" 已选择：",-1)),n("b",null,I(h.value.length),1),t[8]||(t[8]=y(" 项 ",-1))])):f("",!0)]),_:1})])])]),_:1},8,["model"])]),n("div",Se,[a(ne,{spinning:C.value},{default:o(()=>[a(re,{data:F.value,"expand-row-keys":Q.value,indent:30,load:G,total:x.value,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"","row-key":"categoryId",onSelectionChange:Z,onExpandChange:J,ref_key:"tableRef",ref:q},{empty:o(()=>[n("div",we,[C.value?f("",!0):(c(),v("div",Oe,"暂无数据"))])]),default:o(()=>[a(_,{type:"selection",width:"32"}),a(_,{width:200,label:"分类名称"},{default:o(({row:e})=>[a(w,{style:{"min-height":"30px"}},{default:o(()=>[a(l(V),{"org-value":e.categoryName,"onUpdate:orgValue":p=>e.categoryName=p,params:{id:e.categoryId,field:"categoryName"},requestApi:l(b),label:"分类名称",type:"textarea",onCallback:N},{default:o(()=>[e.hasChildren?(c(),v("a",{key:0,onClick:p=>K(e.categoryId)},I(e.categoryName),9,Ue)):(c(),v("span",De,I(e.categoryName),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:2},1024)]),_:1}),a(_,{width:120,label:"分类图片"},{default:o(({row:e})=>[e.categoryPic?(c(),v("div",Ne,[a(ae,{src:l(ie)(e.categoryPic),fit:"contain",style:{height:"30px",width:"30px"}},null,8,["src"])])):f("",!0)]),_:1}),a(_,{label:"单位"},{default:o(({row:e})=>[a(l(V),{"org-value":e.measureUnit,"onUpdate:orgValue":p=>e.measureUnit=p,params:{id:e.categoryId,field:"measureUnit"},requestApi:l(b),label:"单位",type:"input",onCallback:N},{default:o(()=>[n("div",null,I(e.measureUnit||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(_,{label:"是否热门"},{default:o(({row:e})=>[a(l(B),{checked:e.isHot,"onUpdate:checked":p=>e.isHot=p,params:{id:e.categoryId,field:"isHot"},requestApi:l(b)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(_,{key:"isShow",sorter:!0,label:"是否显示"},{default:o(({row:e})=>[a(l(B),{checked:e.isShow,"onUpdate:checked":p=>e.isShow=p,params:{id:e.categoryId,field:"isShow"},requestApi:l(b)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(_,{key:"sortOrder",sorter:!0,label:"排序"},{default:o(({row:e})=>[a(l(V),{"org-value":e.sortOrder,"onUpdate:orgValue":p=>e.sortOrder=p,params:{id:e.categoryId,field:"sortOrder"},requestApi:l(b),label:"排序",type:"integer",onCallback:N},{default:o(()=>[n("div",null,I(e.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(_,{width:180,fixed:"right",label:"操作"},{default:o(({row:e})=>[a(w,{size:0},{default:o(()=>[a(l(U),{params:{act:"detail",id:e.categoryId},data:{parentId:e.parentId},isDrawer:"",path:"product/category/Info",title:"编辑分类",width:"600px",onOkCallback:D},{default:o(()=>[...t[9]||(t[9]=[n("a",{class:"btn-link"},"编辑",-1)])]),_:1},8,["params","data"]),a(R,{direction:"vertical"}),a(l(U),{params:{act:"add",parentId:e.categoryId},data:{parentId:e.parentId||e.categoryId},isDrawer:"",path:"product/category/Info",title:"添加子分类",width:"600px",onOkCallback:D},{default:o(()=>[...t[10]||(t[10]=[n("a",{class:"btn-link"},"添加子分类",-1)])]),_:1},8,["params","data"]),a(R,{direction:"vertical"}),a(le,{trigger:"hover","hide-on-click":!1},{dropdown:o(()=>[a(se,null,{default:o(()=>[a(T,null,{default:o(()=>[a(l(U),{params:{id:e.categoryId},isDrawer:"",path:"product/category/Move",title:"商品转移",width:"600px",onOkCallback:u},{default:o(()=>[...t[11]||(t[11]=[n("a",{class:"btn-link"},"商品转移",-1)])]),_:1},8,["params"])]),_:2},1024),a(T,null,{default:o(()=>[e.parentId?(c(),A(l(M),{key:0,params:{id:e.categoryId},requestApi:l(E),onAfterDelete:p=>D({},{parentId:e.parentId})},{default:o(()=>[...t[12]||(t[12]=[y(" 删除 ",-1)])]),_:1},8,["params","requestApi","onAfterDelete"])):f("",!0),e.parentId?f("",!0):(c(),A(l(M),{key:1,params:{id:e.categoryId},requestApi:l(E),onAfterDelete:u},{default:o(()=>[...t[13]||(t[13]=[y("删除",-1)])]),_:1},8,["params","requestApi"]))]),_:2},1024)]),_:2},1024)]),default:o(()=>[a(oe,{class:"btn-link",size:"12"},{default:o(()=>[a(l(fe))]),_:1})]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),x.value>0?(c(),v("div",Ve,[a(l(de),{page:i.page,"onUpdate:page":t[1]||(t[1]=e=>i.page=e),size:i.size,"onUpdate:size":t[2]||(t[2]=e=>i.size=e),total:x.value,onCallback:u},null,8,["page","size","total"])])):f("",!0)])])])])],64)}}});export{Je as default};

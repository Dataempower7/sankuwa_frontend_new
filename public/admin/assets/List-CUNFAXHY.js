/* empty css             */import{a6 as x,d as F,u as I,r as _,ab as N,o as O,f as u,g as j,h as z,i as l,z as a,m as i,j as r,dv as k,G as f,Q as d,t as w,ah as B,P as p,_ as R}from"./index-B52YIGC0.js";import{d as q}from"./format-BxqOrW-w.js";const E=()=>x({url:"setting/appVersion/detail",method:"get"}),M=V=>x({url:"setting/appVersion/update",method:"post",data:V}),D={class:"container"},G={class:"content_wrapper"},Q={class:"lyecs-form-table"},$={class:"link-wrapper"},H={class:"link-wrapper"},J={class:"selected-action"},K=F({__name:"List",emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:h,emit:S}){const{themeInfo:C}=I(),c=S,T=_(!1),s=_({}),g=_(!0),b=N(),U=async()=>{g.value=!0;try{const e=await E();Object.assign(s.value,q(e))}catch(e){p.error(e.message)}finally{g.value=!1}},y=(e,t)=>{if(e.file.status=="uploading",e.file.status,e.file.status==="done")if(e.file.response.code!==0)e.file.status="error",p.error(e.file.response.data.message);else{console.log(e.file.response);for(let n in e.fileList)e.file.uid==e.fileList[n].uid&&(e.fileList[n]=Object.assign(e.fileList[n],e.fileList[n].response.data));t==="android"&&(s.value.androidLink=e.file.response.data),t==="ios"&&(s.value.iosLink=e.file.response.data),p.success("文件上传成功！")}else e.file.status==="error"&&p.error(`${e.file.name} 文件上传失败！`)};O(()=>{U()});const L=async()=>{await b.value.validate();try{c("update:confirmLoading",!0);const e=await M({...s.value});c("submitCallback",e),p.success("操作成功")}catch(e){p.error(e.message)}finally{c("update:confirmLoading",!1)}};return h({onFormSubmit:()=>{L()}}),(e,t)=>{const n=u("TigInput"),m=u("el-form-item"),v=u("el-button"),A=u("el-form"),P=u("a-spin");return z(),j("div",D,[l("div",G,[l("div",Q,[a(P,{spinning:g.value,style:{width:"100%","margin-top":"100px"}},{default:i(()=>[a(A,{ref_key:"formRef",ref:b,model:s.value,"label-width":"auto",style:{display:"flex",gap:"12px","flex-direction":"column"}},{default:i(()=>[t[8]||(t[8]=l("div",{class:"title"},"APP版本",-1)),a(m,{label:"Android版本号",prop:"androidVersion"},{default:i(()=>[a(n,{classType:"tig-form-input",modelValue:s.value.androidVersion,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.androidVersion=o),type:"text"},null,8,["modelValue"])]),_:1}),a(m,{label:"Android下载链接",prop:"androidLink"},{default:i(()=>[l("div",null,[l("div",$,[a(n,{classType:"tig-form-input",modelValue:s.value.androidLink,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.androidLink=o),disabled:"",type:"text"},null,8,["modelValue"]),a(r(k),{name:"file",action:r(f).prefix+"/setting/appVersion/uploadFile",headers:r(f).headers(),onChange:t[2]||(t[2]=o=>y(o,"android")),showUploadList:!1,multiple:!1,accept:".apk,.wgt"},{default:i(()=>[a(v,null,{default:i(()=>[d(w(s.value.androidLink?"重新上传":"点击上传"),1)]),_:1})]),_:1},8,["action","headers"])]),t[6]||(t[6]=l("div",{class:"extra"},[d(" 版本升级需制作热更新文件，制作时版本号需要高一个版本号。具体制作请参考"),l("a",{href:"https://www.tigshop.com/course/tigshop/187506502217291111",target:"_blank"}," 《APP版本管理》 "),d("教程。 ")],-1))])]),_:1}),a(m,{label:"iOS版本号",prop:"iosVersion"},{default:i(()=>[a(n,{classType:"tig-form-input",modelValue:s.value.iosVersion,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.iosVersion=o),type:"text"},null,8,["modelValue"])]),_:1}),a(m,{label:"iOS下载链接",prop:"iosLink"},{default:i(()=>[l("div",null,[l("div",H,[a(n,{classType:"tig-form-input",modelValue:s.value.iosLink,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.iosLink=o),disabled:"",type:"text"},null,8,["modelValue"]),a(r(k),{name:"file",action:r(f).prefix+"/setting/appVersion/uploadFile",headers:r(f).headers(),onChange:t[5]||(t[5]=o=>y(o,"ios")),showUploadList:!1,multiple:!1,accept:".wgt"},{default:i(()=>[a(v,null,{default:i(()=>[d(w(s.value.iosLink?"重新上传":"点击上传"),1)]),_:1})]),_:1},8,["action","headers"])]),t[7]||(t[7]=l("div",{class:"extra"},[d(" 版本升级需制作热更新文件，制作时版本号需要高一个版本号。具体制作请参考"),l("a",{href:"https://www.tigshop.com/course/tigshop/187506502217291111",target:"_blank"}," 《APP版本管理》 "),d("教程。 ")],-1))])]),_:1})]),_:1},8,["model"]),l("div",{class:"selected-action-warp selected-warp-left",style:B({left:r(C).layout!=="topMenu"?"369px":"270px"})},[l("div",J,[a(v,{loading:T.value,class:"form-submit-btn",size:"large",type:"primary",onClick:L},{default:i(()=>[...t[9]||(t[9]=[d("提 交",-1)])]),_:1},8,["loading"])])],4)]),_:1},8,["spinning"])])])])}}}),ee=R(K,[["__scopeId","data-v-26aeb829"]]);export{ee as default};

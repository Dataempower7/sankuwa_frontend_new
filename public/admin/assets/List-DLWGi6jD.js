/* empty css             */import"./index-KjhYqCTY.js";import{d as ae,b as re,R as le,x as se,r as c,as as $,X as oe,o as ne,P as S,f as m,g as f,h as u,i as s,z as r,m as l,k as q,l as _,Q as y,j as n,t as b,F as ie,_ as de}from"./index-B52YIGC0.js";import{D as B}from"./DeleteRecord-BTXBpwL2.js";/* empty css                                                                    */import{P as pe}from"./Pagination-C8J7-6Em.js";import{P as D}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-CRFq-JzZ.js";import{a as A,u as O,d as M,b as ce}from"./articleCategory-CNnOMiMc.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";const ue=["href"],ge={class:"container"},me={class:"content_wrapper"},ye={class:"lyecs-table-list-warp"},fe={class:"list-table-tool lyecs-search-warp"},_e={class:"list-table-tool-row"},ve={class:"list-table-tool-col"},Ce={key:1},Ie={class:"table-container"},be={style:{position:"relative"}},he=["onClick"],ke={key:1},xe={class:"empty-warp"},ze={key:0,class:"empty-bg"},Ae={key:0,class:"pagination-con"},Ne=ae({__name:"List",setup(Se){const{currentRoute:E}=re(),T=le(),F=se(),L=c(F.icoDefinedCss),R=c([]),h=c(!0),k=c(0),v=c([]),j=c([]),i=$({page:1,size:F.get("pageSize"),sortField:"",sortOrder:"",keyword:"",parentId:0}),x=c([0]),H=c(),w=oe();ne(()=>{const a=E.value.query;a.id>0&&(i.parentId=a.id),w.meta.title="",d()});const d=async()=>{h.value=!0;try{const a=await A({...i});R.value=a.records,k.value=a.total,H.value=a.parentName,a.parentName?T.setHeaderTitle("文章分类列表 - "+a.parentName):T.setHeaderTitle("文章分类列表")}catch(a){S.error(a.message)}finally{h.value=!1}},C=$({}),Q=async(a,e,o)=>{C[a.articleCategoryId]={},C[a.articleCategoryId].resolve=o,C[a.articleCategoryId].expandCount=0;const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o(g.records),a.children=g.records},X=async(a,e)=>{const o=C[a.articleCategoryId];if(o.expandCount++,e&&o.expandCount>1&&!o.prevStatus){const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o.resolve(g.records)}o.prevStatus=e},z=c(null),N=async(a,e)=>{const o=C[e.parentId];if(o){const g=await A({page:1,parentId:e.parentId,size:1e3});z.value.store.states.lazyTreeNodeMap.value[e.parentId].length>1?z.value.store.states.lazyTreeNodeMap[e.parentId]=[]:z.value.store.states.lazyTreeNodeMap.value[e.parentId]=[],o.resolve(g.records)}d()},G=a=>{x.value.push(a),i.parentId=a,d()},J=()=>{x.value.pop(),i.parentId=x.value[x.value.length-1],d()},K=async a=>{try{const e=await ce(a,{ids:v.value});S.success("操作成功"),await d()}catch(e){S.error(e.message)}},W=({prop:a,order:e})=>{i.sortField=a,i.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},Y=a=>{v.value=a.map(e=>e.articleCategoryId)};return(a,e)=>{const o=m("el-button"),g=m("el-popconfirm"),U=m("el-space"),Z=m("el-form"),I=m("el-table-column"),P=m("el-divider"),ee=m("el-table"),te=m("a-spin");return u(),f(ie,null,[s("link",{href:L.value,rel:"stylesheet"},null,8,ue),s("div",ge,[s("div",me,[s("div",ye,[s("div",fe,[e[8]||(e[8]=s("div",{class:"list-table-tips"},[s("div",null,"分类编号对应了系统一些内置分类"),s("div",null," 帮助中心：[bzzx]     客服中心：[kfzx]     热门问题：[rmwt]     本站公告：[bzgg]    资讯中心：[zxzx]    卖家中心：[mjzx] ")],-1)),r(Z,{model:i,name:"form"},{default:l(()=>[s("div",_e,[s("div",ve,[r(U,null,{default:l(()=>[i.parentId>0?(u(),q(o,{key:0,onClick:J},{default:l(()=>[...e[3]||(e[3]=[s("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),y(" 返回上一级 ",-1)])]),_:1})):_("",!0),r(n(V),{params:{act:"add",parentId:i.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"添加文章分类",width:"580px",onOkCallback:d},{default:l(()=>[r(o,{type:"primary"},{default:l(()=>[...e[4]||(e[4]=[y("添加文章分类",-1)])]),_:1})]),_:1},8,["params"]),r(g,{title:"您确认要批量删除所选数据吗？",onConfirm:e[0]||(e[0]=t=>K("del"))},{reference:l(()=>[r(o,{disabled:v.value.length===0},{default:l(()=>[...e[5]||(e[5]=[y("批量删除",-1)])]),_:1},8,["disabled"])]),_:1}),v.value.length>0?(u(),f("span",Ce,[e[6]||(e[6]=y(" 已选择：",-1)),s("b",null,b(v.value.length),1),e[7]||(e[7]=y(" 项 ",-1))])):_("",!0)]),_:1})])])]),_:1},8,["model"])]),s("div",Ie,[r(te,{spinning:h.value},{default:l(()=>[r(ee,{onSortChange:W,data:R.value,"expand-row-keys":j.value,indent:30,load:Q,total:k.value,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"","row-key":"articleCategoryId",onSelectionChange:Y,onExpandChange:X,ref_key:"tableRef",ref:z},{empty:l(()=>[s("div",xe,[h.value?_("",!0):(u(),f("div",ze,"暂无数据"))])]),default:l(()=>[r(I,{type:"selection",width:"32"}),r(I,{width:200,label:"文章分类名称"},{default:l(({row:t})=>[r(U,{style:{height:"30px"}},{default:l(()=>[s("div",be,[r(n(D),{"org-value":t.articleCategoryName,"onUpdate:orgValue":p=>t.articleCategoryName=p,params:{id:t.articleCategoryId,field:"articleCategoryName"},requestApi:n(O),label:"权限名称",type:"textarea"},{default:l(()=>[t.hasChildren?(u(),f("a",{key:0,onClick:p=>G(t.articleCategoryId)},b(t.articleCategoryName),9,he)):(u(),f("span",ke,b(t.articleCategoryName),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),r(I,{label:"分类编号"},{default:l(({row:t})=>[r(n(D),{"org-value":t.categorySn,"onUpdate:orgValue":p=>t.categorySn=p,params:{id:t.articleCategoryId,field:"categorySn"},requestApi:n(O),label:"分类编号",type:"textarea"},{default:l(()=>[s("div",null,b(t.categorySn||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(I,{key:"sortOrder",sortable:"custom",label:"排序"},{default:l(({row:t})=>[r(n(D),{"org-value":t.sortOrder,"onUpdate:orgValue":p=>t.sortOrder=p,params:{id:t.articleCategoryId,field:"sortOrder"},requestApi:n(O),label:"排序",type:"integer"},{default:l(()=>[s("div",null,b(t.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(I,{width:220,fixed:"right",label:"操作"},{default:l(({row:t})=>[r(n(V),{params:{act:"detail",id:t.articleCategoryId,parentId:t.parentId},data:{parentId:t.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:p=>N({},{parentId:t.parentId})},{default:l(()=>[...e[9]||(e[9]=[s("a",{class:"btn-link"},"编辑",-1)])]),_:1},8,["params","data","onOkCallback"]),r(P,{direction:"vertical"}),r(n(V),{params:{act:"add",parentId:t.articleCategoryId},data:{parentId:t.parentId||t.articleCategoryId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:p=>N({},{parentId:t.parentId})},{default:l(()=>[...e[10]||(e[10]=[s("a",{class:"btn-link"},"添加子分类",-1)])]),_:1},8,["params","data","onOkCallback"]),r(P,{direction:"vertical"}),t.parentId?(u(),q(n(B),{key:0,params:{id:t.articleCategoryId},requestApi:n(M),onAfterDelete:p=>N({},{parentId:t.parentId})},{default:l(()=>[...e[11]||(e[11]=[y("删除",-1)])]),_:1},8,["params","requestApi","onAfterDelete"])):_("",!0),t.parentId?_("",!0):(u(),q(n(B),{key:1,params:{id:t.articleCategoryId},requestApi:n(M),onAfterDelete:d},{default:l(()=>[...e[12]||(e[12]=[y("删除",-1)])]),_:1},8,["params","requestApi"]))]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),k.value>0?(u(),f("div",Ae,[r(n(pe),{page:i.page,"onUpdate:page":e[1]||(e[1]=t=>i.page=t),size:i.size,"onUpdate:size":e[2]||(e[2]=t=>i.size=t),total:k.value,onCallback:d},null,8,["page","size","total"])])):_("",!0)])])])])],64)}}}),Be=de(Ne,[["__scopeId","data-v-6f83dc6e"]]);export{Be as default};

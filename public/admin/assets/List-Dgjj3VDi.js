import{d as ie,x as re,r as V,c as de,f as d,g as c,h as p,i as l,l as m,z as t,m as n,j as e,a8 as F,Q as u,t as g,k as pe,F as ce,P as C}from"./index-B52YIGC0.js";/* empty css             */import"./index-KjhYqCTY.js";/* empty css                                                                    */import{P as R}from"./Pagination-C8J7-6Em.js";import{l as ue,m as me,n as _e,o as fe}from"./groupon-BtcEMuW-.js";import{u as be}from"./useListRequest-CprjeVXp.js";import{c as ge}from"./time-EzYK4E-P.js";import{_ as ve}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import{M as U}from"./index-C9ZdVeVx.js";const he={class:"container"},ye={class:"content_wrapper"},ke={class:"lyecs-table-list-warp"},Ce={class:"tabs-box"},we={key:0,class:"list-table-tool lyecs-search-warp"},Se={class:"advanced-search-warp list-table-tool-row"},xe={class:"simple-form-warp"},Ve={class:"simple-form-field"},je={class:"form-group"},ze={class:"control-container"},Te={class:"simple-form-field"},Ne={class:"form-group"},Pe={class:"control-container"},De={class:"simple-form-warp"},Ge={class:"simple-form-field"},Ie={class:"control-container"},Le={key:1,class:"list-table-tool lyecs-search-warp"},Fe={class:"advanced-search-warp list-table-tool-row"},Re={class:"simple-form-warp"},Ue={class:"simple-form-field"},Ke={class:"form-group"},Ee={class:"control-container"},Be={class:"simple-form-warp"},Oe={class:"simple-form-field"},He={class:"control-container"},Me={key:2,class:"list-table-tool-row"},Je={class:"list-table-tool-col"},$e={key:0},qe={key:3,class:"table-container"},Ae={key:1},Qe=["onClick"],We={class:"empty-warp"},Xe={key:0,class:"empty-bg"},Ye={key:0,class:"pagination-con"},Ze={key:4,class:"table-container"},eo={class:"display-col"},oo={class:"text"},to={class:"empty-warp"},ao={key:0,class:"empty-bg"},lo={key:0,class:"pagination-con"},vo=ie({__name:"List",props:{id:{}},emits:["close"],setup(K,{expose:E,emit:B}){const O=re(),f=V(1),H={1:me,2:ue},M=K,J=B,$=V([{label:"待成团",value:1},{label:"拼团成功",value:2},{label:"拼团失败",value:3}]),j=s=>{const o=$.value.find(k=>k.value===s);return o?o.label:"-"},q=V([{label:"待确定，待支付",value:0},{label:"已确定，待发货",value:1},{label:"处理中，已发货",value:2},{label:"已取消",value:3},{label:"无效",value:4},{label:"已完成",value:5}]),A=s=>{const o=q.value.find(k=>k.value===s);return o?o.label:"-"},Q=de(()=>H[f.value]),W=s=>s.joinStatus===1,{listData:z,loading:v,total:h,selectedIds:w,filterParams:r,loadData:y,onSearchSubmit:_,onSortChange:T,onSelectChange:N,resetParams:S}=be({apiFunction:Q,idKey:"grouponPromotionRecordId",defaultParams:{productName:"",keyword:"",page:1,size:O.get("pageSize"),grouponPromotionId:M.id,joinStatus:void 0}});y();const X=s=>{f.value=s,S(),y()},Y=s=>s.joinExpirationTime*1e3<Date.now(),Z=s=>s.joinExpirationTime*1e3-Date.now()>24*60*60*1e3?"DD[天] HH:mm:ss":"HH:mm:ss",ee=s=>{console.log(s),U.confirm({title:"确定将当前团的拼团状态更改为手动成团吗？",onOk:async()=>{try{await _e(s.grouponPromotionRecordId),C.success("操作成功"),y()}catch(o){C.error(o.message)}}})},oe=async()=>{if(w.value.length===0){C.warning("请至少选择一项");return}U.confirm({title:"确定将当前选中团的拼团状态更改为手动成团吗？",onOk:async()=>{try{await fe(w.value),C.success("操作成功"),y()}catch(s){C.error(s.message)}}})};return E({onFormSubmit:()=>{J("close")}}),(s,o)=>{const k=d("el-tab-pane"),te=d("el-tabs"),b=d("el-button"),P=d("TigInput"),x=d("el-option"),ae=d("el-select"),D=d("el-form"),G=d("el-space"),i=d("el-table-column"),le=d("el-countdown"),ne=d("el-divider"),I=d("el-table"),L=d("a-spin"),se=d("el-tooltip");return p(),c("div",he,[l("div",ye,[l("div",ke,[l("div",Ce,[t(te,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=a=>f.value=a),"tab-position":"top",onTabChange:X},{default:n(()=>[t(k,{name:1,label:"开团记录"}),t(k,{name:2,label:"订单记录"})]),_:1},8,["modelValue"])]),f.value===1?(p(),c("div",we,[t(D,{model:e(r),name:"form"},{default:n(()=>[l("div",Se,[l("div",xe,[l("div",Ve,[l("div",je,[l("div",ze,[t(P,{modelValue:e(r).productName,"onUpdate:modelValue":o[1]||(o[1]=a=>e(r).productName=a),name:"keyword",placeholder:"输入商品名称",onKeyup:F(e(_),["enter"]),clearable:"",onClear:e(_)},{append:n(()=>[t(b,{onClick:e(_)},{default:n(()=>[...o[8]||(o[8]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup","onClear"])])])]),l("div",Te,[l("div",Ne,[o[9]||(o[9]=l("label",{class:"control-label"},[l("span",null,"开团状态：")],-1)),l("div",Pe,[t(ae,{placeholder:"请选择活动状态",modelValue:e(r).joinStatus,"onUpdate:modelValue":o[2]||(o[2]=a=>e(r).joinStatus=a),clearable:"",onClear:e(_),onChange:e(_)},{default:n(()=>[t(x,{label:"待成团",value:1}),t(x,{label:"拼团成功",value:2}),t(x,{label:"拼团失败",value:3})]),_:1},8,["modelValue","onClear","onChange"])])])]),l("div",De,[l("div",Ge,[l("div",Ie,[t(b,{type:"primary",plain:"",onClick:e(_)},{default:n(()=>[...o[10]||(o[10]=[u("搜索",-1)])]),_:1},8,["onClick"]),t(b,{plain:"",onClick:e(S)},{default:n(()=>[...o[11]||(o[11]=[u("重置",-1)])]),_:1},8,["onClick"])])])])])])]),_:1},8,["model"])])):m("",!0),f.value===2?(p(),c("div",Le,[t(D,{model:e(r),name:"form"},{default:n(()=>[l("div",Fe,[l("div",Re,[l("div",Ue,[l("div",Ke,[l("div",Ee,[t(P,{modelValue:e(r).keyword,"onUpdate:modelValue":o[3]||(o[3]=a=>e(r).keyword=a),name:"keyword",width:"300px",placeholder:"请输入商品名称/客户名称/订单编号",onKeyup:F(e(_),["enter"]),clearable:"",onClear:e(_)},{append:n(()=>[t(b,{onClick:e(_)},{default:n(()=>[...o[12]||(o[12]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup","onClear"])])])]),l("div",Be,[l("div",Oe,[l("div",He,[t(b,{type:"primary",plain:"",onClick:e(_)},{default:n(()=>[...o[13]||(o[13]=[u("搜索",-1)])]),_:1},8,["onClick"]),t(b,{plain:"",onClick:e(S)},{default:n(()=>[...o[14]||(o[14]=[u("重置",-1)])]),_:1},8,["onClick"])])])])])])]),_:1},8,["model"])])):m("",!0),f.value===1?(p(),c("div",Me,[l("div",Je,[t(G,null,{default:n(()=>[t(b,{type:"primary",onClick:oe},{default:n(()=>[...o[15]||(o[15]=[u("批量成团",-1)])]),_:1}),e(w).length>0?(p(),c("span",$e,[o[16]||(o[16]=u(" 已选择：",-1)),l("b",null,g(e(w).length),1),o[17]||(o[17]=u(" 项 ",-1))])):m("",!0)]),_:1})])])):m("",!0),f.value===1?(p(),c("div",qe,[t(L,{spinning:e(v)},{default:n(()=>[t(I,{data:e(z),"row-key":"grouponPromotionRecordId",onSelectionChange:e(N),total:e(h),onSortChange:e(T),loading:e(v)},{empty:n(()=>[l("div",We,[e(v)?m("",!0):(p(),c("div",Xe,"暂无数据"))])]),default:n(()=>[t(i,{type:"selection",width:"32",selectable:W}),t(i,{label:"团ID",prop:"grouponPromotionRecordId","min-width":"60"}),t(i,{label:"开团时间",prop:"openGroupTime",width:"180"},{default:n(({row:a})=>[u(g(e(ge)(a.openGroupTime)),1)]),_:1}),t(i,{label:"商品名称",prop:"productName"}),t(i,{label:"拼团状态",align:"center"},{default:n(({row:a})=>[u(g(j(a.joinStatus)),1)]),_:1}),t(i,{label:"团长名称",prop:"groupCaptainName",width:"180"}),t(i,{label:"成团剩余时间",prop:"joinExpirationTime",align:"center"},{default:n(({row:a})=>[Y(a)?(p(),c("div",Ae,"-")):(p(),pe(le,{key:0,title:"",format:Z(a),value:a.joinExpirationTime*1e3,"value-style":{fontSize:"14px"}},null,8,["format","value"]))]),_:1}),t(i,{label:"所需团员数量",prop:"minGroupNum",align:"center"}),t(i,{width:210,label:"操作",fixed:"right"},{default:n(({row:a})=>[t(G,{size:0},{default:n(()=>[a.joinStatus===1?(p(),c(ce,{key:0},[l("a",{class:"btn-link",onClick:so=>ee(a)},"手动成团",8,Qe),t(ne,{direction:"vertical"})],64)):m("",!0),t(e(ve),{isDrawer:"",title:"查看团员",width:"800px","show-on-ok":!1,path:"promotion/groupon/record/groupMemberList/List",params:{act:"detail",id:a.grouponPromotionRecordId}},{default:n(()=>[...o[18]||(o[18]=[l("a",{class:"btn-link"},"查看团员",-1)])]),_:1},8,["params"])]),_:2},1024)]),_:1})]),_:1},8,["data","onSelectionChange","total","onSortChange","loading"])]),_:1},8,["spinning"]),e(h)>0?(p(),c("div",Ye,[t(e(R),{page:e(r).page,"onUpdate:page":o[4]||(o[4]=a=>e(r).page=a),size:e(r).size,"onUpdate:size":o[5]||(o[5]=a=>e(r).size=a),total:e(h),onCallback:e(y)},null,8,["page","size","total","onCallback"])])):m("",!0)])):m("",!0),f.value===2?(p(),c("div",Ze,[t(L,{spinning:e(v)},{default:n(()=>[t(I,{data:e(z),onSelectionChange:e(N),total:e(h),onSortChange:e(T),loading:e(v)},{empty:n(()=>[l("div",to,[e(v)?m("",!0):(p(),c("div",ao,"暂无数据"))])]),default:n(()=>[t(i,{label:"用户名称",prop:"username"},{default:n(({row:a})=>[l("div",eo,[t(se,{class:"box-item",effect:"light",content:a.username,placement:"bottom"},{default:n(()=>[l("div",oo,g(a.username),1)]),_:2},1032,["content"])])]),_:1}),t(i,{label:"身份",prop:"startTimeStr",align:"center"},{default:n(({row:a})=>[u(g(a.joinType===1?"团长":"团员"),1)]),_:1}),t(i,{label:"团长名称",prop:"groupCaptainName"}),t(i,{label:"商品名称",prop:"productName"}),t(i,{label:"订单编号",prop:"orderSn",width:"180"}),t(i,{label:"拼团时间",prop:"addTime",width:"160"}),t(i,{label:"拼团状态",prop:"joinStatus",align:"center"},{default:n(({row:a})=>[u(g(j(a.joinStatus)),1)]),_:1}),t(i,{label:"订单状态",prop:"orderStatus"},{default:n(({row:a})=>[u(g(A(a.orderStatus)),1)]),_:1})]),_:1},8,["data","onSelectionChange","total","onSortChange","loading"])]),_:1},8,["spinning"]),e(h)>0?(p(),c("div",lo,[t(e(R),{page:e(r).page,"onUpdate:page":o[6]||(o[6]=a=>e(r).page=a),size:e(r).size,"onUpdate:size":o[7]||(o[7]=a=>e(r).size=a),total:e(h),onCallback:e(y)},null,8,["page","size","total","onCallback"])])):m("",!0)])):m("",!0)])])])}}});export{vo as default};

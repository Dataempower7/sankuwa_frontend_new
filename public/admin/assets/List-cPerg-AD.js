import{d as K,x as $,r as m,b as j,as as E,f as p,g as y,h as I,i as t,z as e,m as s,a8 as Q,j as c,Q as d,l as w,t as x,P as N,_ as H}from"./index-B52YIGC0.js";import{h as J,b as M,i as W}from"./groupon-BtcEMuW-.js";import{D as X}from"./DeleteRecord-BTXBpwL2.js";/* empty css                                                                    */import{P as Y}from"./Pagination-C8J7-6Em.js";import"./index-KjhYqCTY.js";import{S as Z}from"./SelectBrand-tHlymKqU.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";/* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     *//* empty css             */import{_ as z}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";import"./brand-CyfpB5Ly.js";import"./time-EzYK4E-P.js";const oo={class:"container"},to={class:"content_wrapper"},eo={class:"lyecs-table-list-warp"},so={class:"list-table-tool lyecs-search-warp"},no={class:"advanced-search-warp list-table-tool-row"},ao={class:"simple-form-warp"},lo={class:"simple-form-field"},ro={class:"form-group"},io={class:"control-container"},po={class:"simple-form-field"},uo={class:"form-group"},mo={class:"control-container"},co={class:"simple-form-warp"},go={class:"simple-form-field"},_o={class:"control-container"},fo={class:"list-table-tool-row"},vo={class:"list-table-tool-col"},bo={key:0,class:"selected-count"},yo={class:"table-container"},Io={style:{position:"relative"}},wo={class:"empty-warp"},ko={key:0,class:"empty-bg"},ho={key:0,class:"pagination-con"},Po=K({__name:"List",props:{grouponPromotionId:{type:Number,default:0},groupType:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["close"],setup(k,{expose:D,emit:T}){const B=$(),h=m([]),b=m(0),g=m(!0),u=m([]),_=k,V=T,P=j().currentRoute.value.query;m(_.isDialog?_.act:String(P.act));const C=m(_.isDialog?_.groupType:Number(P.groupType)),n=E({sortField:"",sortOrder:"",keyword:"",page:1,grouponPromotionId:_.grouponPromotionId,size:B.get("pageSize")}),r=async()=>{g.value=!0;try{const l=await M({...n});h.value=l.records,b.value=l.total}catch(l){N.error(l.message)}finally{g.value=!1}};r();const F=async l=>{if(u.value.length===0){N.warning("请至少选择一项");return}await W({ids:u.value,type:l}),r()},G=l=>{u.value=l.map(o=>o.grouponPromotionItemId)},f=()=>{r()},q=()=>{n.keyword="",n.page=1,n.sortField="",n.sortOrder="",n.brandId=void 0,n.productGroupId=void 0,r()};return D({onFormSubmit:()=>{V("close")}}),(l,o)=>{const v=p("el-button"),L=p("TigInput"),O=p("el-popconfirm"),S=p("el-space"),i=p("el-table-column"),U=p("el-divider"),A=p("el-table"),R=p("a-spin");return I(),y("div",oo,[t("div",to,[t("div",eo,[t("div",so,[t("div",no,[t("div",ao,[t("div",lo,[t("div",ro,[o[6]||(o[6]=t("label",{class:"control-label"},[t("span",null,"商品名称：")],-1)),t("div",io,[e(L,{modelValue:n.keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>n.keyword=a),name:"keyword",placeholder:"请输入商品名称",onKeyup:Q(f,["enter"]),clearable:"",onClear:f},{append:s(()=>[e(v,{onClick:f},{default:s(()=>[...o[5]||(o[5]=[t("span",{class:"iconfont icon-chakan1"},null,-1)])]),_:1})]),_:1},8,["modelValue"])])])]),t("div",po,[t("div",uo,[o[7]||(o[7]=t("label",{class:"control-label"},[t("span",null,"商品品牌：")],-1)),t("div",mo,[e(c(Z),{brandId:n.brandId,"onUpdate:brandId":o[1]||(o[1]=a=>n.brandId=a),onOnChange:f},null,8,["brandId"])])])]),t("div",co,[t("div",go,[o[10]||(o[10]=t("label",{class:"control-label"},null,-1)),t("div",_o,[e(v,{type:"primary",plain:"",onClick:f},{default:s(()=>[...o[8]||(o[8]=[d("搜索",-1)])]),_:1}),e(v,{plain:"",onClick:q},{default:s(()=>[...o[9]||(o[9]=[d("重置",-1)])]),_:1})])])])])])]),t("div",fo,[t("div",vo,[e(S,{class:"action-bar"},{default:s(()=>[e(c(z),{isDrawer:"",onCloseCallback:r,title:"添加商品",width:"900px",path:"promotion/groupon/item/Info","show-on-ok":!1,params:{act:"add",grouponPromotionId:k.grouponPromotionId,groupType:C.value}},{default:s(()=>[e(v,{type:"primary"},{default:s(()=>[...o[11]||(o[11]=[d("添加商品",-1)])]),_:1})]),_:1},8,["params"]),e(O,{title:"您确认要批量删除所选数据吗？",onConfirm:o[2]||(o[2]=a=>F("del"))},{reference:s(()=>[e(v,{disabled:u.value.length===0},{default:s(()=>[...o[12]||(o[12]=[d("批量移除",-1)])]),_:1},8,["disabled"])]),_:1}),u.value.length>0?(I(),y("span",bo,[o[13]||(o[13]=d(" 已选择：",-1)),t("b",null,x(u.value.length),1),o[14]||(o[14]=d(" 项 ",-1))])):w("",!0)]),_:1})])]),t("div",yo,[e(R,{spinning:g.value},{default:s(()=>[e(A,{data:h.value,"row-key":"grouponPromotionItemId",onSelectionChange:G,total:b.value,loading:g.value},{empty:s(()=>[t("div",wo,[g.value?w("",!0):(I(),y("div",ko,"暂无数据"))])]),default:s(()=>[e(i,{type:"selection",width:"32"}),e(i,{label:"商品信息",prop:"productName",width:150},{default:s(({row:a})=>[t("div",Io,[t("div",null,x(a.productName||"--"),1)])]),_:1}),e(i,{label:"销售价",prop:"productPrice",align:"center"}),e(i,{label:"拼团价",prop:"minGroupPrice",align:"center"}),e(i,{label:"团规模",prop:"minGroupNum",align:"center"}),e(i,{label:"可售数量",prop:"maxLimitNum",align:"center"}),e(i,{label:"活动排序",prop:"sort",align:"center"}),e(i,{width:168,label:"操作",fixed:"right"},{default:s(({row:a})=>[e(S,{size:0},{default:s(()=>[e(c(z),{isDrawer:"",onOkCallback:r,title:"编辑",width:"900px",path:"promotion/groupon/item/setup/Info",params:{act:"detail",product:{...a,productSkus:[]},groupType:C.value,id:a.grouponPromotionItemId,grouponPromotionId:a.grouponPromotionId}},{default:s(()=>[...o[15]||(o[15]=[t("a",{class:"btn-link"},"编辑",-1)])]),_:1},8,["params"]),e(U,{direction:"vertical"}),e(c(X),{onAfterDelete:r,requestApi:c(J),params:{id:a.grouponPromotionItemId}},{default:s(()=>[...o[16]||(o[16]=[d("移除",-1)])]),_:1},8,["requestApi","params"])]),_:2},1024)]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),b.value>0?(I(),y("div",ho,[e(c(Y),{page:n.page,"onUpdate:page":o[3]||(o[3]=a=>n.page=a),size:n.size,"onUpdate:size":o[4]||(o[4]=a=>n.size=a),total:b.value,onCallback:r},null,8,["page","size","total"])])):w("",!0)])])])])}}}),Ko=H(Po,[["__scopeId","data-v-fe430d99"]]);export{Ko as default};

import{f as K}from"./product-hE35r0Q_.js";import{_ as M}from"./PriceInput.vue_vue_type_script_setup_true_lang-DpJJvzpB.js";import"./index-KjhYqCTY.js";import{g as W}from"./pickupSetting-CaGqQdmm.js";import{d as X,aq as Z,b as ee,r as C,ar as le,Y as te,f as r,g as o,h as d,k as T,l as g,m as i,z as t,Q as m,i as a,F as w,p as L,j as u,E as D,ac as V,t as x,P as j,s as ie,_ as ae}from"./index-B52YIGC0.js";import{_}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";import"./index-C9ZdVeVx.js";const z="/admin/assets/fixedShippingFee-Czd274cf.png",se={class:"flex"},de={class:"flex flex-justify-between"},oe={key:0,class:"con-btn"},ne={class:"fixed-shipping-type"},pe={class:"flex flex-align-center"},ue={class:"extra",style:{"margin-top":"5px","margin-left":"20px"}},re={class:"flex"},me={class:"flex flex-justify-between"},fe={key:0,class:"con-btn"},ve={key:0},ge={class:"fixed-shipping-type"},ye={class:"flex flex-align-center"},be={class:"extra",style:{"margin-top":"5px","margin-left":"20px"}},xe={class:"flex"},ce={class:"flex flex-justify-between"},he={key:0,class:"con-btn"},ke={style:{width:"100%"}},Te={key:0,class:"wechat-config"},_e={class:"table-container"},Se={class:"table-td"},we={class:"info"},Ve={class:"btn"},Ie={class:"table-td"},Ce={class:"flex table-info"},Le={key:0,class:"info"},De={key:0,class:"info-conetnt"},Ue={class:"val"},Ne={key:1},Fe={key:2},Pe={key:1,class:"info"},Ee={class:"btn"},Je={class:"table-td"},Oe={class:"info"},qe={class:"btn"},Be={key:0,style:{width:"100%"},class:"mt10"},Me={key:0,class:"wechat-config"},je={class:"flex flex-align-center"},ze={class:"mr10"},Re=X({__name:"LogisticsInfo",props:Z({id:{type:Number,default:0},shopId:{type:Number,default:0},examine:{type:Number,default:0},loading:{type:Boolean,default:!1},act:{type:String,default:""}},{formState:{default:{}},formStateModifiers:{}}),emits:["update:formState"],setup(n){const R=ee(),$=C([]),E=C(0),J=n,l=le(n,"formState"),O=(v,e,p)=>{if(!e||Number(e)!==0){if(l.value.fixedShippingType==1){if(e!==0&&!e){p(new Error("运费不能为空"));return}if(Number(e)>999999){p(new Error("运费不能超过999999"));return}p();return}p()}else p()},A=(v,e,p)=>{if(l.value.isShopPickup==0&&l.value.isLogistics==0&&l.value.isShopDelivery==0){p(new Error("请选择快递配送方式"));return}p()},S=C(!1),c=async(v=!0)=>{S.value=!0;try{const e=await K({shopId:J.shopId});l.value.shippingTplList=e.shippingTplList}catch(e){j.error(e.message)}finally{setTimeout(()=>{S.value=!1},200)}},f=C({pickupTimeJson:{type:1,timeList:[{startTime:"",endTime:""}],timeType:1},pickupEndJson:{type:1,day:void 0,hour:void 0}}),U=async()=>{try{const v=await W({shopId:J.shopId});f.value=v,ie(()=>{f.value.status===0&&(l.value.isShopPickup=0)})}catch(v){j.error(v.message)}finally{}},Q=v=>{let e="";switch(v){case"m":e="分钟";break;case"h":e="小时";break;case"d":e="天";break}return e},Y=()=>{R.push("/setting/intra-city-delivery")};return te(()=>l.value,v=>{v.productType==1&&D()},{immediate:!0}),(v,e)=>{const p=r("el-radio"),h=r("el-radio-group"),N=r("el-option"),F=r("el-select"),y=r("el-button"),b=r("el-form-item"),q=r("el-popover"),P=r("el-checkbox"),k=r("el-col"),B=r("el-row"),I=r("el-table-column"),G=r("el-empty"),H=r("el-table");return d(),o(w,null,[l.value.productType!=1&&l.value.productType!=5&&l.value.productType!=6?(d(),T(b,{key:0,rules:[{required:!0,message:"请选择配送方式!"}],label:"配送方式",prop:"noShipping"},{default:i(()=>[t(h,{modelValue:l.value.noShipping,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.noShipping=s),disabled:n.examine==1,style:{width:"100%","margin-bottom":"10px"}},{default:i(()=>[t(p,{value:1},{default:i(()=>[...e[14]||(e[14]=[m("无需配送",-1)])]),_:1})]),_:1},8,["modelValue","disabled"]),t(h,{modelValue:l.value.noShipping,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.noShipping=s),disabled:n.examine==1||l.value.productType!=1,style:{width:"100%"}},{default:i(()=>[t(p,{value:0},{default:i(()=>[a("div",se,[e[18]||(e[18]=a("div",{class:"mr10"},"运费模板",-1)),t(b,{label:"",prop:"shippingTplId"},{default:i(()=>[a("div",de,[t(F,{modelValue:l.value.shippingTplId,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.shippingTplId=s),disabled:n.examine==1||l.value.productType!=1||l.value.noShipping==1,placeholder:"请选择",style:{width:"100%"}},{default:i(()=>[(d(!0),o(w,null,L(l.value.shippingTplList,s=>(d(),T(N,{key:s.shippingTplId,label:s.shippingTplName,value:s.shippingTplId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),n.examine!=1?(d(),o("div",oe,[t(u(_),{params:{act:"add"},isDrawer:"",path:"setting/shippingTpl/Info",title:"添加运费模板",width:"900px",onOkCallback:c},{default:i(()=>[t(y,{link:"",type:"primary"},{default:i(()=>[...e[15]||(e[15]=[m("新建",-1)])]),_:1})]),_:1}),e[17]||(e[17]=a("p",{class:"ml10 mr10",style:{"margin-bottom":"3px"}},"|",-1)),t(y,{loading:S.value,link:"",type:"primary",onClick:c},{default:i(()=>[...e[16]||(e[16]=[m("刷新 ",-1)])]),_:1},8,["loading"])])):g("",!0)])]),_:1})])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})):g("",!0),l.value.productType==1&&!u(D)()?(d(),T(b,{key:1,rules:[{required:!0}],label:"快递运费",prop:"fixedShippingType"},{default:i(()=>[t(h,{modelValue:l.value.fixedShippingType,"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.fixedShippingType=s),disabled:n.examine==1,style:{width:"100%","margin-bottom":"25px"}},{default:i(()=>[a("div",null,[t(p,{value:1},{default:i(()=>[a("div",ne,[a("div",pe,[e[19]||(e[19]=a("div",{class:"mr10"},"固定运费",-1)),t(b,{rules:[{required:!0,validator:O}],class:"inner-item",label:"",prop:"fixedShippingFee"},{default:i(()=>[t(M,{modelValue:l.value.fixedShippingFee,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.fixedShippingFee=s),disabled:n.examine==1||l.value.fixedShippingType==2,placeholder:"请输入运费",width:"200px"},null,8,["modelValue","disabled"])]),_:1},8,["rules"])])])]),_:1}),a("div",ue,[e[22]||(e[22]=m(" 设置固定运费为0时，前台展示为包邮。 ",-1)),t(q,{width:400,placement:"right-end",trigger:"click"},{reference:i(()=>[...e[20]||(e[20]=[a("a",null,"查看示例",-1)])]),default:i(()=>[...e[21]||(e[21]=[a("img",{src:z,style:{width:"380px"}},null,-1)])]),_:1})])])]),_:1},8,["modelValue","disabled"]),t(h,{modelValue:l.value.fixedShippingType,"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.fixedShippingType=s),disabled:n.examine==1||l.value.productType!=1,style:{width:"100%"}},{default:i(()=>[t(p,{value:2},{default:i(()=>[a("div",re,[e[26]||(e[26]=a("div",{class:"mr10"},"运费模板",-1)),t(b,{label:"",prop:"shippingTplId"},{default:i(()=>[a("div",me,[t(F,{modelValue:l.value.shippingTplId,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.shippingTplId=s),disabled:n.examine==1||l.value.productType!=1||l.value.fixedShippingType==1,placeholder:"请选择",style:{width:"100%"}},{default:i(()=>[(d(!0),o(w,null,L(l.value.shippingTplList,s=>(d(),T(N,{key:s.shippingTplId,label:s.shippingTplName,value:s.shippingTplId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),n.examine!=1?(d(),o("div",fe,[t(u(_),{params:{act:"add"},isDrawer:"",path:"setting/shippingTpl/Info",title:"添加运费模板",width:"900px",onOkCallback:c},{default:i(()=>[t(y,{link:"",type:"primary"},{default:i(()=>[...e[23]||(e[23]=[m("新建",-1)])]),_:1})]),_:1}),e[25]||(e[25]=a("p",{class:"ml10 mr10",style:{"margin-bottom":"3px"}},"|",-1)),t(y,{loading:S.value,link:"",type:"primary",onClick:c},{default:i(()=>[...e[24]||(e[24]=[m("刷新 ",-1)])]),_:1},8,["loading"])])):g("",!0)])]),_:1})])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})):g("",!0),l.value.productType==1&&u(D)()?(d(),T(b,{key:2,rules:[{required:!0,validator:A}],label:"配送方式",prop:"isLogistics"},{default:i(()=>[a("div",null,[t(P,{modelValue:l.value.isLogistics,"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.isLogistics=s),label:"快递发货","true-label":1,"false-label":0},null,8,["modelValue"]),l.value.isLogistics==1?(d(),o("div",ve,[t(h,{modelValue:l.value.fixedShippingType,"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.fixedShippingType=s),disabled:n.examine==1&&u(V)()!==2,style:{width:"100%","margin-bottom":"25px"}},{default:i(()=>[a("div",null,[t(p,{value:1},{default:i(()=>[a("div",ge,[a("div",ye,[e[27]||(e[27]=a("div",{class:"mr10"},"固定运费",-1)),t(b,{rules:[{required:!0,validator:O}],class:"inner-item",label:"",prop:"fixedShippingFee"},{default:i(()=>[t(M,{modelValue:l.value.fixedShippingFee,"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.fixedShippingFee=s),disabled:n.examine==1&&u(V)()!==2||l.value.fixedShippingType==2,placeholder:"请输入运费",width:"200px"},null,8,["modelValue","disabled"])]),_:1},8,["rules"])])])]),_:1}),a("div",be,[e[30]||(e[30]=m(" 设置固定运费为0时，前台展示为包邮。 ",-1)),t(q,{width:400,placement:"right-end",trigger:"click"},{reference:i(()=>[...e[28]||(e[28]=[a("a",null,"查看示例",-1)])]),default:i(()=>[...e[29]||(e[29]=[a("img",{src:z,style:{width:"380px"}},null,-1)])]),_:1})])])]),_:1},8,["modelValue","disabled"]),t(h,{modelValue:l.value.fixedShippingType,"onUpdate:modelValue":e[11]||(e[11]=s=>l.value.fixedShippingType=s),disabled:n.examine==1&&u(V)()!==2||l.value.productType!=1,style:{width:"100%"}},{default:i(()=>[t(p,{value:2},{default:i(()=>[a("div",xe,[e[34]||(e[34]=a("div",{class:"mr10"},"运费模板",-1)),t(b,{label:"",prop:"shippingTplId"},{default:i(()=>[a("div",ce,[t(F,{modelValue:l.value.shippingTplId,"onUpdate:modelValue":e[10]||(e[10]=s=>l.value.shippingTplId=s),disabled:n.examine==1&&u(V)()!==2||l.value.productType!=1||l.value.fixedShippingType==1,placeholder:"请选择",style:{width:"100%"}},{default:i(()=>[(d(!0),o(w,null,L(l.value.shippingTplList,s=>(d(),T(N,{key:s.shippingTplId,label:s.shippingTplName,value:s.shippingTplId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),n.examine!=1||u(V)()===2?(d(),o("div",he,[t(u(_),{params:{act:"add"},isDrawer:"",path:"setting/shippingTpl/Info",title:"添加运费模板",width:"900px",onOkCallback:c},{default:i(()=>[t(y,{link:"",type:"primary"},{default:i(()=>[...e[31]||(e[31]=[m("新建",-1)])]),_:1})]),_:1}),e[33]||(e[33]=a("p",{class:"ml10 mr10",style:{"margin-bottom":"3px"}},"|",-1)),t(y,{loading:S.value,link:"",type:"primary",onClick:c},{default:i(()=>[...e[32]||(e[32]=[m("刷新 ",-1)])]),_:1},8,["loading"])])):g("",!0)])]),_:1})])]),_:1})]),_:1},8,["modelValue","disabled"])])):g("",!0)]),a("div",ke,[t(P,{modelValue:l.value.isShopPickup,"onUpdate:modelValue":e[12]||(e[12]=s=>l.value.isShopPickup=s),label:"到店自提","true-label":1,"false-label":0,disabled:f.value.status===0},null,8,["modelValue","disabled"]),l.value.isShopPickup==1?(d(),o("div",Te,[a("div",_e,[t(B,null,{default:i(()=>[t(k,{span:7},{default:i(()=>[...e[35]||(e[35]=[a("div",{class:"table-tr"},"系统自动完成备货",-1)])]),_:1}),t(k,{span:10},{default:i(()=>[...e[36]||(e[36]=[a("div",{class:"table-tr"},"可自提时间",-1)])]),_:1}),t(k,{span:7},{default:i(()=>[...e[37]||(e[37]=[a("div",{class:"table-tr"},"提货有效期",-1)])]),_:1})]),_:1}),t(B,null,{default:i(()=>[t(k,{span:7},{default:i(()=>[a("div",Se,[a("div",we,x(f.value.stockingStatus?"已开启":"已关闭"),1),a("div",Ve,[t(u(_),{maskClose:!1,isDrawer:"",params:{act:"deawer"},path:"setting/pickupSetting/Index",title:"自提设置",width:"1010px",onOkCallback:U},{default:i(()=>[t(y,{type:"primary",link:""},{default:i(()=>[...e[38]||(e[38]=[m(" 去设置 ",-1)])]),_:1})]),_:1})])])]),_:1}),t(k,{span:10},{default:i(()=>[a("div",Ie,[a("div",Ce,[f.value.pickupTimeStatus==1?(d(),o("div",Le,[f.value.pickupTimeJson.timeList&&f.value.pickupTimeJson.timeList.length>0?(d(),o("div",De,[e[39]||(e[39]=a("div",{class:"label"},"可自提时段：",-1)),a("div",Ue,[(d(!0),o(w,null,L(f.value.pickupTimeJson.timeList,s=>(d(),o("div",null,x(s.startTime)+"-"+x(s.endTime),1))),256))])])):g("",!0),f.value.stockingStatus==0?(d(),o("p",Ne," 预约自提：需提前"+x(f.value.pickupTimeJson.appointmentTime.timeNum)+x(Q(f.value.pickupTimeJson.appointmentTime.timeUnit))+"预约自提 ",1)):(d(),o("p",Fe,"已开启自动完成备货"))])):(d(),o("div",Pe,"已关闭")),a("div",Ee,[t(u(_),{maskClose:!1,isDrawer:"",params:{act:"deawer"},path:"setting/pickupSetting/Index",title:"自提设置",width:"1010px",onOkCallback:U},{default:i(()=>[t(y,{type:"primary",link:""},{default:i(()=>[...e[40]||(e[40]=[m(" 去设置 ",-1)])]),_:1})]),_:1})])])])]),_:1}),t(k,{span:7},{default:i(()=>[a("div",Je,[a("div",Oe,x(f.value.pickupEndStatus?"已开启":"已关闭"),1),a("div",qe,[t(u(_),{maskClose:!1,isDrawer:"",params:{act:"deawer"},path:"setting/pickupSetting/Index",title:"自提设置",width:"1010px",onOkCallback:U},{default:i(()=>[t(y,{type:"primary",link:""},{default:i(()=>[...e[41]||(e[41]=[m(" 去设置 ",-1)])]),_:1})]),_:1})])])]),_:1})]),_:1})])])):g("",!0)]),l.value.productType==1&&u(D)()?(d(),o("div",Be,[t(P,{modelValue:l.value.isShopDelivery,"onUpdate:modelValue":e[13]||(e[13]=s=>l.value.isShopDelivery=s),label:"同城配送","true-label":1,"false-label":0,disabled:n.act=="add"&&!E.value},null,8,["modelValue","disabled"]),l.value.isShopDelivery?(d(),o("div",Me,[t(H,{data:$.value,border:"",style:{"--el-table-border":"1px solid #ddd","font-weight":"normal","font-size":"14px"},"header-row-class-name":"custom-header-row"},{empty:i(()=>[t(G,{description:"暂无相关配置","image-size":"80"})]),default:i(()=>[t(I,{prop:"deliveryRadius",label:"配送区域(m)"}),t(I,{prop:"minOrderAmount",label:"起送价(元)"}),t(I,{prop:"baseDeliveryFee",label:"基础运费(元)"}),t(I,{label:"叠加溢价"},{default:i(({row:s})=>[a("div",je,[a("div",ze,x(E.value?"已开启":"已关闭"),1),t(y,{type:"primary",link:"",onClick:Y,class:"setting-btn"},{default:i(()=>[...e[42]||(e[42]=[m("去设置",-1)])]),_:1})])]),_:1})]),_:1},8,["data"])])):g("",!0)])):g("",!0)]),_:1},8,["rules"])):g("",!0)],64)}}}),We=ae(Re,[["__scopeId","data-v-152c5079"]]);export{We as default};

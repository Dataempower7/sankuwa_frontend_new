import{d as S,b as x,r as f,ab as N,f as d,g as I,h as R,i as s,z as r,m as i,Q as T,t as h,P as m}from"./index-B52YIGC0.js";import{a as q,d as A}from"./accountManage-AaZJSGj-.js";const B={class:"container"},M={class:"content_wrapper"},P={class:"lyecs-form-table"},F=S({__name:"Password",props:{id:{type:Number,default:0},adminId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(_,{expose:v,emit:w}){const l=w,n=_,y=x().currentRoute.value.query,g=f(n.isDialog?n.id:Number(y.id)),p=N(),e=f({});(async()=>{try{const t=await q({id:g.value,adminId:n.adminId,type:n.type});e.value=t}catch(t){m.error(t.message),l("close")}})();const b=(t,o,a)=>{if(o)if(o!==e.value.password){a(new Error("两次密码输入不一致"));return}else a();else{a(new Error("请输入确认密码"));return}},C=async()=>{await p.value.validate();try{l("update:confirmLoading",!0);const t=await A(e.value);l("submitCallback",t),m.success("操作成功")}catch(t){m.error(t.message)}finally{l("update:confirmLoading",!1)}};return v({onFormSubmit:()=>{C()}}),(t,o)=>{const a=d("el-form-item"),c=d("TigInput"),V=d("el-form");return R(),I("div",B,[s("div",M,[s("div",P,[r(V,{ref_key:"formRef",ref:p,model:e.value,"label-width":"auto"},{default:i(()=>[r(a,{label:"账号名称"},{default:i(()=>[T(h(e.value.username),1)]),_:1}),r(a,{label:"修改密码",prop:"password",rules:[{required:!0,message:"请输入密码"}]},{default:i(()=>[r(c,{classType:"tig-form-input",modelValue:e.value.password,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value.password=u),type:"password"},null,8,["modelValue"])]),_:1}),r(a,{label:"确认密码",prop:"pwdConfirm",rules:[{required:!0,validator:b}]},{default:i(()=>[s("div",null,[s("div",null,[r(c,{classType:"tig-form-input",modelValue:e.value.pwdConfirm,"onUpdate:modelValue":o[1]||(o[1]=u=>e.value.pwdConfirm=u),type:"password"},null,8,["modelValue"])]),o[2]||(o[2]=s("div",{class:"extra"},"注意：修改密码会影响到此账号登录后台的所有角色账号（比如管理员、店铺、门店、供应商等）",-1))])]),_:1},8,["rules"])]),_:1},8,["model"])])])])}}});export{F as default};

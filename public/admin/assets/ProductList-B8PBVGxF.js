import{d as Z,x as tt,r as I,f as c,g as m,h as n,i as e,Q as r,z as l,j as o,m as a,l as u,a8 as et,k as g,t as y,P as k,_ as ot}from"./index-B52YIGC0.js";/* empty css             */import{R as st}from"./RadioType-_K8vK_oe.js";import"./index-KjhYqCTY.js";import{D as x}from"./DeleteRecord-BTXBpwL2.js";/* empty css                                                                    */import{P as lt}from"./Pagination-C8J7-6Em.js";import{i as at}from"./format-BxqOrW-w.js";import{d as nt,v as it}from"./product-CL06FDSJ.js";import{S as dt}from"./SelectBrand-tHlymKqU.js";import{_ as rt}from"./SelectCategory.vue_vue_type_script_setup_true_lang-Bb2xH4oQ.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-1fz1RqDZ.js";import{u as O,b as U,l as pt}from"./product-hE35r0Q_.js";/* empty css                                                                  *//* empty css                                                                              *//* empty css                                                                     */import{_ as ct}from"./SelectVendor.vue_vue_type_script_setup_true_lang-BoLpkKlM.js";import{u as ut}from"./useListRequest-CprjeVXp.js";import{_ as z}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";/* empty css                                                                  */import"./index-C9ZdVeVx.js";import"./brand-CyfpB5Ly.js";import"./category-BhaHXalE.js";import"./category-D6KF81Ae.js";import"./time-EzYK4E-P.js";import"./suppliers-C_UEn0j3.js";const mt={class:"container"},_t={class:"content_wrapper"},ft={class:"mb20"},vt={class:"lyecs-table-list-warp"},bt={class:"list-table-tool lyecs-search-warp"},gt={class:"advanced-search-warp list-table-tool-row"},yt={class:"simple-form-warp"},kt={class:"simple-form-field"},Ct={class:"form-group"},It={class:"control-container"},ht={key:0,class:"simple-form-field"},St={class:"form-group"},wt={class:"control-container"},Pt={class:"simple-form-field"},xt={class:"form-group"},Vt={class:"control-container"},Bt={class:"simple-form-field"},At={class:"form-group"},Dt={class:"control-container"},Nt={class:"simple-form-field"},Ot={class:"form-group"},Ut={class:"control-container"},zt={class:"simple-form-warp"},Tt={class:"simple-form-field"},qt={class:"control-container"},Ft={key:0,class:"list-table-tool-row"},Kt={class:"list-table-tool-col"},Rt={key:1},$t={class:"list-table-tool-row"},Lt={class:"list-table-tool-col"},Et={key:0},jt={class:"table-container"},Qt={class:"flex"},Gt={key:0,class:"span-pic"},Ht=["src"],Jt={class:"span-product-con"},Mt={class:"span-product-name",style:{"word-break":"break-all"}},Wt={key:0,class:"green"},Xt={key:1,class:"red"},Yt={class:"empty-warp"},Zt={key:0,class:"empty-bg"},te={key:0,class:"pagination-con"},ee=Z({__name:"ProductList",emits:["callback"],setup(oe,{emit:T}){const q=tt(),h=T;I(0);const V=I(localStorage.getItem("adminType")),F=I(1),B=I(1),K=[{key:1,title:"普通商品",desc:"物流配送"}],{listData:A,loading:D,total:S,selectedIds:p,filterParams:i,loadData:C,onSearchSubmit:f,onSortChange:R,onSelectChange:$,onBatchAction:L,resetParams:E}=ut({apiFunction:nt,idKey:"id",defaultParams:{page:1,size:q.get("pageSize"),sortField:"",sortOrder:"",keyword:"",vendorId:"",productCategoryId:"",productBrandId:"",isCanImport:""}});C();const j=async b=>{await L(b,U),h("callback")},Q=async b=>{let t=[];if(A.value.forEach(d=>{p.value.includes(d.id)&&d.productId&&d.productId>0&&d.productStatus==0&&t.push(d.productId)}),t.length===0){k.error("当前选中商品没有符合条件的商品");return}try{await U(b,{ids:t}),k.success("操作成功"),C(),p.value=[],h("callback")}catch(d){k.error(d.message||"操作失败")}},v=()=>{C(),h("callback")},G=async()=>{try{await pt({vendorProductIds:[...p.value]}),k.success("操作成功"),p.value=[],v()}catch(b){k.error(b.message||"操作失败")}};return(b,t)=>{const d=c("el-button"),H=c("TigInput"),N=c("el-option"),J=c("el-select"),w=c("el-popconfirm"),P=c("el-space"),M=c("el-form"),_=c("el-table-column"),W=c("el-divider"),X=c("el-table"),Y=c("a-spin");return n(),m("div",mt,[e("div",_t,[e("div",ft,[t[10]||(t[10]=e("div",{class:"title"},[e("p",{class:"xian"}),r(" 商品来源 ")],-1)),e("div",null,[l(o(st),{modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=s=>B.value=s),radioList:K},null,8,["modelValue"])])]),e("div",vt,[e("div",bt,[l(M,{model:o(i),name:"form"},{default:a(()=>[e("div",gt,[e("div",yt,[e("div",kt,[e("div",Ct,[t[12]||(t[12]=e("label",{class:"control-label"},[e("span",null,"商品名称：")],-1)),e("div",It,[l(H,{modelValue:o(i).keyword,"onUpdate:modelValue":t[1]||(t[1]=s=>o(i).keyword=s),name:"keyword",placeholder:"输入商品名称/货号",onKeyup:et(o(f),["enter"]),clearable:"",onClear:o(f)},{append:a(()=>[l(d,{onClick:o(f)},{default:a(()=>[...t[11]||(t[11]=[e("span",{class:"iconfont icon-chakan1"},null,-1)])]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup","onClear"])])])]),V.value=="admin"?(n(),m("div",ht,[e("div",St,[t[13]||(t[13]=e("label",{class:"control-label"},[e("span",null,"供应商：")],-1)),e("div",wt,[l(o(ct),{vendorId:o(i).vendorId,"onUpdate:vendorId":t[2]||(t[2]=s=>o(i).vendorId=s),onOnChange:o(f)},null,8,["vendorId","onOnChange"])])])])):u("",!0),e("div",Pt,[e("div",xt,[t[14]||(t[14]=e("label",{class:"control-label"},[e("span",null,"分类：")],-1)),e("div",Vt,[l(o(rt),{ref:"selectCategoryRef",categoryId:o(i).productCategoryId,"onUpdate:categoryId":t[3]||(t[3]=s=>o(i).productCategoryId=s)},null,8,["categoryId"])])])]),e("div",Bt,[e("div",At,[t[15]||(t[15]=e("label",{class:"control-label"},[e("span",null,"品牌：")],-1)),e("div",Dt,[l(o(dt),{brandId:o(i).productBrandId,"onUpdate:brandId":t[4]||(t[4]=s=>o(i).productBrandId=s),onOnChange:o(f)},null,8,["brandId","onOnChange"])])])]),e("div",Nt,[e("div",Ot,[t[16]||(t[16]=e("label",{class:"control-label"},[e("span",null,"商品导入：")],-1)),e("div",Ut,[l(J,{modelValue:o(i).isCanImport,"onUpdate:modelValue":t[5]||(t[5]=s=>o(i).isCanImport=s),placeholder:"是否可导入"},{default:a(()=>[l(N,{label:"可导入",value:1}),l(N,{label:"不可导入",value:0})]),_:1},8,["modelValue"])])])])]),e("div",zt,[e("div",Tt,[t[19]||(t[19]=e("label",{class:"control-label"},null,-1)),e("div",qt,[l(d,{type:"primary",plain:"",onClick:o(f)},{default:a(()=>[...t[17]||(t[17]=[r("搜索",-1)])]),_:1},8,["onClick"]),l(d,{plain:"",onClick:o(E)},{default:a(()=>[...t[18]||(t[18]=[r("重置",-1)])]),_:1},8,["onClick"])])])])]),V.value=="vendor"?(n(),m("div",Ft,[e("div",Kt,[l(P,null,{default:a(()=>[F.value==1?(n(),g(w,{key:0,title:"您确认要批量断供吗？",onConfirm:t[6]||(t[6]=s=>j("outage"))},{reference:a(()=>[l(d,{disabled:o(p).length===0},{default:a(()=>[...t[20]||(t[20]=[r("批量断供",-1)])]),_:1},8,["disabled"])]),_:1})):u("",!0),o(p).length>0?(n(),m("span",Rt,[t[21]||(t[21]=r(" 已选择：",-1)),e("b",null,y(o(p).length),1),t[22]||(t[22]=r(" 项 ",-1))])):u("",!0)]),_:1})])])):u("",!0),e("div",$t,[e("div",Lt,[l(P,null,{default:a(()=>[l(w,{title:"您确认要批量导入吗？",onConfirm:G},{reference:a(()=>[l(d,{disabled:o(p).length===0},{default:a(()=>[...t[23]||(t[23]=[r("批量导入",-1)])]),_:1},8,["disabled"])]),_:1}),l(w,{title:"您确认要批量上架吗？",onConfirm:t[7]||(t[7]=s=>Q("up"))},{reference:a(()=>[l(d,{disabled:o(p).length===0},{default:a(()=>[...t[24]||(t[24]=[r("批量上架",-1)])]),_:1},8,["disabled"])]),_:1}),o(p).length>0?(n(),m("span",Et,[t[25]||(t[25]=r(" 已选择：",-1)),e("b",null,y(o(p).length),1),t[26]||(t[26]=r(" 项 ",-1))])):u("",!0)]),_:1})])])]),_:1},8,["model"])]),e("div",jt,[l(Y,{spinning:o(D)},{default:a(()=>[l(X,{data:o(A),total:o(S),"row-key":"id",onSelectionChange:o($),onSortChange:o(R)},{empty:a(()=>[e("div",Yt,[o(D)?u("",!0):(n(),m("div",Zt,"暂无数据"))])]),default:a(()=>[l(_,{type:"selection",width:"32"}),l(_,{label:"商品名称",prop:"id",sortable:"custom","min-width":320},{default:a(({row:s})=>[e("div",Qt,[s.picThumb?(n(),m("div",Gt,[e("img",{src:o(at)(s.picThumb),height:"68",width:"68",alt:""},null,8,Ht)])):u("",!0),e("div",Jt,[e("div",Mt,[e("div",null,y(s.productName),1)])])])]),_:1}),l(_,{width:100,label:"商品分类",prop:"productCategoryName",align:"center"},{default:a(({row:s})=>[e("div",null,y(s.productCategoryName||"--"),1)]),_:1}),l(_,{width:120,label:"供应商",prop:"vendorName",sortable:"custom",align:"center"},{default:a(({row:s})=>[e("div",null,y(s.vendorName),1)]),_:1}),l(_,{width:100,label:"供货价",prop:"supplyPrice",sortable:"custom",align:"center"},{default:a(({row:s})=>[e("div",null,y(s.supplyPrice),1)]),_:1}),l(_,{width:120,label:"商品状态",prop:"productStatus"},{default:a(({row:s})=>[s.productStatus===1?(n(),m("div",Wt,"上架")):(n(),m("div",Xt,"下架"))]),_:1}),l(_,{width:120,fixed:"right",label:"操作"},{default:a(({row:s})=>[l(P,null,{default:a(()=>[s.isImported===1?(n(),g(o(z),{key:0,maskClose:!1,params:{act:"detail",id:s.productId,type:"vendor",examine:1},isDrawer:"",path:"product/product/Info",title:"编辑商品",width:"950px",onOkCallback:v},{default:a(()=>[...t[27]||(t[27]=[e("a",{class:"btn-link"},"编辑",-1)])]),_:1},8,["params"])):(n(),g(o(z),{key:1,maskClose:!1,showClose:!1,showOnOk:!1,params:{act:"detail",id:s.id,examine:1,type:"vendor"},isDrawer:"",path:"vendor/supplier/product/Info",title:"查看商品",width:"1000px",onOkCallback:v},{default:a(()=>[...t[28]||(t[28]=[e("a",{class:"btn-link"},"查看",-1)])]),_:1},8,["params"])),l(W,{direction:"vertical"}),s.isImported===0?(n(),g(o(x),{key:2,params:{vendorProductIds:[s.id]},requestApi:o(it),title:"确定导入该商品吗？",message:"操作成功",onAfterDelete:v},{default:a(()=>[...t[29]||(t[29]=[r(" 导入 ",-1)])]),_:1},8,["params","requestApi"])):u("",!0),s.isImported===1&&s.productStatus===0?(n(),g(o(x),{key:3,params:{id:s.productId,field:"productStatus",val:1},requestApi:o(O),title:"确定上架该商品吗？",message:"操作成功",onAfterDelete:v},{default:a(()=>[...t[30]||(t[30]=[r(" 上架 ",-1)])]),_:1},8,["params","requestApi"])):u("",!0),s.isImported===1&&s.productStatus===1?(n(),g(o(x),{key:4,params:{id:s.productId,field:"productStatus",val:0},requestApi:o(O),title:"确定下架该商品吗？",message:"操作成功",onAfterDelete:v},{default:a(()=>[...t[31]||(t[31]=[r(" 下架 ",-1)])]),_:1},8,["params","requestApi"])):u("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data","total","onSelectionChange","onSortChange"])]),_:1},8,["spinning"]),o(S)>0?(n(),m("div",te,[l(o(lt),{page:o(i).page,"onUpdate:page":t[8]||(t[8]=s=>o(i).page=s),size:o(i).size,"onUpdate:size":t[9]||(t[9]=s=>o(i).size=s),total:o(S),onCallback:o(C)},null,8,["page","size","total","onCallback"])])):u("",!0)])])])])}}}),Be=ot(ee,[["__scopeId","data-v-b38ef8fe"]]);export{Be as default};

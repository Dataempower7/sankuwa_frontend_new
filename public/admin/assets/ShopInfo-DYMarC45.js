import{d as J,r as u,a as K,a2 as M,ah as O,o as H,e as s,f as y,g as d,h as C,j as c,k as x,z as t,l,G as P,i as Q,L as v,F as A,m as W,J as X,A as Y,K as _,_ as Z}from"./index-BLXOA87U.js";import"./index-DpgvsnVO.js";import"./vuedraggable.umd-OAFqtEpj.js";import"./BusinessImg-C3Ug8bC9.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-DfcXXcrS.js";import{U as $}from"./UploadAvatar-Dh3Vm0Ah.js";import{i as ee,h as ae,j as te}from"./adminUser-Dx0e6TZm.js";import oe from"./AuthoritySelect-SX4Jcwru.js";import"./index-B16C4gX_.js";import"./currencyManagement-ZKRxsK3T.js";import"./version-hjn5tnxG.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-6GHo9HCV.js";import"./Image.vue_vue_type_script_setup_true_lang-BK00jvUw.js";import"./format-DdZABYp4.js";const le={class:"container"},re={class:"content_wrapper"},se={class:"lyecs-form-table"},ne=J({__name:"ShopInfo",props:{id:{type:Number,default:0},suppliersId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:T,emit:B}){const f=B;u(localStorage.getItem("adminType"));const i=N,p=u(!0),V=K().currentRoute.value.query,g=u(i.isDialog?i.act:String(V.act)),I=u(i.isDialog?i.id:Number(V.id)),U=g.value==="add"?"create":"update",w=M(),a=O({userId:""}),S=u(),D=u({}),b=u(!0),R=async()=>{var r;try{const e=await ee(g.value,{id:I.value});D.value=e.user,Object.assign(a,e),e.authList==null&&(a.authList=[]),a.mobile=(r=e.adminUser)==null?void 0:r.mobile;let m=Y(String(a.avatar));m=="one"?b.value=!0:m=="def"&&(b.value=!1)}catch(e){_.error(e.message),f("close")}finally{p.value=!1}},q=async()=>{try{const r=await ae();S.value=r}catch(r){_.error(r.message)}};H(()=>{g.value==="detail"?R():p.value=!1,U!="update"&&i.type==="suppliers"&&(a.roleId=2,a.suppliersId=i.suppliersId),q()});const h=async()=>{await w.value.validate();try{f("update:confirmLoading",!0);let r={avatar:""};!a.avatar&&a.defAvatar?r.avatar=a.defAvatar:r.avatar=a.avatar;const e=await te(U,{id:I.value,...a,avatar:r.avatar});f("submitCallback",e),_.success("操作成功")}catch(r){_.error(r.message)}finally{f("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{h()}}),(r,e)=>{const m=s("TigInput"),n=s("el-form-item"),k=s("el-radio"),F=s("el-radio-group"),L=s("el-option"),j=s("el-select"),z=s("el-button"),E=s("el-form"),G=s("a-spin");return d(),y("div",le,[C("div",re,[C("div",se,[p.value?x("",!0):(d(),c(E,{key:0,ref_key:"formRef",ref:w,model:a,"label-width":"auto"},{default:l(()=>[t(n,{rules:[{required:!0,message:"员工名称不能为空!"}],label:"员工名称",prop:"username"},{default:l(()=>[t(m,{width:"100%",modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=o=>a.username=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:l(()=>[t(m,{width:"100%",modelValue:a.mobile,"onUpdate:modelValue":e[1]||(e[1]=o=>a.mobile=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"邮箱",prop:"email"},{default:l(()=>[t(m,{width:"100%",modelValue:a.email,"onUpdate:modelValue":e[2]||(e[2]=o=>a.email=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"头像",prop:"avatar"},{default:l(()=>[t(Q($),{avatar:a.avatar,"onUpdate:avatar":e[3]||(e[3]=o=>a.avatar=o),avatarType:b.value,loading:p.value},null,8,["avatar","avatarType","loading"])]),_:1}),t(n,{label:"是否停用",prop:"isUsing"},{default:l(()=>[t(F,{style:{width:"100%"},modelValue:a.isUsing,"onUpdate:modelValue":e[4]||(e[4]=o=>a.isUsing=o)},{default:l(()=>[t(k,{value:1},{default:l(()=>e[7]||(e[7]=[v("是",-1)])),_:1,__:[7]}),t(k,{value:0},{default:l(()=>e[8]||(e[8]=[v("否",-1)])),_:1,__:[8]})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"员工权限组",prop:"roleId"},{default:l(()=>[a.roleId!=2?(d(),c(j,{key:0,modelValue:a.roleId,"onUpdate:modelValue":e[5]||(e[5]=o=>a.roleId=o),style:{width:"100%"}},{default:l(()=>[t(L,{value:0,label:"自定义权限"}),(d(!0),y(A,null,W(S.value,o=>(d(),c(L,{label:o.roleName,value:o.roleId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(d(),y(A,{key:1},[v(" 供应商")],64))]),_:1}),a.roleId===0?(d(),c(n,{key:0,label:"",prop:"authList"},{default:l(()=>[t(oe,{modelValue:a.authList,"onUpdate:modelValue":e[6]||(e[6]=o=>a.authList=o)},null,8,["modelValue"])]),_:1})):x("",!0),P(t(n,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(z,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:h},{default:l(()=>e[9]||(e[9]=[v("提交",-1)])),_:1,__:[9]},512)]),_:1},512),[[X,!i.isDialog]])]),_:1},8,["model"])),t(G,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),we=Z(ne,[["__scopeId","data-v-d9c35280"]]);export{we as default};

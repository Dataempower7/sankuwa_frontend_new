import{d as L,x as Q,r as g,as as A,o as G,f as p,g as k,h as C,i as o,z as a,m as l,a8 as H,Q as h,j as i,l as z,t as O,P as I}from"./index-B52YIGC0.js";/* empty css             */import"./index-KjhYqCTY.js";import{P as J}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-CRFq-JzZ.js";import{_ as P}from"./Switch.vue_vue_type_script_setup_true_lang-D-71VfIC.js";import{D as W}from"./DeleteRecord-BTXBpwL2.js";/* empty css                                                                    */import{P as X}from"./Pagination-C8J7-6Em.js";import{u as N,d as Y,g as w,b as Z}from"./pcNavigation-C62Aiq_D.js";import{_ as T}from"./DialogForm.vue_vue_type_script_setup_true_lang-CT6mpwCc.js";const ee={class:"container"},te={class:"lyecs-table-list-warp"},ae={class:"list-table-tool lyecs-search-warp"},se={class:"advanced-search-warp list-table-tool-row"},oe={class:"simple-form-warp"},le={class:"simple-form-field"},ne={class:"form-group"},ie={class:"control-container"},re={class:"simple-form-field"},de={class:"form-group"},pe={class:"control-container"},ce={class:"simple-form-field"},ue={class:"form-group"},me={key:0},_e={class:"table-container"},fe={class:"empty-warp"},ve={key:0,class:"empty-bg"},ge={key:0,class:"pagination-con"},Ae=L({__name:"Tree",setup(he){const U=Q(),x=g([]),u=g(!0),y=g(0),m=g([]),r=A({page:1,size:U.get("pageSize"),sortField:"",sortOrder:"",keyword:"",type:2,parentId:0}),_=A({}),d=async()=>{u.value=!0;try{const t=await w({...r});x.value=t.records,y.value=t.total}catch(t){I.error(t.message)}finally{u.value=!1}},V=async(t,e,n)=>{_[t.id]={},_[t.id].resolve=n,_[t.id].expandCount=0;const f=await w({page:1,parentId:t.id,type:2,size:1e3});n(f.records)},q=async(t,e)=>{const n=_[t.id];if(n.expandCount++,e&&n.expandCount>1&&!n.prevStatus){const f=await w({page:1,parentId:t.id,type:2,size:1e3});n.resolve(f.records)}n.prevStatus=e},b=g(),B=async t=>{const e=_[t.parentId];if(e){const n=await w({page:1,parentId:t.parentId,type:2,size:1e3});b.value.store.states.lazyTreeNodeMap.value[t.parentId].length>1?b.value.store.states.lazyTreeNodeMap[t.parentId]=[]:b.value.store.states.lazyTreeNodeMap.value[t.parentId]=[],e.resolve(n.records)}else d()};G(()=>{d()});const D=({prop:t,order:e})=>{r.sortField=t,r.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},S=()=>{d()},F=async t=>{try{const e=await Z(t,{ids:m.value});I.success("操作成功"),d()}catch(e){I.error(e.message)}},M=t=>{m.value=t.map(e=>e.id)};return(t,e)=>{const n=p("el-button"),f=p("TigInput"),R=p("el-popconfirm"),E=p("el-space"),c=p("el-table-column"),$=p("el-divider"),K=p("el-table"),j=p("a-spin");return C(),k("div",ee,[o("div",te,[o("div",ae,[o("div",se,[o("div",oe,[o("div",le,[o("div",ne,[o("div",ie,[a(f,{modelValue:r.keyword,"onUpdate:modelValue":e[0]||(e[0]=s=>r.keyword=s),name:"keyword",placeholder:"输入导航栏名称",onKeyup:H(S,["enter"]),clearable:"",onClear:S},{append:l(()=>[a(n,{onClick:S},{default:l(()=>[...e[4]||(e[4]=[o("span",{class:"iconfont icon-chakan1"},null,-1)])]),_:1})]),_:1},8,["modelValue"])])])]),o("div",re,[o("div",de,[o("div",pe,[a(i(T),{params:{act:"add",type:2},title:"添加顶部小导航",isDrawer:"",path:"decorate/pcNavigation/Info",width:"560px",onOkCallback:d},{default:l(()=>[a(n,{type:"primary"},{default:l(()=>[...e[5]||(e[5]=[h("添加顶部小导航",-1)])]),_:1})]),_:1})])])]),o("div",ce,[o("div",ue,[a(E,null,{default:l(()=>[a(R,{title:"您确认要批量删除所选数据吗？",onConfirm:e[1]||(e[1]=s=>F("del"))},{reference:l(()=>[a(n,{disabled:m.value.length===0},{default:l(()=>[...e[6]||(e[6]=[h("批量删除",-1)])]),_:1},8,["disabled"])]),_:1}),m.value.length>0?(C(),k("span",me,[e[7]||(e[7]=h(" 已选择：",-1)),o("b",null,O(m.value.length),1),e[8]||(e[8]=h(" 项 ",-1))])):z("",!0)]),_:1})])])])])]),o("div",_e,[a(j,{spinning:u.value},{default:l(()=>[a(K,{data:x.value,indent:30,load:V,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"",loading:u.value,total:y.value,"row-key":"id",onSelectionChange:M,onExpandChange:q,onSortChange:D,ref_key:"tableRef",ref:b},{empty:l(()=>[o("div",fe,[u.value?z("",!0):(C(),k("div",ve,"暂无数据"))])]),default:l(()=>[a(c,{type:"selection",width:"32"}),a(c,{width:200,label:"名称",prop:"title"}),a(c,{width:100,label:"位置",prop:"typeName"}),a(c,{label:"是否显示",prop:"isShow"},{default:l(({row:s})=>[a(i(P),{checked:s.isShow,"onUpdate:checked":v=>s.isShow=v,params:{id:s.id,field:"isShow"},requestApi:i(N)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(c,{label:"是否新窗口"},{default:l(({row:s})=>[a(i(P),{checked:s.isBlank,"onUpdate:checked":v=>s.isBlank=v,params:{id:s.id,field:"isBlank"},requestApi:i(N)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(c,{label:"排序",prop:"sortOrder",sortable:"custom"},{default:l(({row:s})=>[a(i(J),{"org-value":s.sortOrder,"onUpdate:orgValue":v=>s.sortOrder=v,params:{id:s.id,field:"sortOrder"},requestApi:i(N),extra:"默认值为50，数值越小，排序越靠前",label:"排序",type:"integer"},{default:l(()=>[o("div",null,O(s.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(c,{width:150,fixed:"right",label:"操作"},{default:l(({row:s})=>[a(i(T),{params:{act:"detail",type:2,id:s.id},title:"编辑商城顶部小导航栏",isDrawer:"",path:"decorate/pcNavigation/Info",width:"560px",onOkCallback:B},{default:l(()=>[...e[9]||(e[9]=[o("a",{class:"btn-link"},"编辑",-1)])]),_:1},8,["params"]),a($,{direction:"vertical"}),a(i(W),{params:{id:s.id},requestApi:i(Y),onAfterDelete:d},{default:l(()=>[...e[10]||(e[10]=[h("删除 ",-1)])]),_:1},8,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),y.value>0?(C(),k("div",ge,[a(i(X),{page:r.page,"onUpdate:page":e[2]||(e[2]=s=>r.page=s),size:r.size,"onUpdate:size":e[3]||(e[3]=s=>r.size=s),total:y.value,onCallback:d},null,8,["page","size","total"])])):z("",!0)])])])}}});export{Ae as _};

/* empty css             */import{M as A}from"./MapContainer-C9hjajVp.js";import{b as C,c as V}from"./intraCityDelivery-CDNtFMRZ.js";import{d as P,u as M,ab as T,r as n,c as j,o as k,f as p,k as z,h as B,m as d,i as u,z as a,ah as D,j as U,Q as q,ac as J,P as v,_ as Q}from"./index-B52YIGC0.js";import{S as W}from"./SelectRegion-B1dYo0k6.js";import{e as E}from"./shop-CBisV8Of.js";import"./index-Wb8975_T.js";import"./region-BXYVi85_.js";import"./region-DzZbv6Nj.js";/* empty css                                                                     */const F={class:"content_wrapper"},G={class:"map-container"},H={class:"selected-action"},K=P({__name:"settingPlatStore",setup(X){const{themeInfo:_}=M(),g=T(),f=n(),s=n([]),O=n(""),m=n(!1),e=n({storeSelfOperatedName:"",storeSelfOperatedLogo:"",storeSelfOperatedRegion:"",storeSelfOperatedAddress:"",storeSelfOperatedLongitude:"",storeSelfOperatedLatitude:""}),c=n(!0),h=async()=>{c.value=!0;try{if(J()&&JSON.parse(localStorage.getItem("shopInfo")||"{}").shopId){const t=await E("detail",{shopId:JSON.parse(localStorage.getItem("shopInfo")||"{}").shopId}),{shopTitle:o,shopLogo:l,shopLongitude:r,shopLatitude:S}=t||{};Object.assign(e.value,{storeSelfOperatedName:o||"",storeSelfOperatedLogo:l||"",storeSelfOperatedLongitude:r||"",storeSelfOperatedLatitude:S||"",storeSelfOperatedAddress:(t==null?void 0:t.shopDetailedAddress)||""})}else{const t=await C();e.value=t}}catch(t){v.error(t.message)}finally{c.value=!1}},L=j(()=>e.value.storeSelfOperatedLatitude&&e.value.storeSelfOperatedLongitude?e.value.storeSelfOperatedLongitude+","+e.value.storeSelfOperatedLatitude:""),y=t=>{var o,l;O.value=(o=t.map(r=>r.regionName))==null?void 0:o.join(""),f.value.search(((l=s.value)==null?void 0:l.join(","))+O.value),e.value.storeSelfOperatedAddress=""},I=()=>{s.value=[],e.value.storeSelfOperatedRegion="",e.value.storeSelfOperatedAddress="",e.value.storeSelfOperatedLongitude="",e.value.storeSelfOperatedLatitude="",f.value.clearSearch()},b=()=>{const t=s.value.join(",")+e.value.storeSelfOperatedRegion+e.value.storeSelfOperatedAddress;t&&f.value.search(t)},w=t=>{e.value.storeSelfOperatedLongitude=t.position[0],e.value.storeSelfOperatedLatitude=t.position[1],e.value.storeSelfOperatedAddress=t.name},N=async()=>{var t;try{await g.value.validate(),m.value=!0;const o=await V({...e.value,storeSelfOperatedRegion:(t=s.value)==null?void 0:t.join(",")});v.success("修改成功")}catch(o){o&&o.message&&v.error(o.message)}finally{m.value=!1}};return k(async()=>{await h(),e.value.storeSelfOperatedRegion?s.value=e.value.storeSelfOperatedRegion.split(",").map(t=>Number(t)):s.value=[]}),(t,o)=>{const l=p("TigInput"),r=p("el-form-item"),S=p("el-form"),R=p("el-button"),x=p("a-spin");return B(),z(x,{spinning:c.value},{default:d(()=>[u("div",F,[a(S,{ref_key:"formRef",ref:g,model:e.value,"label-width":"auto",style:{display:"flex",gap:"0.75rem","flex-direction":"column"}},{default:d(()=>[a(r,{label:"门店名称",prop:"storeSelfOperatedName",rules:[{required:!0,message:"门店名称不能为空!"}]},{default:d(()=>[a(l,{width:"30%",modelValue:e.value.storeSelfOperatedName,"onUpdate:modelValue":o[0]||(o[0]=i=>e.value.storeSelfOperatedName=i),showWordLimit:"",maxlength:20},null,8,["modelValue"])]),_:1}),a(r,{label:"门店地址",prop:"storeSelfOperatedAddress",rules:[{required:!0,message:"请选择门店地址!"}]},{default:d(()=>[u("div",null,[a(W,{selectedIds:s.value,"onUpdate:selectedIds":o[1]||(o[1]=i=>s.value=i),onChange:y,onClear:I,style:{width:"260px","margin-bottom":"10px"}},null,8,["selectedIds"]),a(l,{width:"500px",placeholder:"详细地址",modelValue:e.value.storeSelfOperatedAddress,"onUpdate:modelValue":o[2]||(o[2]=i=>e.value.storeSelfOperatedAddress=i),onInput:b,class:"mb20"},null,8,["modelValue"])])]),_:1}),a(r,{label:" "},{default:d(()=>[u("div",G,[a(A,{ref_key:"MapRef",ref:f,defaultPosition:L.value,onPositionChange:w},null,8,["defaultPosition"])])]),_:1})]),_:1},8,["model"])]),u("div",{class:"selected-action-warp selected-warp-left",style:D({left:U(_).layout!=="topMenu"?"23.0625rem":"16.875rem"})},[u("div",H,[a(R,{loading:m.value,class:"form-submit-btn",size:"large",type:"primary",onClick:N},{default:d(()=>[...o[3]||(o[3]=[q("提 交",-1)])]),_:1},8,["loading"])])],4)]),_:1},8,["spinning"])}}}),ne=Q(K,[["__scopeId","data-v-d10a583b"]]);export{ne as default};

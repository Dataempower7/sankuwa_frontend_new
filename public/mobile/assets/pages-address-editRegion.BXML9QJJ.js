import{d as e,L as a,r as l,Y as o,v as r,ai as s,n as t,J as n,e as i,w as u,K as d,C as m,F as c,at as p,b as f,i as g,h as b,t as h,R as v,as as V,au as _,_ as y}from"./index-BZxHr1FI.js";import{_ as $}from"./uni-easyinput.DHFPvsdC.js";import{_ as j,a as w}from"./uni-forms.QWcIXEX3.js";import{T as N,a as U}from"./tig-layout.DTz8E-sj.js";import{T as q}from"./tig-fixed-placeholder.BDsbIjoZ.js";import{s as x}from"./selectRegion.BHwp_VCr.js";import{a as R,b as D,u as I}from"./address.CA-6xUbG.js";import"./uni-icons.DMMn2oBg.js";const k=y(e({__name:"editRegion",setup(e){const{t:y}=a(),k=l("添加地址"),M=l(null),T=o({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:"",regionNames:"",isDefault:0}),C=l(!1),F={consignee:{rules:[{required:!0,errorMessage:y("请您填写收货人姓名")}]},regionNames:{rules:[{required:!0,errorMessage:y("请选择所在地区")},{validateFunction:function(e,a,l,o){return T.regionIds.length<1&&o(y("请选择所在地区")),!0}}]},address:{rules:[{required:!0,errorMessage:y("请您填写详细收货地址")}]},mobile:{rules:[{required:!0,errorMessage:y("请您填写收货人手机号码")},{validateFunction:function(e,a,l,o){/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(y("请输入正确的手机号码"));return!0}}]}};r(()=>{s(()=>{S.value.setRules(F)})}),t(e=>{e&&e.id&&(k.value="编辑地址",M.value=e.id,O())});const O=async()=>{try{const e=await R({id:M.value}),{regionNames:a}=e;Object.assign(T,e),T.regionNames=a.join(" "),C.value=1===T.isDefault}catch(e){console.error(e)}},G=e=>{T.regionNames=e.join(" ")},J=l(!1),K=()=>{J.value=!0},L=l(!1),S=l(),Y=()=>{S.value.validate().then(()=>{T.isDefault=C.value?1:0,M.value?A():z()}).catch(e=>{console.log("表单错误信息：",e)})},z=async()=>{L.value=!0;try{await D(T),v({title:y("添加地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{V({success:function(e){_("refreshData"),L.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3}),L.value=!1}},A=async()=>{L.value=!0;try{await I({id:M.value,...T}),v({title:y("编辑地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{V({success:function(e){_("refreshData"),L.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3})}};return(e,a)=>{const l=m(c("uni-easyinput"),$),o=m(c("uni-forms-item"),j),r=g,s=m(c("u-switch"),p),t=m(c("uni-forms"),w),v=m(c("tig-button"),U),V=m(c("tig-fixed-placeholder"),q),_=m(c("tig-layout"),N);return f(),n(d,null,[i(_,{title:k.value},{default:u(()=>[i(r,{class:"address-edit-main"},{default:u(()=>[i(r,{class:"address-edit-content"},{default:u(()=>[i(t,{ref_key:"formRef",ref:S,"model-value":T,"label-width":"165rpx"},{default:u(()=>[i(o,{label:e.$t("收货人："),name:"consignee",required:""},{default:u(()=>[i(l,{modelValue:T.consignee,"onUpdate:modelValue":a[0]||(a[0]=e=>T.consignee=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入姓名")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("所在地区："),name:"regionNames",required:""},{default:u(()=>[i(r,{class:"region-input",onClick:K},{default:u(()=>[i(l,{modelValue:T.regionNames,"onUpdate:modelValue":a[1]||(a[1]=e=>T.regionNames=e),"suffix-icon":"right","primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("点击选择所在地区"),readonly:"",class:"no-pointer"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),i(o,{label:e.$t("详细地址："),name:"address",required:""},{default:u(()=>[i(l,{modelValue:T.address,"onUpdate:modelValue":a[2]||(a[2]=e=>T.address=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请您填写详细收货地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("手机号码："),name:"mobile",required:""},{default:u(()=>[i(l,{modelValue:T.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>T.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入手机号码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("固定电话："),name:"telephone"},{default:u(()=>[i(l,{modelValue:T.telephone,"onUpdate:modelValue":a[4]||(a[4]=e=>T.telephone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入固定电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("邮箱地址："),name:"email"},{default:u(()=>[i(l,{modelValue:T.email,"onUpdate:modelValue":a[5]||(a[5]=e=>T.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入邮箱地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("默认地址"),name:"email"},{default:u(()=>[i(r,{class:"switch"},{default:u(()=>[i(s,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),"active-color":"var(--general)"},null,8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model-value"])]),_:1})]),_:1}),i(V,{"background-color":"#fff"},{default:u(()=>[i(r,{class:"btn-box"},{default:u(()=>[i(v,{loading:L.value,onClick:Y},{default:u(()=>[b(h(e.$t("提交")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["title"]),i(x,{show:J.value,"onUpdate:show":a[7]||(a[7]=e=>J.value=e),modelValue:T.regionIds,"onUpdate:modelValue":a[8]||(a[8]=e=>T.regionIds=e),onSendRegionNames:G},null,8,["show","modelValue"])],64)}}}),[["__scopeId","data-v-d5136096"]]);export{k as default};

import{d as e,K as a,r as l,W as o,s as r,ah as s,l as t,I as n,g as i,w as u,J as d,B as m,E as c,as as p,o as f,i as g,f as b,t as h,Q as v,ar as _,at as V,_ as y}from"./index-DDAlCzEE.js";import{_ as $}from"./uni-easyinput.naLj-1jX.js";import{_ as j,a as w}from"./uni-forms.MUFzpXZ0.js";import{_ as N,a as U}from"./tig-layout.Dp_86RM-.js";import{_ as q}from"./tig-fixed-placeholder.BwC6eLvS.js";import{s as x}from"./selectRegion.BIjxgH3F.js";import{a as I,b as D,u as R}from"./address.BRf_08oi.js";import"./uni-icons.piUs7f0e.js";const k=y(e({__name:"editRegion",setup(e){const{t:y}=a(),k=l("添加地址"),M=l(null),C=o({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:"",regionNames:"",isDefault:0}),E=l(!1),F={consignee:{rules:[{required:!0,errorMessage:y("请您填写收货人姓名")}]},regionNames:{rules:[{required:!0,errorMessage:y("请选择所在地区")},{validateFunction:function(e,a,l,o){return C.regionIds.length<1&&o(y("请选择所在地区")),!0}}]},address:{rules:[{required:!0,errorMessage:y("请您填写详细收货地址")}]},mobile:{rules:[{required:!0,errorMessage:y("请您填写收货人手机号码")},{validateFunction:function(e,a,l,o){/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(y("请输入正确的手机号码"));return!0}}]}};r(()=>{s(()=>{K.value.setRules(F)})}),t(e=>{e&&e.id&&(k.value="编辑地址",M.value=e.id,T())});const T=async()=>{try{const e=await I({id:M.value}),{regionNames:a}=e;Object.assign(C,e),C.regionNames=a.join(" "),E.value=1===C.isDefault}catch(e){console.error(e)}},W=e=>{C.regionNames=e.join(" ")},B=l(!1),H=()=>{B.value=!0},J=l(!1),K=l(),O=()=>{K.value.validate().then(()=>{C.isDefault=E.value?1:0,M.value?S():Q()}).catch(e=>{console.log("表单错误信息：",e)})},Q=async()=>{J.value=!0;try{await D(C),v({title:y("添加地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),J.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3}),J.value=!1}},S=async()=>{J.value=!0;try{await R({id:M.value,...C}),v({title:y("编辑地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),J.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3})}};return(e,a)=>{const l=m(c("uni-easyinput"),$),o=m(c("uni-forms-item"),j),r=g,s=m(c("u-switch"),p),t=m(c("uni-forms"),w),v=m(c("tig-button"),U),_=m(c("tig-fixed-placeholder"),q),V=m(c("tig-layout"),N);return f(),n(d,null,[i(V,{title:k.value},{default:u(()=>[i(r,{class:"address-edit-main"},{default:u(()=>[i(r,{class:"address-edit-content"},{default:u(()=>[i(t,{ref_key:"formRef",ref:K,"model-value":C,"label-width":"165rpx"},{default:u(()=>[i(o,{label:e.$t("收货人："),name:"consignee",required:""},{default:u(()=>[i(l,{modelValue:C.consignee,"onUpdate:modelValue":a[0]||(a[0]=e=>C.consignee=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入姓名")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("所在地区："),name:"regionNames",required:""},{default:u(()=>[i(r,{class:"region-input",onClick:H},{default:u(()=>[i(l,{modelValue:C.regionNames,"onUpdate:modelValue":a[1]||(a[1]=e=>C.regionNames=e),"suffix-icon":"right","primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("点击选择所在地区"),readonly:"",class:"no-pointer"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),i(o,{label:e.$t("详细地址："),name:"address",required:""},{default:u(()=>[i(l,{modelValue:C.address,"onUpdate:modelValue":a[2]||(a[2]=e=>C.address=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请您填写详细收货地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("手机号码："),name:"mobile",required:""},{default:u(()=>[i(l,{modelValue:C.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>C.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入手机号码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("固定电话："),name:"telephone"},{default:u(()=>[i(l,{modelValue:C.telephone,"onUpdate:modelValue":a[4]||(a[4]=e=>C.telephone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入固定电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("邮箱地址："),name:"email"},{default:u(()=>[i(l,{modelValue:C.email,"onUpdate:modelValue":a[5]||(a[5]=e=>C.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入邮箱地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("默认地址"),name:"email"},{default:u(()=>[i(r,{class:"switch"},{default:u(()=>[i(s,{modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=e=>E.value=e),"active-color":"var(--general)"},null,8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model-value"])]),_:1})]),_:1}),i(_,{"background-color":"#fff"},{default:u(()=>[i(r,{class:"btn-box"},{default:u(()=>[i(v,{loading:J.value,onClick:O},{default:u(()=>[b(h(e.$t("提交")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["title"]),i(x,{show:B.value,"onUpdate:show":a[7]||(a[7]=e=>B.value=e),modelValue:C.regionIds,"onUpdate:modelValue":a[8]||(a[8]=e=>C.regionIds=e),onSendRegionNames:W},null,8,["show","modelValue"])],64)}}}),[["__scopeId","data-v-6d326727"]]);export{k as default};

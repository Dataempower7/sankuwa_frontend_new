import{d as e,a7 as a,a5 as l,r as t,V as s,aM as o,c as u,b as i,w as n,e as r,W as d,i as c,J as h,K as m,P as y,Z as b,k as v,h as w,t as p,aB as f,ai as g,aP as _,aQ as k,aY as S,_ as x,m as C,a as L,L as I,O as T,R as M,l as j,y as $,v as z,az as B,n as V,G as D,M as N,C as U,F as W,E as F,N as P,ah as E,f as K,a2 as R,H as G,j as H}from"./index-BZxHr1FI.js";import{_ as O}from"./loading-box.D3Y7A2lC.js";import{T as Q}from"./tig-layout.DTz8E-sj.js";import{b as Y,g as J,a as Z,c as q,d as A}from"./buyerShowCloseTip.CrtXzvBV.js";import{T as X}from"./tig-lazy-image.BPOhG_XX.js";import{u as ee}from"./useList.cF42RyDa.js";import"./uni-transition.COpRW9Ft.js";import"./product.BH5dMQls.js";const ae="/mobile/assets/publish-QnbsmFes.png",le=x(e({__name:"horizontal-tabs",props:a({tabs:{}},{currentTab:{},currentTabModifiers:{}}),emits:["update:currentTab"],setup(e){const a=e,x=l(e,"currentTab"),C=t(0),L=t([]),I=k(),T=async()=>new Promise(e=>{g(async()=>{const a=await _(".tab-item",I,!0);L.value=a.map(e=>e.width),e()})}),M=async e=>{if(0===L.value.length&&await T(),L.value.length>0&&e<L.value.length){let a=0;for(let s=0;s<e;s++)a+=L.value[s];const l=L.value[e],t=a-(S().windowWidth-l)/2;C.value=Math.max(0,t)}else{const a=120,l=e*a-(S().windowWidth-a)/2;C.value=Math.max(0,l)}};return s(x,e=>{M(e)}),s(()=>a.tabs,async()=>{await T(),void 0!==x.value&&M(x.value)},{immediate:!0}),o(async()=>{await T(),void 0!==x.value&&M(x.value)}),(e,a)=>{const l=v,t=c,s=d;return i(),u(t,{class:"horizontal-tabs"},{default:n(()=>[r(s,{class:"tabs-container","scroll-x":"true","scroll-left":C.value,"scroll-with-animation":""},{default:n(()=>[r(t,{class:"tabs-wrapper"},{default:n(()=>[(i(!0),h(m,null,y(e.tabs,(e,a)=>(i(),u(t,{key:a,class:b(["tab-item",{active:x.value===a}]),onClick:e=>(e=>{x.value=e})(a)},{default:n(()=>[r(l,{class:"tab-text"},{default:n(()=>[w(p(e.title),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1},8,["scroll-left"]),r(t,{class:"tabs-content"},{default:n(()=>[f(e.$slots,"default",{currentIndex:x.value},void 0,!0)]),_:3})]),_:3})}}}),[["__scopeId","data-v-4dc1ab52"]]),te=x(e({__name:"WaterfallLayout",props:{list:{default:()=>[]},layout:{default:"double"},showToggle:{type:Boolean,default:!1}},emits:["update:layout","load-more","item-click"],setup(e,{emit:a}){const l=e,d=a,p=t(l.layout),g=t([]),_=t([]),k=t([0,0]),S=C(()=>l.list),x=(e,a)=>"left"===e?2*a:2*a+1,I=e=>{p.value=e,d("update:layout",e),"double"===e&&T()},T=()=>{g.value=[],_.value=[],k.value=[0,0],l.list.forEach((e,a)=>{a%2==0?g.value.push(e):_.value.push(e)})},M=(e,a)=>{d("item-click",e,a)};return s(()=>l.list,e=>{"double"===p.value&&T()},{immediate:!1}),s(()=>l.layout,e=>{p.value=e}),o(()=>{"double"===p.value&&T()}),(e,a)=>{const l=v,t=c;return i(),u(t,{class:"waterfall-layout"},{default:n(()=>[e.showToggle?(i(),u(t,{key:0,class:"layout-toggle"},{default:n(()=>[r(t,{class:b(["toggle-btn",{active:"single"===p.value}]),onClick:a[0]||(a[0]=e=>I("single"))},{default:n(()=>[r(l,{class:"iconfont icon-danlie"},{default:n(()=>[w("单列")]),_:1})]),_:1},8,["class"]),r(t,{class:b(["toggle-btn",{active:"double"===p.value}]),onClick:a[1]||(a[1]=e=>I("double"))},{default:n(()=>[r(l,{class:"iconfont icon-shuanglie"},{default:n(()=>[w("双列")]),_:1})]),_:1},8,["class"])]),_:1})):L("",!0),r(t,{class:b(["waterfall-container",[`layout-${p.value}`]]),"scroll-y":!0},{default:n(()=>["single"===p.value?(i(),u(t,{key:0,class:"single-column"},{default:n(()=>[(i(!0),h(m,null,y(S.value,(a,l)=>(i(),u(t,{key:l,class:"waterfall-item single-item",onClick:e=>M(a,l)},{default:n(()=>[f(e.$slots,"item",{item:a,index:l},void 0,!0)]),_:2},1032,["onClick"]))),128))]),_:3})):L("",!0),"double"===p.value?(i(),u(t,{key:1,class:"double-columns"},{default:n(()=>[r(t,{class:"column left-column"},{default:n(()=>[(i(!0),h(m,null,y(g.value,(a,l)=>(i(),u(t,{key:`left-${l}`,class:"waterfall-item double-item",onClick:e=>M(a,x("left",l))},{default:n(()=>[f(e.$slots,"item",{item:a,index:x("left",l)},void 0,!0)]),_:2},1032,["onClick"]))),128))]),_:3}),r(t,{class:"column right-column"},{default:n(()=>[(i(!0),h(m,null,y(_.value,(a,l)=>(i(),u(t,{key:`right-${l}`,class:"waterfall-item double-item",onClick:e=>M(a,x("right",l))},{default:n(()=>[f(e.$slots,"itemRight",{item:a,index:x("right",l)},void 0,!0)]),_:2},1032,["onClick"]))),128))]),_:3})]),_:3})):L("",!0)]),_:3},8,["class"])]),_:3})}}}),[["__scopeId","data-v-44007ed6"]]),se=x(e({__name:"buyerShowItem",props:{buyerShowItem:{},buyerShowItemModifiers:{},buyerShowIndex:{},buyerShowIndexModifiers:{},buyerShowListData:{},buyerShowListDataModifiers:{}},emits:["update:buyerShowItem","update:buyerShowIndex","update:buyerShowListData"],setup(e){const{t:a}=I(),t=l(e,"buyerShowItem"),s=l(e,"buyerShowIndex"),o=l(e,"buyerShowListData"),d=e=>{var a,l;const t=[...e.videoList,...e.imgList].filter(Boolean);return(null==(a=t[0])?void 0:a.videoCover)||(null==(l=t[0])?void 0:l.picThumb)};return(e,l)=>{const h=c,m=v;return i(),u(h,{class:"buyerShow-buyerShowItem"},{default:n(()=>[r(h,{class:b({"video-icon":t.value.videoList.length>0})},null,8,["class"]),d(t.value)?(i(),u(X,{key:0,shimmer:!0,src:d(t.value),class:"product-image",mode:"widthFix"},null,8,["src"])):L("",!0),r(h,{class:"buyerShow-info"},{default:n(()=>[r(h,{class:"content"},{default:n(()=>[w(p(t.value.content),1)]),_:1}),r(h,{class:"buyerUser"},{default:n(()=>[r(h,{class:"imgBox"},{default:n(()=>[r(X,{src:t.value.buyerPhoto,class:"user-image",mode:"aspectFit"},null,8,["src"]),r(m,{class:"userName"},{default:n(()=>[w(p(t.value.buyerName),1)]),_:1})]),_:1}),r(h,{class:"likeBox"},{default:n(()=>[r(h,{class:"action-buyerShowItem",onClick:l[0]||(l[0]=T(e=>(async(e,l)=>{try{await Y({buyerShowId:e.buyerShowId,isLike:e.isLike?0:1}),M({title:a(e.isLike?"取消点赞":"点赞成功"),icon:"none"}),o.value[l].isLike=!e.isLike,o.value[l].likeCount=e.isLike?e.likeCount+1:e.likeCount-1}catch(t){M({title:null==t?void 0:t.message})}})(t.value,s.value),["stop"]))},{default:n(()=>[r(m,{class:b(["iconfont-h5",t.value.isLike?"icon-yiguanzhu":"icon-guanzhu"])},null,8,["class"]),r(m,{class:b(["like-count",{liked:t.value.isLike}])},{default:n(()=>[w(p(t.value.likeCount>0?t.value.likeCount:""),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-e13117e9"]]),oe=x(e({__name:"index",setup(e){const a=j();$(),z(()=>{$()});const l=t(1);s(()=>a,e=>{e.initLoading&&(l.value=e.buyerShowEnabled)},{deep:!0,immediate:!0});const o=B(),d=C(()=>o.token||N("token")),{total:y}=ee(J,{params:{page:1,size:1},path:{dataKey:"records"},immediate:!0,needReachBottom:!1}),b=()=>{H({url:"/pages/search/index",param:{redirectPath:"/pages/buyerShow/index",searchHistoryKey:"buyerShowSearchList",navbarTitle:"搜索买家秀",placeholder:"点击搜索",isSwitchTab:!0}})},w=()=>{H({url:"/pages/buyerShow/addBuyerShow"})},p=t([{title:"全部"}]),f=t(0),g=t(!0),_=t(!1),k=async()=>{console.log("loadMoreData")},S=e=>{H({url:"/pages/buyerShow/buyerShowDetail",param:{buyerShowId:e.buyerShowId}})},x=t({page:1,size:10,sortField:"addTime",sortOrder:"desc",keyword:""}),{getList:I,data:M,isLoading:Y,isLoadMore:X,total:oe}=ee(Z,{params:x,path:{dataKey:"records"},immediate:!1});return s(f,e=>{var a;x.value.goodsId=null==(a=p.value[e])?void 0:a.buyerShowGroupId,I({...x.value})},{deep:!0}),V(e=>{e.keyWords?(x.value.keyword=e.keyWords,I({...x.value})):I(),q().then(e=>{p.value=e.map(e=>({...e,title:e.groupName})),p.value.unshift({title:"全部"})})}),(e,t)=>{const s=v,o=P,C=c,I=K,j=U(W("loading-box"),O),$=U(W("up-empty"),F);return 1===l.value?(i(),h(m,{key:0},[r(Q,{title:D(a).buyerShowMobileShowName||"买家秀","show-left":!1},{default:n(()=>[r(C,{class:"buyerShowBox"},{default:n(()=>[r(C,{class:"header acea-row row-center-wrapper"},{default:n(()=>[r(C,{class:"acea-row row-between-wrapper input",onClick:T(b,["stop"])},{default:n(()=>[r(s,{class:"iconfont-h5 icon-sousuo"}),r(o,{modelValue:x.value.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>x.value.keyword=e),readonly:"",class:"txt",type:"text",placeholder:"点击搜索",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),r(C,{class:"tabs"},{default:n(()=>[r(le,{"current-tab":f.value,"onUpdate:currentTab":t[1]||(t[1]=e=>f.value=e),tabs:p.value},null,8,["current-tab","tabs"])]),_:1}),r(C,{class:"container"},{default:n(()=>[r(te,{list:D(M),"has-more":g.value,loading:_.value,layout:D(a).buyerShowTemplateStyle?"single":"double",onLoadMore:k,onItemClick:S},{item:n(({item:e,index:a})=>[r(se,{"buyer-show-item":e,"buyer-show-index":a,"buyer-show-list-data":D(M)},null,8,["buyer-show-item","buyer-show-index","buyer-show-list-data"])]),itemRight:n(({item:e,index:a})=>[r(se,{"buyer-show-item":e,"buyer-show-index":a,"buyer-show-list-data":D(M)},null,8,["buyer-show-item","buyer-show-index","buyer-show-list-data"])]),_:1},8,["list","has-more","loading","layout"])]),_:1}),d.value?D(y)?(i(),u(C,{key:1,class:"publish",onClick:w},{default:n(()=>[r(I,{src:ae,style:{width:"100%",height:"100%"}})]),_:1})):L("",!0):(i(),u(C,{key:0,class:"publish",onClick:D(E)},{default:n(()=>[r(I,{src:ae,style:{width:"100%",height:"100%"}})]),_:1},8,["onClick"])),r(j,{modelValue:D(X),"onUpdate:modelValue":t[2]||(t[2]=e=>R(X)?X.value=e:null),page:x.value.page,length:D(M).length},null,8,["modelValue","page","length"])]),_:1})]),_:1},8,["title"]),D(Y)||0!==D(oe)?L("",!0):(i(),u(C,{key:0,class:"empty-box"},{default:n(()=>[r($,{icon:D(G)("salesman/no_order.png"),text:e.$t("暂无数据")},null,8,["icon","text"])]),_:1}))],64)):(i(),u(Q,{key:1,title:"买家秀","show-left":!1,style:{height:"100vh"}},{default:n(()=>[r(A,{"buyer-show-enabled":l.value,"onUpdate:buyerShowEnabled":t[3]||(t[3]=e=>l.value=e)},null,8,["buyer-show-enabled"])]),_:1}))}}}),[["__scopeId","data-v-044273a9"]]);export{oe as default};

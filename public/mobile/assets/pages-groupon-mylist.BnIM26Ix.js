import{d as o,L as a,C as e,F as t,c as l,b as r,i as u,w as s,e as n,k as i,j as c,_ as d,r as p,az as g,Y as m,n as f,aA as _,E as y,a as v,J as h,K as x,P as j,G as k,ae as b,h as I,t as P,H as $,a2 as S,X as C,R}from"./index-BZxHr1FI.js";import{_ as V}from"./tig-image.CzXKqALH.js";import{_ as w}from"./format-price.BrXrBVy6.js";import{c as N,T as A,a as T}from"./tig-layout.DTz8E-sj.js";import{_ as z}from"./loading-box.D3Y7A2lC.js";import{_ as L}from"./tig-loadingpage.vue_vue_type_script_setup_true_lang.CErZUb08.js";import{g as G}from"./grouponShare.B6EudCI5.js";import{g as K,a as U}from"./groupon.CM2aLW4Q.js";import{g as H}from"./product.BH5dMQls.js";import{u as M}from"./useList.cF42RyDa.js";import"./currency.Dn5A4d7X.js";import"./uni-transition.COpRW9Ft.js";const W=d(o({__name:"grouponNav",setup(o){const{t:d}=a(),p=()=>{c({url:"/pages/search/index",param:{redirectPath:"/pages/groupon/mylist",searchHistoryKey:"mygrouponSerchHistory",navbarTitle:d("搜索我的拼团"),placeholder:d("点击搜索"),isSwitchTab:!0}})};return(o,a)=>{const c=u,d=i,g=e(t("tig-navbar"),N);return r(),l(c,{class:"groupon-nav"},{default:s(()=>[n(g,{title:o.$t("我的拼团")},{right:s(()=>[n(c,{class:"groupon-nav__rigth-icon"},{default:s(()=>[n(c,{class:"click-placehoder",onClick:p}),n(d,{class:"iconfont-h5 icon-sousuo"})]),_:1})]),_:1},8,["title"])]),_:1})}}}),[["__scopeId","data-v-dda285c5"]]),B=d(o({__name:"mylist",setup(o){const d=p(0),N=p(1),B=p(!1),{t:F}=a(),Y=g(),E=m([{type:1,value:F("我发起的团"),num:0},{type:2,value:F("我参与的团"),num:0}]),J={page:1,size:10,joinType:N.value,isMine:!0,keyword:""},X=p(0),q=p({productId:0,productStock:0}),D=p("0"),O=p(0),Q=p(0),{data:Z,getList:oo,isLoadMore:ao,isLoading:eo,total:to}=M(K,{params:J,path:{dataKey:"records"},needReachBottom:!0,immediate:!0}),lo=o=>{c({url:`/pages/product/groupBuying?grouponPromotionRecordId=${o}`})},ro=o=>{N.value=o.type,J.page=1,J.joinType=N.value,oo()};return f(o=>{(null==o?void 0:o.keyWords)&&(J.keyword=o.keyWords,oo())}),(o,a)=>{const c=e(t("up-tabs"),_),p=u,g=e(t("tig-image"),V),m=i,f=e(t("format-price"),w),N=e(t("tig-button"),T),K=e(t("up-empty"),y),M=e(t("loading-box"),z),F=e(t("tig-loadingpage"),L),oo=e(t("tig-layout"),A);return r(),l(oo,null,{default:s(()=>[n(W),n(p,{class:"groupon"},{default:s(()=>[n(p,{class:"groupon-menu"},{default:s(()=>[n(p,{class:"order-menu badgecolor"},{default:s(()=>[n(c,{current:d.value,"onUpdate:current":a[0]||(a[0]=o=>d.value=o),"line-color":"var(--general)",list:E,"line-width":"50rpx","line-height":"6rpx",style:{fontSize:"28rpx"},"active-style":{padding:"0 10rpx",fontWeight:"bold",color:"#1A1A1A"},"inactive-style":{padding:"0 10rpx"},scrollable:!1,"key-name":"value",onChange:ro},null,8,["current","list"])]),_:1})]),_:1}),n(p,{class:"placeholder"}),n(p,{class:"groupon-list"},{default:s(()=>[(r(!0),h(x,null,j(k(Z),(a,e)=>(r(),l(p,{key:e,class:"groupon-item",onClick:o=>lo(a.grouponPromotionRecordId)},{default:s(()=>[n(p,{class:"groupon-item__wrap"},{default:s(()=>[n(p,{class:"groupon-content"},{default:s(()=>[n(p,{class:"groupon-img-box"},{default:s(()=>[n(g,{class:"groupon-img",src:k(b)(a.picThumb||""),mode:"aspectFill"},null,8,["src"])]),_:2},1024),n(p,{class:"groupon-info"},{default:s(()=>[n(p,{class:"flex flex-column main-info"},{default:s(()=>[n(p,{class:"groupon-tit line2"},{default:s(()=>[I(P(a.productName),1)]),_:2},1024),n(p,{class:"detail-group"},{default:s(()=>[n(m,{class:"btn"},{default:s(()=>[I(P(a.minGroupNum)+P(o.$t("人团")),1)]),_:2},1024),n(m,{class:"num"},{default:s(()=>[I(P(o.$t("已有")+a.joinNumCount+o.$t("人参团")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),n(p,{class:"flex align-end"},{default:s(()=>[n(p,{class:"group-price"},{default:s(()=>[n(m,{class:"price-text"},{default:s(()=>[I(P(o.$t("拼团价"))+":",1)]),_:1}),n(f,{"currency-style":{fontSize:"23rpx"},"price-data":a.grouponPrice},null,8,["price-data"])]),_:2},1024),n(p,{class:"original-price"},{default:s(()=>[n(f,{"font-style":{"text-decoration":"line-through"},"currency-style":{fontSize:"23rpx"},"price-data":a.productPrice},null,8,["price-data"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),n(p,{class:"groupon-footer"},{default:s(()=>[n(p,{class:"groupon-desc"},{default:s(()=>[1===a.joinStatus?(r(),l(p,{key:0,class:"text"},{default:s(()=>[n(m,null,{default:s(()=>[I(P(o.$t("拼团中")),1)]),_:1}),I(" ， "),n(m,null,{default:s(()=>[I(P(o.$t("还差")),1)]),_:1}),n(m,{class:"num"},{default:s(()=>[I(P(a.minGroupNum-a.joinNumCount),1)]),_:2},1024),n(m,null,{default:s(()=>[I(P(o.$t("人")),1)]),_:1})]),_:2},1024)):v("",!0),2===a.joinStatus?(r(),l(p,{key:1},{default:s(()=>[n(m,{class:"text"},{default:s(()=>[I(P(o.$t("拼团成功")),1)]),_:1})]),_:1})):v("",!0),3===a.joinStatus?(r(),l(p,{key:2},{default:s(()=>[n(m,{class:"text"},{default:s(()=>[I(P(o.$t("拼团失败")),1)]),_:1})]),_:1})):v("",!0)]),_:2},1024),n(p,{class:"btns"},{default:s(()=>[1===a.joinStatus?(r(),l(N,{key:0,color:"var(--main-bg)","custom-style":{height:"58rpx"},plain:!0,onClick:o=>(async o=>{if(Y.token)try{const a=await U(o.grouponPromotionRecordId);if(!a)return;const e=await H(a.productId);O.value=a.grouponPromotionId,Q.value=o.grouponPromotionRecordId,X.value=e.item.productId,q.value=e.item,D.value=o.grouponPrice.toString(),B.value=!0}catch(a){R({title:a.message,icon:"none"})}else C({url:"/pages/login/index"})})(a)},{default:s(()=>[I(P(o.$t("邀请好友")),1)]),_:2},1032,["onClick"])):v("",!0),2===a.joinStatus||3===a.joinStatus?(r(),l(N,{key:1,color:"#9A9A9A","custom-style":{height:"58rpx"},plain:!0,onClick:o=>lo(a.grouponPromotionRecordId)},{default:s(()=>[I(P(o.$t("查看详情")),1)]),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),k(eo)||0!==k(to)?v("",!0):(r(),l(p,{key:0,class:"empty-box"},{default:s(()=>[n(K,{icon:k($)("salesman/no_order.png"),text:o.$t("暂无数据")},null,8,["icon","text"])]),_:1})),n(G,{modelValue:B.value,"onUpdate:modelValue":a[1]||(a[1]=o=>B.value=o),"product-id":Number(X.value),"product-info":q.value,grouponPromotionId:O.value,grouponPromotionRecordId:Q.value,"product-price":D.value},null,8,["modelValue","product-id","product-info","grouponPromotionId","grouponPromotionRecordId","product-price"]),n(M,{modelValue:k(ao),"onUpdate:modelValue":a[2]||(a[2]=o=>S(ao)?ao.value=o:null),page:J.page,length:k(Z).length},null,8,["modelValue","page","length"])]),_:1}),n(F,{modelValue:k(eo),"onUpdate:modelValue":a[3]||(a[3]=o=>S(eo)?eo.value=o:null)},null,8,["modelValue"])]),_:1})}}}),[["__scopeId","data-v-068bb898"]]);export{B as default};

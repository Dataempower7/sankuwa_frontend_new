import{d as s,l as a,Y as e,r as t,v as l,s as o,c as n,w as i,i as c,C as r,F as u,b as p,e as d,J as h,a as g,K as m,P as f,aL as v,I as _,G as y,ae as I,h as b,t as T,X as k,_ as w}from"./index-BZxHr1FI.js";import{T as M}from"./tig-layout.DTz8E-sj.js";import{b as x}from"./im.rPUhsNGC.js";const L=w(s({__name:"list",setup(s){const w=a(),L=e({page:1,size:15}),$=t(0),j=t(!1),C=t([]),z=async()=>{try{const s=await x(L);C.value=s.records,$.value=s.total}catch(s){}finally{j.value=!0}};return l(()=>{z()}),o(()=>{L.page<Math.ceil($.value/L.size)&&(L.page++,z())}),(s,a)=>{const e=c,t=r(u("tig-layout"),M);return p(),n(e,{class:"page-content"},{default:i(()=>[d(t,{title:"消息列表"},{default:i(()=>[d(e,{class:"thanos-layout conversation-list-layout"},{default:i(()=>[d(e,{class:"thanos-layout-main-content"},{default:i(()=>[d(e,{class:"thanos-waterfall conversation-list-wrap"},{default:i(()=>[C.value.length>0?(p(!0),h(m,{key:0},f(C.value,(s,a)=>(p(),n(e,{key:a,class:"main-list"},{default:i(()=>[d(e,{class:"wapim-conversation-item",onClick:a=>{return e=`/pages/im/index?shopId=${s.shopId}&conversationId=${s.conversationId}`,void k({url:e});var e}},{default:i(()=>[v("figure",{class:"bg-pic circle-bg-pic thanos-figure thanos-hairline--surround conversation-figure"},[d(e,{class:"bg-pic-content",style:_({backgroundImage:`url(${s.shop?y(I)(s.shop.shopLogo):y(I)(y(w).baseInfo.icoImg)})`})},null,8,["style"])]),d(e,{class:"wapim-conversation-item-content thanos-hairline--bottom"},{default:i(()=>[d(e,{class:"shop-name thanos-ellipsis"},{default:i(()=>[b(T(s.shop?s.shop.shopTitle:y(w).baseInfo.shopTitle),1)]),_:2},1024),"text"==s.lastMessage[0].messageType?(p(),n(e,{key:0,class:"last-message thanos-ellipsis"},{default:i(()=>[d(e,{class:"ellipsis",innerHTML:s.lastMessage[0].content.content},null,8,["innerHTML"])]),_:2},1024)):(p(),n(e,{key:1,class:"last-message thanos-ellipsis"},{default:i(()=>[b("["+T(s.lastMessage[0].messageTypeText)+"]",1)]),_:2},1024))]),_:2},1024),d(e,{class:"wapim-conversation-item-right"},{default:i(()=>[v("span",{class:"last-time"},T(s.lastUpdateTime),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128)):g("",!0),0===C.value.length&&j.value?(p(),n(e,{key:1,class:"thanos-waterfall-finish-desc"},{default:i(()=>[b(T(s.$t("已经没有更多消息了")),1)]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-9ee24e2a"]]);export{L as default};

import{d as e,r as a,U as l,B as t,E as s,c as o,a as c,o as u,i as r,w as d,g as i,f as n,t as p,h as f,V as y,I as m,O as v,J as g,n as h,_,K as b,W as k,k as x,l as I,Q as w,N as C,X as j,Y as z,Z as $,F as N,$ as V,a0 as L,M as S,a1 as U}from"./index-DDAlCzEE.js";import{_ as O}from"./uni-icons.piUs7f0e.js";import{_ as M}from"./empty-box.vue_vue_type_script_setup_true_lang.D8uK6kJt.js";import{_ as P}from"./loading-box.wxL4cJqH.js";import{a as B,b as J,_ as K,c as W}from"./tig-layout.Dp_86RM-.js";import{m as T}from"./masonry.DxHX1gQG.js";import{g as A,a as D,b as E,c as F}from"./search.4ogLimJX.js";import{_ as G}from"./tig-image.CxOKkXKh.js";import{_ as H}from"./format-price.9n-LYbxy.js";import{g as Q}from"./shop.C5j42sN7.js";import{u as R}from"./useList.Bq9WraBG.js";import"./specification.C_n32lme.js";import"./uni-number-box.D352QONN.js";import"./product.CwGVjSIm.js";import"./activityCard.A8E8ZyQf.js";const X=_(e({__name:"shopInfo",props:{keyword:{type:String,default:""},shopId:{type:Number,default:null}},setup(e){const _=e,b=a({});l(()=>_.keyword,e=>{e&&(async()=>{try{const e={keyword:_.keyword,size:1};null!==_.shopId&&(e.shopId=_.shopId);const a=await Q(e);b.value=a.records[0]}catch(e){console.error(e)}})()},{immediate:!0});const k=e=>{e&&h({url:e})};return(e,a)=>{const l=t(s("tig-image"),G),h=r,_=t(s("tig-button"),B),x=f,I=t(s("format-price"),H),w=y;return b.value&&Object.keys(b.value).length>0?(u(),o(h,{key:0,class:"shop-info-box"},{default:d(()=>[i(h,{class:"shop-info"},{default:d(()=>[i(h,{class:"shop-title",onClick:a[1]||(a[1]=e=>k(`/pages/shop/index?shopId=${b.value.shopId}`))},{default:d(()=>[i(h,{class:"shop-logo"},{default:d(()=>[i(l,{src:b.value.shopLogo},null,8,["src"])]),_:1}),i(h,{class:"shop-title-text line1"},{default:d(()=>[n(p(b.value.shopTitle),1)]),_:1}),i(h,{class:"shop-btn"},{default:d(()=>[i(_,{class:"btn",plain:!0,"plain-main-color":!0,onClick:a[0]||(a[0]=e=>k(`/pages/shop/index?shopId=${b.value.shopId}`))},{default:d(()=>[n(p(e.$t("进店")),1)]),_:1})]),_:1})]),_:1}),i(h,{class:"shop-desc"},{default:d(()=>[i(x,{class:"shop-info-text"},{default:d(()=>[n(p(e.$t("上架商品："))+p(b.value.listingCount),1)]),_:1}),i(x,{class:"shop-info-text"},{default:d(()=>[n(p(e.$t("店铺收藏："))+p(b.value.collectCount),1)]),_:1})]),_:1}),i(h,{class:"shop-product"},{default:d(()=>[i(w,{"scroll-x":"true"},{default:d(()=>[i(h,{class:"shop-product-scroll"},{default:d(()=>[(u(!0),m(g,null,v(b.value.listingProduct,e=>(u(),o(h,{key:e.productId,class:"shop-product-image",onClick:a=>k(`/pages/product/index?id=${e.productId}`)},{default:d(()=>[i(l,{src:e.picUrl},null,8,["src"]),i(h,{class:"product-price"},{default:d(()=>[i(I,{"font-style":{fontSize:"24rpx"},"currency-style":{fontSize:"20rpx"},"decimals-style":{fontSize:"22rpx"},"price-data":e.productPrice},null,8,["price-data"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):c("",!0)}}}),[["__scopeId","data-v-58282531"]]),Y=_(e({__name:"result",setup(e){const{t:l}=b(),h=a("商品搜索"),{safeBottom:_}=J(),B=k({page:1,size:10,sort:"",order:"asc",keyword:"",max:"",min:"",cat:0,couponId:0,brand:[],intro:"",pageType:"search"}),G=a([]),H=a([]),Q=a(""),Y=a([]),Z=a([]),q={new:l("新品"),hot:l("热销"),best:l("精品")},ee=a([]),ae=x(()=>Y.value.length>3&&!he.value?Y.value.slice(0,3):Y.value),le=x(()=>Z.value.length>3&&!he.value?Z.value.slice(0,3):Z.value),te=x(()=>B.cat?ee.value:B.shopCategoryId?Z.value:[]),{getList:se,total:oe,data:ce,promotionList:ue,isLoadMore:re,isLoading:de}=R(A,{params:B,path:{dataKey:"records"},needPromotionList:!0}),ie=async()=>{try{B.brand=H.value.join(",");const e=await D({...B});if(G.value=e.filter.brand,Y.value=e.filter.category,Z.value=e.filter.shopCategory,Q.value=e.filterSelected.brand,B.cat){const e=await E(B.cat);ee.value=e}if(B.shopCategoryId){const e=await F(B.shopCategoryId);Z.value=e}}catch(e){w({title:e.message,icon:"none"})}},ne=a("default"),pe=a([{label:"默认",value:"default"},{label:"销量",value:"sale"},{label:"价格",value:"price",order:"desc"}]),fe=e=>{switch(e){case"brand":H.value=[],Q.value="";break;case"price":B.min="",B.max="";break;case"keyword":B.keyword="";break;case"intro":B.intro="";break;case"couponInfo":ge.value={},B.couponId=0}ie(),xe(),se(()=>({brand:H.value.join(",")}))},ye=a(!1),me=()=>{ye.value=!0},ve=()=>{U({url:"/pages/search/index?shopId="+B.shopId})},ge=a({});I(e=>{console.log(e,"123123"),e&&(e.keyWords&&(B.keyword=e.keyWords),e.intro&&(B.intro=e.intro),e.categoryId&&(B.cat=e.categoryId),e.brandId&&H.value.push(e.brandId),e.shopId&&(B.shopId=e.shopId,h.value="店铺商品搜索"),e.shopCategoryId&&(B.shopCategoryId=e.shopCategoryId),e.couponInfo&&(ge.value=JSON.parse(decodeURIComponent(e.couponInfo)),B.couponId=ge.value.couponId)),ie(),se(()=>({brand:H.value.join(",")}))});const he=a(!1),_e=a(!1),be=()=>{Number(B.min)>Number(B.max)?w({title:l("最低价不能大于最高价"),icon:"none"}):(ie(),ye.value=!1,xe(),se(()=>({brand:H.value.join(",")})))},ke=()=>{B.min="",B.max="",H.value=[],B.cat=0},xe=()=>{oe.value=0,B.page=1,B.intro="",ce.value=[],ue.value={}};return(e,a)=>{const l=t(s("uni-icons"),O),b=r,k=f,x=t(s("empty-box"),M),I=t(s("loading-box"),P),w=S,U=y,J=t(s("tig-popup"),W),A=t(s("tig-layout"),K);return u(),o(A,{title:h.value,"shop-id":B.shopId,"shop-category-id":B.shopCategoryId},{default:d(()=>[i(b,{class:"pageMain productSort"},{default:d(()=>[i(b,{class:"header acea-row row-center-wrapper"},{default:d(()=>[i(b,{class:"acea-row row-between-wrapper input",onClick:C(ve,["stop"])},{default:d(()=>[i(l,{type:"search",size:"18",class:"sousuo"}),i(b,{class:"txt"},{default:d(()=>[n(p(e.$t("请输入搜索内容")),1)]),_:1})]),_:1})]),_:1}),i(b,{class:"tab-box flex align-center justify-between"},{default:d(()=>[(u(!0),m(g,null,v(pe.value,a=>(u(),o(b,{key:a.value,class:j(["item flex align-center",{active:ne.value===a.value}]),onClick:e=>(e=>{"price"==e.value?e.order="desc"===e.order?"asc":"desc":e.order="",ne.value=e.value,B.sort=e.value,B.order=e.order,ie(),xe(),se(()=>B.brand=H.value.join(","))})(a)},{default:d(()=>[i(k,null,{default:d(()=>[n(p(e.$t(a.label)),1)]),_:2},1024),z(i(b,{class:"price-ico-box flex flex-column"},{default:d(()=>[i(l,{type:"up",size:"8",class:j({order:"price"===ne.value&&"asc"===a.order})},null,8,["class"]),i(l,{type:"down",size:"8",class:j({order:"price"===ne.value&&"desc"===a.order})},null,8,["class"])]),_:2},1536),[[$,"price"===a.value]])]),_:2},1032,["class","onClick"]))),128)),i(b,{class:"item flex",onClick:me},{default:d(()=>[i(k,null,{default:d(()=>[n(p(e.$t("筛选")),1)]),_:1}),i(l,{type:"right",size:"12",class:"sanjiaoright"})]),_:1})]),_:1}),i(b,{class:"tag-row"},{default:d(()=>[i(b,{class:"tag-list flex-wrap align-center"},{default:d(()=>[B.keyword?(u(),o(b,{key:0,class:"tag-item mr10 line1",onClick:a[0]||(a[0]=e=>fe("keyword"))},{default:d(()=>[i(k,{class:"line1"},{default:d(()=>[n(p(e.$t("搜索关键词"))+'"'+p(B.keyword)+'"',1)]),_:1}),i(l,{type:"closeempty",size:"10"})]),_:1})):c("",!0),B.intro?(u(),o(b,{key:1,class:"tag-item mr10",onClick:a[1]||(a[1]=e=>fe("intro"))},{default:d(()=>[i(k,null,{default:d(()=>[n(p(q[B.intro]),1)]),_:1}),i(l,{type:"closeempty",size:"10"})]),_:1})):c("",!0),ge.value&&ge.value.couponName?(u(),o(b,{key:2,class:"tag-item mr10",onClick:a[2]||(a[2]=e=>fe("coupon_info"))},{default:d(()=>[i(k,null,{default:d(()=>[n(p(e.$t("优惠券"))+': "'+p(ge.value.couponName)+'"',1)]),_:1}),i(l,{type:"closeempty",size:"10"})]),_:1})):c("",!0),Q.value?(u(),o(b,{key:3,class:"tag-item mr10 brand",onClick:a[3]||(a[3]=e=>fe("brand"))},{default:d(()=>[i(k,null,{default:d(()=>[n(p(Q.value),1)]),_:1}),i(l,{type:"closeempty",size:"10"})]),_:1})):c("",!0),B.max||B.min?(u(),o(b,{key:4,class:"tag-item mr10",onClick:a[4]||(a[4]=e=>fe("price"))},{default:d(()=>[i(k,null,{default:d(()=>[n(p(B.min||0)+" - "+p(B.max||0),1)]),_:1}),i(l,{type:"closeempty",size:"10"})]),_:1})):c("",!0),te.value.length>0?(u(!0),m(g,{key:5},v(te.value,(e,a)=>(u(),o(b,{key:a,class:"flex align-center",onClick:e=>(e=>{e>0?B.shopCategoryId?B.shopCategoryId=Z.value[e-1].categoryId:B.cat=ee.value[e-1].categoryId:B.shopCategoryId?B.shopCategoryId=0:B.cat=0,ie(),xe(),se(()=>({brand:H.value.join(",")}))})(a)},{default:d(()=>[i(b,{class:"tag-item"},{default:d(()=>[i(k,null,{default:d(()=>[n(p(e.categoryName),1)]),_:2},1024),i(l,{type:"closeempty",size:"10"})]),_:2},1024),a<te.value.length-1?(u(),o(b,{key:0,class:"tag-interval"},{default:d(()=>[i(l,{type:"right",size:"10"})]),_:1})):c("",!0)]),_:2},1032,["onClick"]))),128)):c("",!0)]),_:1})]),_:1}),N(V)()&&B.keyword?(u(),o(X,{key:0,keyword:B.keyword,"shop-id":B.shopId},null,8,["keyword","shop-id"])):c("",!0),!N(de)&&N(oe)>0?(u(),o(b,{key:1,class:"goods-container"},{default:d(()=>[i(T,{"commodity-list":N(ce),"promotion-list":N(ue)},null,8,["commodity-list","promotion-list"])]),_:1})):c("",!0),N(de)||0!==N(oe)?c("",!0):(u(),o(x,{key:2,mode:"search",background:"#f5f5f5"})),i(I,{modelValue:N(re),"onUpdate:modelValue":a[5]||(a[5]=e=>L(re)?re.value=e:null),page:B.page,length:N(ce).length},null,8,["modelValue","page","length"]),i(J,{show:ye.value,"onUpdate:show":a[10]||(a[10]=e=>ye.value=e),position:"right","z-index":900,"show-close":!1},{default:d(()=>[i(U,{"scroll-y":"true",class:"search_condition"},{default:d(()=>[i(b,{class:"search_condition-box"},{default:d(()=>[Y.value.length>0?(u(),o(b,{key:0,class:"tab_box"},{default:d(()=>[i(b,{class:"title-box flex justify-between"},{default:d(()=>[i(b,{class:"txt"},{default:d(()=>[n(p(e.$t("分类")),1)]),_:1}),i(b,{class:"more",onClick:a[6]||(a[6]=e=>he.value=!he.value)},{default:d(()=>[he.value?(u(),o(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(u(),o(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))]),_:1})]),_:1}),B.shopId?(u(),o(b,{key:0,class:"tabs flex-wrap"},{default:d(()=>[(u(!0),m(g,null,v(le.value,(e,a)=>(u(),o(b,{key:a,class:j(["item",{active:B.shopCategoryId==e.categoryId}]),onClick:a=>B.shopCategoryId=e.categoryId},{default:d(()=>[B.shopCategoryId==e.categoryId?(u(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.categoryName),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})):(u(),o(b,{key:1,class:"tabs flex-wrap"},{default:d(()=>[(u(!0),m(g,null,v(ae.value,(e,a)=>(u(),o(b,{key:a,class:j(["item",{active:B.cat==e.categoryId}]),onClick:a=>B.cat=e.categoryId},{default:d(()=>[B.cat==e.categoryId?(u(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.categoryName),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}))]),_:1})):c("",!0),G.value.length>0?(u(),o(b,{key:1,class:"tab_box"},{default:d(()=>[i(b,{class:"title-box flex justify-between"},{default:d(()=>[i(b,{class:"txt"},{default:d(()=>[n(p(e.$t("品牌")),1)]),_:1}),i(b,{class:"more",onClick:a[7]||(a[7]=e=>_e.value=!_e.value)},{default:d(()=>[_e.value?(u(),o(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(u(),o(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))]),_:1})]),_:1}),i(b,{class:"tabs flex-wrap"},{default:d(()=>[(u(!0),m(g,null,v(_e.value?G.value:G.value.slice(0,3),(e,a)=>(u(),o(b,{key:a,class:j(["item",{active:H.value.includes(e.brandId)}]),onClick:a=>(e=>{let a=H.value.indexOf(e.brandId);-1!==a?H.value.splice(a,1):H.value.push(e.brandId)})(e)},{default:d(()=>[H.value.includes(e.brandId)?(u(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.brandName),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})):c("",!0),i(b,{class:"tab_box"},{default:d(()=>[i(b,{class:"title-box flex justify-between"},{default:d(()=>[i(b,{class:"txt"},{default:d(()=>[n(p(e.$t("价格")),1)]),_:1})]),_:1}),i(b,{class:"tabs flex justify-between align-center"},{default:d(()=>[i(w,{modelValue:B.min,"onUpdate:modelValue":a[8]||(a[8]=e=>B.min=e),class:"uni-input",type:"number",placeholder:e.$t("最低价")},null,8,["modelValue","placeholder"]),i(b,{class:"xian"}),i(w,{modelValue:B.max,"onUpdate:modelValue":a[9]||(a[9]=e=>B.max=e),class:"uni-input",type:"number",placeholder:e.$t("最高价")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1}),i(b,{class:j(["btn-box",{"safe-btn":N(_)>0}])},{default:d(()=>[i(b,{class:"flex btn-flex"},{default:d(()=>[i(b,{class:"btn",onClick:ke},{default:d(()=>[n(p(e.$t("重置")),1)]),_:1}),i(b,{class:"btn submit",onClick:be},{default:d(()=>[n(p(e.$t("确定")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["title","shop-id","shop-category-id"])}}}),[["__scopeId","data-v-80dbc90d"]]);export{Y as default};

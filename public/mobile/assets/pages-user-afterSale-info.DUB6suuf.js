import{d as e,L as a,n as t,r as l,v as s,an as u,p as r,ao as c,R as f,m as n,c as i,w as o,i as d,C as _,F as p,b as m,e as v,J as g,a as b,K as h,h as y,t as $,P as k,ag as I,a3 as x,X as S,_ as j}from"./index-BZxHr1FI.js";import{_ as C}from"./uni-steps.lpUKa4MB.js";import{_ as N}from"./uni-icons.DMMn2oBg.js";import{_ as w}from"./tig-image.CzXKqALH.js";import{_ as T}from"./format-price.BrXrBVy6.js";import{a as B,T as z}from"./tig-layout.DTz8E-sj.js";import{T as O}from"./tig-fixed-placeholder.BDsbIjoZ.js";import{b as A,d as G}from"./afterSale.Bc08-95K.js";import"./currency.Dn5A4d7X.js";const R=j(e({__name:"info",setup(e){const{t:j}=a();t(e=>{e&&e.id&&(R.value=Number(e.id),W())}),s(()=>{u("refreshInfo",e=>{R.value=e,W()})}),r(()=>{c("refreshInfo")});const R=l(),E=l({}),K=l(0),W=async()=>{try{const e=await A(R.value);E.value=e,E.value.aftersalesItems.forEach(e=>{K.value+=e.number})}catch(e){console.error(e),f({title:e.message,icon:"none"})}},q=()=>{I({title:j("提示"),content:j("确认要撤销申请吗？"),success:async e=>{if(e.confirm)try{await G({aftersaleId:E.value.aftersaleId});f({title:j("撤销成功")}),x({url:"/pages/user/afterSale/list"})}catch(a){console.error(a)}}})},F=async()=>{try{1===E.value.aftersalesItems.length?x({url:`/pages/user/afterSale/edit?aftersaleId=${E.value.aftersaleId}&itemId=${E.value.aftersalesItems[0].orderItemId}`}):x({url:`/pages/user/afterSale/edit?aftersaleId=${E.value.aftersaleId}`})}catch(e){console.error(e)}},J=l(!0),L=n(()=>E.value.returnGoodsTip&&J.value),M=()=>{S({url:"/pages/user/afterSale/negotiate?id="+E.value.aftersaleId})},P=()=>{S({url:`/pages/user/afterSale/shipments?id=${E.value.aftersaleId}&returnAddress=${E.value.returnAddress}`})};return(e,a)=>{const t=d,l=_(p("uni-steps"),C),s=_(p("uni-icons"),N),u=_(p("tig-image"),w),r=_(p("format-price"),T),c=_(p("tig-button"),B),f=_(p("tig-fixed-placeholder"),O),n=_(p("tig-layout"),z);return m(),i(t,{class:"after-sale-info"},{default:o(()=>[v(n,{"need-safe-top":!0},{default:o(()=>[Object.keys(E.value).length?(m(),g(h,{key:0},[L.value?(m(),i(t,{key:0,class:"returngoodstip-box"},{default:o(()=>[v(t,{class:"returngoodstip-bg"}),v(t,{class:"returngoodstip-content"},{default:o(()=>[v(t,{class:"iconfont-h5 icon-tongzhi"}),v(t,{class:"returngoodstip-text line1"},{default:o(()=>[y($(E.value.returnGoodsTip),1)]),_:1}),v(t,{class:"iconfont-h5 icon-chacha",onClick:a[0]||(a[0]=e=>J.value=!1)})]),_:1})]),_:1})):b("",!0),v(t,{class:"after-sal-info-steps"},{default:o(()=>[v(l,{"active-color":"var(--general)",options:E.value.stepStatus.steps,active:E.value.stepStatus.current},null,8,["options","active"])]),_:1}),3===E.value.status?(m(),i(t,{key:1,class:"refuse-reply"},{default:o(()=>[v(t,{class:"refuse-reply-title"},{default:o(()=>[y($(e.$t("拒绝原因"))+": ",1)]),_:1}),v(t,{class:"refuse-reply-content line1"},{default:o(()=>[y($(E.value.reply),1)]),_:1})]),_:1})):b("",!0),v(t,{class:"negotiate",onClick:M},{default:o(()=>[v(t,{class:"negotiate-text"},{default:o(()=>[y($(e.$t("查看协商记录")),1)]),_:1}),v(t,{class:"negotiate-icon"},{default:o(()=>[v(s,{type:"right",size:"20",color:"#999"})]),_:1})]),_:1}),4===E.value.status?(m(),i(t,{key:2,class:"negotiate",onClick:P},{default:o(()=>[v(t,{class:"negotiate-text"},{default:o(()=>[y($(e.$t("去寄货")),1)]),_:1}),v(t,{class:"negotiate-icon"},{default:o(()=>[v(s,{type:"right",size:"20",color:"#999"})]),_:1})]),_:1})):b("",!0),v(t,{class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[y($(e.$t("售后信息")),1)]),_:1}),v(t,{class:"info-content-product"},{default:o(()=>[(m(!0),g(h,null,k(E.value.aftersalesItems,e=>(m(),i(t,{key:e.aftersalesItemId,class:"info-content-product-item",onClick:a=>{return t=e.productId,void S({url:`/pages/product/index?id=${t}`});var t}},{default:o(()=>[v(t,{class:"product-item-left"},{default:o(()=>[v(u,{src:e.picThumb},null,8,["src"])]),_:2},1024),v(t,{class:"product-item-right"},{default:o(()=>[v(t,{class:"product-item-name line2"},{default:o(()=>[y($(e.productName),1)]),_:2},1024),v(t,{class:"right-price"},{default:o(()=>[v(r,{"show-text":!1,"decimals-style":{fontSize:"23rpx",fontWeight:"bold"},"currency-style":{fontSize:"21rpx",fontWeight:"bold"},class:"right-price-pricenum","price-data":e.price},null,8,["price-data"]),v(t,{class:"right-price-quantity"},{default:o(()=>[y("x "+$(e.number),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),v(t,{class:"refund-info"},{default:o(()=>[Number(E.value.refundAmount)>0?(m(),i(t,{key:0,class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("退款金额"))+"：",1)]),_:1}),v(t,{class:"value price"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":E.value.refundAmount},null,8,["price-data"])]),_:1})]),_:1})):b("",!0),v(t,{class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("售后方式"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.aftersalesTypeName),1)]),_:1})]),_:1}),v(t,{class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("退款原因"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.aftersaleReason),1)]),_:1})]),_:1})]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("售后编号"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.aftersalesSn),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("申请时间"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.addTime),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("退货数量"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(K.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),E.value.logisticsName&&E.value.trackingNo?(m(),i(t,{key:3,class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[y($(e.$t("退货信息")),1)]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("快递公司"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.logisticsName),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("快递单号"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[y($(E.value.trackingNo),1)]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0),E.value.refund?(m(),i(t,{key:4,class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[y($(e.$t("退款进度")),1)]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[E.value.refund.onlineBalance>0?(m(),i(t,{key:0,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("线上退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":E.value.refund.onlineBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[y($(2===E.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0),E.value.refund.offlineBalance>0?(m(),i(t,{key:1,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("线下退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":E.value.refund.offlineBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[y($(2===E.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0),E.value.refund.refundBalance>0?(m(),i(t,{key:2,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[y($(e.$t("余额退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":E.value.refund.refundBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[y($(2===E.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1})):b("",!0),E.value.canCancel?(m(),i(f,{key:5,height:"100rpx","background-color":"#fff"},{default:o(()=>[v(t,{class:"after-sale-btn"},{default:o(()=>[v(t,{class:"after-sale-btn-box"},{default:o(()=>[v(c,{class:"btn",plain:!0,onClick:q},{default:o(()=>[y($(e.$t("撤销申请")),1)]),_:1}),v(c,{plain:!0,class:"btn",onClick:F},{default:o(()=>[y($(e.$t("修改申请")),1)]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0)],64)):b("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-72b402c8"]]);export{R as default};

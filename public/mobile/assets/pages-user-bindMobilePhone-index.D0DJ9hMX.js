import{a2 as e,d as a,K as o,ay as l,r as t,W as s,k as i,c as d,w as r,B as n,E as u,bF as p,bU as m,bV as b,o as c,g as f,i as h,f as v,t as g,F as _,aj as k,Q as y,L as x,P as V,S as w,_ as C}from"./index-DDAlCzEE.js";import{_ as U,a as z}from"./tig-layout.Dp_86RM-.js";import{V as $,a as D}from"./index.Bw-iif0R.js";const T=C(a({__name:"index",setup(a){const{t:C}=o(),T=l(),j=t(),M=t(),P={mobile:{validator:(e,a,o)=>(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(C("请输入正确的手机号码")),!0),message:C("请输入正确的手机号码!"),trigger:["change","blur"]}},q=t(""),E=t(!0),F=s({mobile:"",mobileCode:"",password:"",openData:{}}),I=t(!1),A=e=>{y({title:e,duration:1500,icon:"none"})},B=i(()=>!(F.mobile&&F.mobileCode&&F.password)),K=async()=>{I.value=!0;try{await j.value.validate(),F.openData=x("openData");const o=await(a=F,e({url:"user/login/bindMobile",method:"post",data:a}));T.setToken(o.token),T.getUserInfo(),T.setAuthType(""),y({title:C("绑定成功"),duration:1500,icon:"success"}),setTimeout(()=>{V("openData",""),w({url:"/pages/user/index"})},1500)}catch(o){console.error(o),1002==o.code&&M.value?M.value.show():o.code>0&&(y({title:o.message,duration:1500,icon:"none"}),q.value="")}finally{I.value=!1}var a},L=e=>{q.value=e.verifyToken,K()};return(e,a)=>{const o=h,l=n(u("up-input"),p),t=n(u("up-form-item"),m),s=n(u("up-form"),b),i=n(u("tig-button"),z),y=n(u("tig-layout"),U);return c(),d(y,{title:"绑定"},{default:r(()=>[f(o,{class:"bindMobilePhone"},{default:r(()=>[f(o,{class:"bindMobilePhone-title"},{default:r(()=>[v(g(e.$t("手机号绑定")),1)]),_:1}),f(s,{ref_key:"formRef",ref:j,"label-position":"left",model:F,rules:P,"error-type":"toast"},{default:r(()=>[f(t,{label:"",prop:"mobile"},{default:r(()=>[f(l,{modelValue:F.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>F.mobile=e),placeholder:e.$t("请输入手机号"),"font-size":"28rpx",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(o,{class:"flex flex1"},{default:r(()=>[f(l,{modelValue:F.mobileCode,"onUpdate:modelValue":a[1]||(a[1]=e=>F.mobileCode=e),placeholder:e.$t("请输入验证码"),"font-size":"28rpx",border:"bottom"},{suffix:r(()=>[]),_:1},8,["modelValue","placeholder"]),f($,{mobile:F.mobile,"onUpdate:mobile":a[2]||(a[2]=e=>F.mobile=e),"is-checked":E.value,"onUpdate:isChecked":a[3]||(a[3]=e=>E.value=e),"verify-token-data":q.value,"onUpdate:verifyTokenData":a[4]||(a[4]=e=>q.value=e),style:{height:"65rpx","margin-left":"15rpx"},"request-api":_(k),onMobileErrorCallback:A},null,8,["mobile","is-checked","verify-token-data","request-api"])]),_:1})]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(l,{modelValue:F.password,"onUpdate:modelValue":a[5]||(a[5]=e=>F.password=e),placeholder:e.$t("请输入密码"),"font-size":"28rpx",password:"",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),f(i,{loading:I.value,disabled:B.value,onClick:K},{default:r(()=>[v(g(e.$t("确 认")),1)]),_:1},8,["loading","disabled"])]),_:1}),f(D,{ref_key:"verify",ref:M,mode:"pop","captcha-type":"blockPuzzle","img-size":{width:"310px",height:"155px"},onOkCallback:L},null,512)]),_:1})}}}),[["__scopeId","data-v-db89cae5"]]);export{T as default};

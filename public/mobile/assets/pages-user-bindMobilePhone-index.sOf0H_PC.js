import{a4 as e,d as a,L as o,az as l,r as t,Y as s,m as i,c as d,w as r,C as n,F as u,bJ as p,bX as m,bY as b,b as c,e as f,i as h,h as v,t as g,G as k,ak as _,R as y,M as x,Q as w,j as V,_ as C}from"./index-BZxHr1FI.js";import{T as z,a as U}from"./tig-layout.DTz8E-sj.js";import{V as T,a as $}from"./index.DfptdAaC.js";const D=C(a({__name:"index",setup(a){const{t:C}=o(),D=l(),M=t(),j=t(),P={mobile:{validator:(e,a,o)=>(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(C("请输入正确的手机号码")),!0),message:C("请输入正确的手机号码!"),trigger:["change","blur"]}},q=t(""),G=t(!0),I=s({mobile:"",mobileCode:"",password:"",openData:{}}),R=t(!1),Y=e=>{y({title:e,duration:1500,icon:"none"})},A=i(()=>!(I.mobile&&I.mobileCode&&I.password)),E=async()=>{R.value=!0;try{await M.value.validate(),I.openData=x("openData");const o=await(a=I,e({url:"user/login/bindMobile",method:"post",data:a}));D.setToken(o.token),D.getUserInfo(),D.setAuthType(""),y({title:C("绑定成功"),duration:1500,icon:"success"}),setTimeout(()=>{w("openData",""),V({url:"/pages/user/index"})},1500)}catch(o){console.error(o),1002==o.code&&j.value?j.value.show():o.code>0&&(y({title:o.message,duration:1500,icon:"none"}),q.value="")}finally{R.value=!1}var a},F=e=>{q.value=e.verifyToken,E()};return(e,a)=>{const o=h,l=n(u("up-input"),p),t=n(u("up-form-item"),m),s=n(u("up-form"),b),i=n(u("tig-button"),U),y=n(u("tig-layout"),z);return c(),d(y,{title:"绑定"},{default:r(()=>[f(o,{class:"bindMobilePhone"},{default:r(()=>[f(o,{class:"bindMobilePhone-title"},{default:r(()=>[v(g(e.$t("手机号绑定")),1)]),_:1}),f(s,{ref_key:"formRef",ref:M,"label-position":"left",model:I,rules:P,"error-type":"toast"},{default:r(()=>[f(t,{label:"",prop:"mobile"},{default:r(()=>[f(l,{modelValue:I.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>I.mobile=e),placeholder:e.$t("请输入手机号"),"font-size":"28rpx",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(o,{class:"flex flex1"},{default:r(()=>[f(l,{modelValue:I.mobileCode,"onUpdate:modelValue":a[1]||(a[1]=e=>I.mobileCode=e),placeholder:e.$t("请输入验证码"),"font-size":"28rpx",border:"bottom"},{suffix:r(()=>[]),_:1},8,["modelValue","placeholder"]),f(T,{mobile:I.mobile,"onUpdate:mobile":a[2]||(a[2]=e=>I.mobile=e),"is-checked":G.value,"onUpdate:isChecked":a[3]||(a[3]=e=>G.value=e),"verify-token-data":q.value,"onUpdate:verifyTokenData":a[4]||(a[4]=e=>q.value=e),style:{height:"65rpx","margin-left":"15rpx"},"request-api":k(_),onMobileErrorCallback:Y},null,8,["mobile","is-checked","verify-token-data","request-api"])]),_:1})]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(l,{modelValue:I.password,"onUpdate:modelValue":a[5]||(a[5]=e=>I.password=e),placeholder:e.$t("请输入密码"),"font-size":"28rpx",password:"",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),f(i,{loading:R.value,disabled:A.value,onClick:E},{default:r(()=>[v(g(e.$t("确 认")),1)]),_:1},8,["loading","disabled"])]),_:1}),f($,{ref_key:"verify",ref:j,mode:"pop","captcha-type":"blockPuzzle","img-size":{width:"310px",height:"155px"},onOkCallback:F},null,512)]),_:1})}}}),[["__scopeId","data-v-db89cae5"]]);export{D as default};

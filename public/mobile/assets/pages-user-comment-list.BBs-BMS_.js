import{d as e,L as a,Y as t,r as l,n as s,an as c,s as u,p as n,bf as o,ao as r,c as d,w as i,R as m,ac as f,ad as p,C as _,F as v,b as g,e as y,i as k,a as b,J as h,K as x,P as w,Z as j,k as $,h as C,t as T,a6 as z,G as D,ae as I,f as F,H as N,b5 as P,j as S,X as R,_ as V}from"./index-BZxHr1FI.js";import{_ as q}from"./uni-badge.Bs_WZHCJ.js";import{_ as G}from"./tig-image.CzXKqALH.js";import{_ as K}from"./format-price.BrXrBVy6.js";import{T as M,a as U}from"./tig-layout.DTz8E-sj.js";import{_ as Y}from"./uni-rate.DTPubwzy.js";import{_ as H}from"./loading-box.D3Y7A2lC.js";import{b as J}from"./order.DbsjjJvD.js";import{g as L,a as X,b as Z}from"./comment.CY2bKQa9.js";import"./currency.Dn5A4d7X.js";import"./uni-icons.DMMn2oBg.js";const A=V(e({__name:"list",setup(e){const{t:V}=a(),A=t([{type:0,value:V("待评价"),num:0},{type:1,value:V("待晒单"),num:0},{type:2,value:V("已评价"),num:0}]),B=l(0),E=t({page:1,size:10}),O=l(!1),Q=l([]),W=l(0),ee=async()=>{E.page>1?O.value=!0:f({title:V("加载中")});try{let e=[];0==B.value&&(e=await J({...E,commentStatus:0})),1==B.value&&(e=await X({...E})),2==B.value&&(e=await Z({...E})),Q.value=[...Q.value,...e.records],W.value=e.total}catch(e){m({title:e.message,icon:"none",duration:1e3})}finally{p(),O.value=!1}};return s(e=>{e&&e.currentType&&(B.value=Number(e.currentType)),c("commentFinished",e=>{e&&(B.value=2,Q.value=[],E.page=1,ee())}),(async()=>{try{const e=await L();A[0].size=e.awaitComment,A[1].size=e.showPics,A[2].size=e.commented}catch(e){m({title:e.message,icon:"none",duration:1e3})}})(),ee()}),u(()=>{E.page<Math.ceil(W.value/E.size)&&(E.page++,ee())}),n(()=>{o(),r("commentFinished")}),(e,a)=>{const t=$,l=_(v("uni-badge"),q),s=k,c=_(v("tig-image"),G),u=_(v("format-price"),K),n=z,o=_(v("tig-button"),U),r=_(v("uni-rate"),Y),m=F,f=_(v("loading-box"),H),p=_(v("tig-layout"),M);return g(),d(p,{title:"订单评价"},{default:i(()=>[y(s,{class:"order"},{default:i(()=>[y(s,{class:"order-menu"},{default:i(()=>[(g(!0),h(x,null,w(A,e=>(g(),d(s,{key:e.type,class:j(["order-menu-item",{active:B.value===e.type}]),onClick:a=>{return t=e.type,console.log("type",t),B.value=t,Q.value=[],E.page=1,void ee();var t}},{default:i(()=>[e.num>0?(g(),d(l,{key:0,class:"badgecolor",text:e.num,absolute:"rightTop",size:"small"},{default:i(()=>[y(t,{class:"order-menu-item-text"},{default:i(()=>[C(T(e.value),1)]),_:2},1024)]),_:2},1032,["text"])):(g(),d(t,{key:1,class:"order-menu-item-text"},{default:i(()=>[C(T(e.value),1)]),_:2},1024))]),_:2},1032,["class","onClick"]))),128))]),_:1}),y(s,{class:"placeholder"}),B.value<2?(g(),d(s,{key:0,class:"order-list"},{default:i(()=>[(g(!0),h(x,null,w(Q.value,a=>(g(),d(s,{key:a.orderId,class:"order-list-item"},{default:i(()=>[y(s,{class:"order-list-item-header"},{default:i(()=>[y(t,{class:"special-text"},{default:i(()=>[C(T(e.$t("订单编号"))+"：",1),y(t,{class:"special-color"},{default:i(()=>[C(T(a.orderSn),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),y(s,{class:"order-list-item-content"},{default:i(()=>[y(s,{class:"item-content-product"},{default:i(()=>[(g(!0),h(x,null,w(a.items,e=>(g(),d(n,{key:e.productId,url:"/pages/product/index?id="+e.productId,"hover-class":"navigator-hover"},{default:i(()=>[y(s,{class:"item-content-product-item"},{default:i(()=>[y(s,{class:"item-content-product-img"},{default:i(()=>[y(c,{src:e.picThumb},null,8,["src"])]),_:2},1024),y(s,null,{default:i(()=>[y(s,{class:"item-content-product-info"},{default:i(()=>[y(s,{class:"product-item-title"},{default:i(()=>[C(T(e.productName),1)]),_:2},1024),y(s,{class:"product-item-price"},{default:i(()=>[y(u,{"show-text":!1,"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"},class:"product-item-pricenum","price-data":e.price},null,8,["price-data"]),y(s,{class:"product-item-quantity"},{default:i(()=>[C("x "+T(e.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),y(s,{class:j(["sku-card",{nodata:!e.skuData||0===e.skuData.length}])},{default:i(()=>[e.skuData&&e.skuData.length>0?(g(!0),h(x,{key:0},w(e.skuData,(e,a)=>(g(),d(s,{key:a,class:"sku-item line1"},{default:i(()=>[C(T(e.value),1)]),_:2},1024))),128)):b("",!0)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["url"]))),128))]),_:2},1024)]),_:2},1024),y(s,{class:"order-list-item-btn"},{default:i(()=>[y(s,{class:"item-btn-box"},{default:i(()=>[y(o,{plain:!0,"custom-style":{height:"55rpx"},"plain-main-color":!0,onClick:e=>{return t=a.orderId,void R({url:`/pages/user/comment/info?id=${t}`});var t}},{default:i(()=>[C(T(0==B.value?e.$t("去评价"):e.$t("待晒单")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(g(),d(s,{key:1,class:"comment-list"},{default:i(()=>[(g(!0),h(x,null,w(Q.value,a=>(g(),d(s,{key:a.orderId,class:"comment-item flex"},{default:i(()=>[y(s,{class:"comment-header"},{default:i(()=>[a.picThumb?(g(),d(c,{key:0,class:"head",src:a.picThumb,mode:"aspectFill"},null,8,["src"])):b("",!0)]),_:2},1024),y(s,{class:"comment-info"},{default:i(()=>[y(s,{class:"comment-label flex align-center"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("评价"))+":",1)]),_:1}),y(s,{class:"content flex align-center justify-between"},{default:i(()=>[y(r,{value:a.commentRank,color:"#bfbfbf",readonly:!0,"active-color":"#ffa800",size:"18"},null,8,["value"]),y(s,{class:"time"},{default:i(()=>[C(T(a.addTime),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),y(s,{class:"comment-label flex",onClick:e=>{return t=a.productId,void S({url:`/pages/product/index?id=${t}`});var t}},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("商品名称"))+":",1)]),_:1}),y(s,{class:"content"},{default:i(()=>[y(s,{class:"product-name line1"},{default:i(()=>[C(T(a.productName||"--"),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),a.skuData&&a.skuData.length>0?(g(),d(s,{key:0,class:"comment-label flex"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("商品规格"))+":",1)]),_:1}),y(s,{class:"content flex-wrap"},{default:i(()=>[(g(!0),h(x,null,w(a.skuData,e=>(g(),d(s,{class:"product-tag"},{default:i(()=>[C(T(e.value),1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)):b("",!0),y(s,{class:"comment-label flex"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("评价标签"))+":",1)]),_:1}),y(s,{class:"content flex-wrap"},{default:i(()=>[(g(!0),h(x,null,w(a.commentTag,e=>(g(),d(s,{class:"product-tag"},{default:i(()=>[C(T(e),1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024),y(s,{class:"comment-label flex"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("评价内容"))+":",1)]),_:1}),y(s,{class:"content"},{default:i(()=>[y(s,{class:"cont"},{default:i(()=>[C(T(a.content),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a.reply?(g(),d(s,{key:1,class:"comment-label flex"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("客服答复"))+":",1)]),_:1}),y(s,{class:"content"},{default:i(()=>[y(t,{class:"cont"},{default:i(()=>{var e;return[C(T(null==(e=a.reply)?void 0:e.content),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024)):b("",!0),y(s,{class:"comment-label flex"},{default:i(()=>[y(s,{class:"name"},{default:i(()=>[C(T(e.$t("晒单"))+":",1)]),_:1}),a.showPics.length>0?(g(),d(s,{key:0,class:"content flex-wrap"},{default:i(()=>[(g(!0),h(x,null,w(a.showPics,e=>(g(),d(s,{class:"product-pic"},{default:i(()=>[y(c,{src:e.picThumb,mode:"aspectFill",onClick:a=>{return t=D(I)(e.picUrl),void P({urls:[t]});var t}},null,8,["src","onClick"])]),_:2},1024))),256))]),_:2},1024)):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})),0==Q.value.length?(g(),d(s,{key:2,class:"empty-box"},{default:i(()=>[y(s,{class:"pictrue"},{default:i(()=>[y(m,{src:D(N)("common/data_empty.png")},null,8,["src"])]),_:1}),y(s,{class:"txt"},{default:i(()=>[C(T(e.$t("暂无评价")),1)]),_:1})]),_:1})):b("",!0),y(f,{modelValue:O.value,"onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e),page:E.page,length:Q.value.length},null,8,["modelValue","page","length"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-77ff022b"]]);export{A as default};

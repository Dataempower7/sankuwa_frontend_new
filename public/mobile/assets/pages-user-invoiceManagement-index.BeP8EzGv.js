import{d as e,L as a,r as l,Y as t,aM as s,C as u,F as o,c,b as n,i as r,w as i,e as d,J as p,a as m,P as f,k as v,h as _,t as y,K as b,a6 as g,ac as h,ad as $,X as k,_ as x,m as V,Z as C,R as j,n as I,s as w}from"./index-BZxHr1FI.js";import{a as A,d as M,T as N}from"./tig-layout.DTz8E-sj.js";import{_ as O}from"./tig-image.CzXKqALH.js";import{_ as P}from"./format-price.BrXrBVy6.js";import{_ as S}from"./loading-box.D3Y7A2lC.js";import{b as U}from"./order.DbsjjJvD.js";import{_ as q}from"./empty-box.vue_vue_type_script_setup_true_lang.DDT9sx90.js";import{_ as R}from"./uni-easyinput.DHFPvsdC.js";import{_ as z,a as B}from"./uni-forms.QWcIXEX3.js";import{T as D}from"./tig-fixed-placeholder.BDsbIjoZ.js";import{g as L,u as T,c as J}from"./invoiceManagemen.XWZ-Ks16.js";import"./currency.Dn5A4d7X.js";import"./uni-icons.DMMn2oBg.js";const K=x(e({__name:"invoiceList",setup(e,{expose:x}){const{t:V}=a(),C=l([]),j=t({page:1,size:10,orderStatus:5}),I=l(!1),w=l(0),M=l(!0),N=async()=>{M.value=!0,j.page>1?I.value=!0:h({title:V("加载中")});try{const e=await U(j);C.value=[...C.value,...e.records],w.value=e.total}catch(e){console.error(e)}finally{$(),I.value=!1,M.value=!1}},R=e=>{switch(e){case 0:return V("待审核");case 1:return V("通过");default:return V("失败/作废")}};return s(()=>{N()}),x({__getOrderList:N,filterParams:j,total:w}),(e,a)=>{const l=v,t=r,s=u(o("tig-image"),O),h=u(o("format-price"),P),$=g,x=u(o("tig-button"),A),V=u(o("loading-box"),S);return n(),c(t,{class:""},{default:i(()=>[d(t,{class:"invoice-list"},{default:i(()=>[(n(!0),p(b,null,f(C.value,a=>(n(),c(t,{key:a.orderId,class:"invoice-list-item"},{default:i(()=>[d(t,{class:"invoice-list-item-header"},{default:i(()=>[d(l,{class:"special-text"},{default:i(()=>[_(y(e.$t("订单编号"))+"：",1),d(l,{class:"special-color"},{default:i(()=>[_(y(a.orderSn),1)]),_:2},1024)]),_:2},1024),a.invoiceData?(n(),c(l,{key:0},{default:i(()=>[_(y(R(a.invoiceData.status)),1)]),_:2},1024)):(n(),c(l,{key:1},{default:i(()=>[_(y(e.$t("可申请")),1)]),_:1}))]),_:2},1024),d(t,{class:"invoice-list-item-content"},{default:i(()=>[d(t,{class:"item-content-product"},{default:i(()=>[(n(!0),p(b,null,f(a.items,e=>(n(),c($,{key:e.itemId,url:"/pages/product/index?id="+e.productId,"hover-class":"navigator-hover"},{default:i(()=>[d(t,{class:"item-content-product-item"},{default:i(()=>[d(t,{class:"item-content-product-img"},{default:i(()=>[d(s,{src:e.picThumb},null,8,["src"])]),_:2},1024),d(t,{class:"item-content-product-info"},{default:i(()=>[d(t,{class:"product-item-title"},{default:i(()=>[_(y(e.productName),1)]),_:2},1024),d(t,{class:"product-item-price"},{default:i(()=>[d(h,{"show-text":!1,"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"},class:"product-item-pricenum","price-data":e.price},null,8,["price-data"]),d(t,{class:"product-item-quantity"},{default:i(()=>[_("x "+y(e.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["url"]))),128))]),_:2},1024),d(t,{class:"item-content-pay"},{default:i(()=>[d(t,{class:"item-content-pay-box"},{default:i(()=>[d(t,{class:"pay-item total-money"},{default:i(()=>[_(y(e.$t("总额"))+"：",1),d(h,{"show-text":!1,"is-bottom":!1,"price-data":a.totalAmount},null,8,["price-data"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),d(t,{class:"invoice-list-item-btn"},{default:i(()=>[d(t,{class:"item-btn-box"},{default:i(()=>[a.invoiceData?(n(),c(x,{key:0,"custom-style":{width:"150rpx",height:"60rpx"},plain:!0,"plain-main-color":!0,onClick:e=>((e,a)=>{e.orderSn=a;const l=encodeURIComponent(JSON.stringify(e));k({url:"/pages/user/invoiceManagement/invoiceInfo?invoiceData="+l})})(a.invoiceData,a.orderSn)},{default:i(()=>[_(y(e.$t("查看")),1)]),_:2},1032,["onClick"])):(n(),c(x,{key:1,plain:!0,"custom-style":{width:"150rpx",height:"60rpx"},"plain-main-color":!0,onClick:e=>{return l=a.orderId,void k({url:`/pages/user/invoiceManagement/applyInvoice?orderId=${l}`});var l}},{default:i(()=>[_(y(e.$t("申请")),1)]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),d(V,{modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),page:j.page,length:C.value.length},null,8,["modelValue","page","length"]),M.value||0!==C.value.length?m("",!0):(n(),c(q,{key:0,mode:"list",background:"#f5f5f5",text:e.$t("暂无申请")},null,8,["text"]))]),_:1})]),_:1})}}}),[["__scopeId","data-v-8fab88e2"]]),X=x(e({__name:"certification",setup(e){const{t:t}=a(),f=l({}),g={companyName:{rules:[{required:!0,errorMessage:t("单位名称不能为空!")}]},companyCode:{rules:[{required:!0,errorMessage:t("纳税人识别码不能为空!")}]},companyAddress:{rules:[{required:!0,errorMessage:t("注册地址不能为空!")}]},companyPhone:{rules:[{required:!0,errorMessage:t("注册电话不能为空!")}]},companyBank:{rules:[{required:!0,errorMessage:t("开户银行不能为空!")}]},companyAccount:{rules:[{required:!0,errorMessage:t("银行账户不能为空!")}]}},h=l(!1),$=l(!1),k=l({}),x=async()=>{try{const e=await L();Object.assign(f.value,e)}catch(e){}};s(()=>{x()});const I=()=>{k.value=JSON.parse(JSON.stringify(f.value)),$.value=!0},w=V(()=>{switch(f.value.status){case 0:return t("未申请专用发票");case 1:return t("审核通过");case 2:return t("已申请，待审核");case 3:return t("审核未通过");default:return""}}),N=l(),O=()=>{N.value.validate().then(e=>{if(!h.value)return j({title:t("需要确认勾选才能继续"),icon:"none"});P()}).catch(e=>{console.log("表单错误信息：",e)})},P=async()=>{try{k.value.isConfirm=h.value?1:0,k.value.titleType=2,k.value.invoiceType=1,k.value.isAdd=0==k.value.status?1:0,k.value.invoiceId?await T({id:k.value.invoiceId,...k.value}):await J(k.value),j({title:t("提交成功"),icon:"none"}),x(),$.value=!1}catch(e){}},S=()=>{};return(e,a)=>{const l=r,t=v,s=u(o("uni-easyinput"),R),x=u(o("uni-forms-item"),z),V=u(o("uni-forms"),B),j=u(o("tig-checkbox"),M),P=u(o("tig-button"),A),U=u(o("tig-fixed-placeholder"),D);return Object.keys(f.value).length>0?(n(),c(l,{key:0,class:"certification safe-padding"},{default:i(()=>[d(l,{class:"tip-box"},{default:i(()=>[d(l,{class:"tig-title"},{default:i(()=>[_(y(e.$t("温馨提示")),1)]),_:1}),d(l,null,{default:i(()=>[_(y(e.$t("首次开具增值税专用发票"))+"，"+y(e.$t("请添加资质后并提交"))+"。",1)]),_:1}),d(l,null,{default:i(()=>[_(y(e.$t("我们会在一个工作日内完成审核工作"))+"。",1)]),_:1}),d(l,null,{default:i(()=>[_(" 1."+y(e.$t("补发流程"))+"： ",1),d(t,{class:"specaial-text"},{default:i(()=>[_(y(e.$t("资质未审核通过"))+"-"+y(e.$t("登录会员中心"))+"->"+y(e.$t("增票资质"))+"->"+y(e.$t("填写资质信息"))+"->"+y(e.$t("提交"))+"。",1)]),_:1})]),_:1}),d(l,null,{default:i(()=>[_(" 2. "+y(e.$t("资质审核结果查询时间"))+"：",1),d(t,{class:"specaial-text"},{default:i(()=>[_(y(e.$t("资质上传一到两个工作日后即可查询"))+"。",1)]),_:1})]),_:1}),d(l,null,{default:i(()=>[_(" 3. "+y(e.$t("注意有效增值税专用发票开票资质仅为一个"))+"。",1)]),_:1})]),_:1}),d(l,{class:"status-box"},{default:i(()=>[d(l,{class:"status-text"},{default:i(()=>[d(l,null,{default:i(()=>[_(y(e.$t("您的增票资质状态"))+"：",1)]),_:1}),d(l,{class:"specaial-text"},{default:i(()=>[_(y(w.value),1)]),_:1})]),_:1})]),_:1}),d(l,{class:"certification-content"},{default:i(()=>[$.value?(n(),c(l,{key:0,class:"content-title"},{default:i(()=>[_(y(e.$t("填写增票资质信息")),1),d(t,{class:"specaial-text"},{default:i(()=>[_("（"+y(e.$t("所有信息均为必填"))+"）",1)]),_:1})]),_:1})):!$.value&&Object.keys(f.value).length>0?(n(),c(l,{key:1,class:"content-title"},{default:i(()=>[_(y(e.$t("增票资质信息")),1)]),_:1})):m("",!0),d(l,null,{default:i(()=>[$.value?(n(),p(b,{key:0},[d(V,{ref_key:"formRef",ref:N,"model-value":k.value,rules:g,"label-width":"180rpx"},{default:i(()=>[d(x,{label:e.$t("单位名称"),name:"companyName"},{default:i(()=>[d(s,{modelValue:k.value.companyName,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value.companyName=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入单位名称")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(x,{label:e.$t("纳税人识别码"),name:"companyCode"},{default:i(()=>[d(s,{modelValue:k.value.companyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value.companyCode=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入纳税人识别码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(x,{label:e.$t("注册地址"),name:"companyAddress"},{default:i(()=>[d(s,{modelValue:k.value.companyAddress,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value.companyAddress=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入注册地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(x,{label:e.$t("注册电话"),name:"companyPhone"},{default:i(()=>[d(s,{modelValue:k.value.companyPhone,"onUpdate:modelValue":a[3]||(a[3]=e=>k.value.companyPhone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入注册电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(x,{label:"开户银行",name:"companyBank"},{default:i(()=>[d(s,{modelValue:k.value.companyBank,"onUpdate:modelValue":a[4]||(a[4]=e=>k.value.companyBank=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入开户银行")},null,8,["modelValue","placeholder"])]),_:1}),d(x,{label:e.$t("开户银行"),name:"companyAccount"},{default:i(()=>[d(s,{modelValue:k.value.companyAccount,"onUpdate:modelValue":a[5]||(a[5]=e=>k.value.companyAccount=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入银行账户")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model-value"]),d(l,{class:"agreement-box"},{default:i(()=>[d(j,{checked:h.value,"onUpdate:checked":a[6]||(a[6]=e=>h.value=e),"checked-size":.7},null,8,["checked"]),_(" "+y(e.$t("我已阅读并同意")),1),d(t,{class:"specaial-text",onClick:S},{default:i(()=>[_("《"+y(e.$t("增票资质确认书"))+"》",1)]),_:1})]),_:1})],64)):m("",!0),0!==f.value.status||$.value?!$.value&&Object.keys(f.value).length>0?(n(),c(V,{key:2,ref_key:"formRef",ref:N,class:C({readonly:!$.value}),"model-value":f.value,rules:g,"label-width":"180rpx"},{default:i(()=>[d(x,{label:e.$t("单位名称")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyName),1)]),_:1})]),_:1},8,["label"]),d(x,{label:e.$t("纳税人识别码")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyCode),1)]),_:1})]),_:1},8,["label"]),d(x,{label:e.$t("注册地址")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyAddress),1)]),_:1})]),_:1},8,["label"]),d(x,{label:e.$t("注册电话")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyPhone),1)]),_:1})]),_:1},8,["label"]),d(x,{label:e.$t("开户银行")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyBank),1)]),_:1})]),_:1},8,["label"]),d(x,{label:e.$t("银行账户")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[_(y(f.value.companyAccount),1)]),_:1})]),_:1},8,["label"])]),_:1},8,["class","model-value"])):m("",!0):(n(),c(l,{key:1,class:"empty-text"},{default:i(()=>[_(y(e.$t("暂无增票资质信息"))+"!",1)]),_:1}))]),_:1})]),_:1}),$.value?(n(),c(U,{key:0,"background-color":"#fff"},{default:i(()=>[d(l,{class:"btn-box"},{default:i(()=>[d(P,{class:"btn",plain:"",onClick:a[7]||(a[7]=e=>$.value=!1)},{default:i(()=>[_(y(e.$t("取消")),1)]),_:1}),d(P,{class:"btn",onClick:O},{default:i(()=>[_(y(e.$t("提交")),1)]),_:1})]),_:1})]),_:1})):(n(),c(U,{key:1,"background-color":"#fff"},{default:i(()=>[d(l,{class:"btn-box"},{default:i(()=>[d(P,{onClick:I},{default:i(()=>[_(y(0===f.value.status?e.$t("添加增票资质"):e.$t("修改并重新审核")),1)]),_:1})]),_:1})]),_:1}))]),_:1})):m("",!0)}}}),[["__scopeId","data-v-9edc59da"]]),Y=x(e({__name:"index",setup(e){const a=[{type:"list",value:"发票申请"},{type:"invoice",value:"增票资质"}],t=l(),s=l("list");return I(e=>{e&&e.type&&(s.value=e.type)}),w(()=>{"list"===s.value&&t.value.filterParams.page<Math.ceil(t.value.total/t.value.filterParams.size)&&(t.value.filterParams.page++,t.value.__getOrderList())}),(e,l)=>{const g=v,h=r,$=u(o("tig-layout"),N);return n(),c($,{title:"发票管理"},{default:i(()=>[d(h,{class:"invoice-management"},{default:i(()=>[d(h,{class:"invoice-menu"},{default:i(()=>[(n(),p(b,null,f(a,a=>d(h,{key:a.type,class:C(["invoice-menu-item",{active:s.value===a.type}]),onClick:e=>{return l=a.type,void(s.value=l);var l}},{default:i(()=>[d(g,{class:"invoice-menu-item-text"},{default:i(()=>[_(y(e.$t(a.value)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1}),d(h,{class:"placeholder"}),d(h,{class:"invoice-content"},{default:i(()=>["list"===s.value?(n(),c(K,{key:0,ref_key:"invoiceListRef",ref:t},null,512)):m("",!0),"invoice"===s.value?(n(),c(X,{key:1})):m("",!0)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-2b414249"]]);export{Y as default};

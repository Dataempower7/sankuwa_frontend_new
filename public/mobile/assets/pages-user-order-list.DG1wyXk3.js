import{d as a,L as t,Y as e,r as s,n as l,c as o,w as r,C as i,F as n,aA as u,b as c,e as d,i as p,a as m,J as y,K as f,P as g,G as _,k as v,O as k,h as x,t as h,I as b,a6 as I,Z as C,a2 as w,ag as S,R as $,j,X as D,a3 as A,_ as T}from"./index-BZxHr1FI.js";import{_ as P}from"./tig-image.CzXKqALH.js";import{_ as V}from"./format-price.BrXrBVy6.js";import{T as N,a as R}from"./tig-layout.DTz8E-sj.js";import{_ as Y}from"./loading-box.D3Y7A2lC.js";import{_ as L}from"./tig-loadingpage.vue_vue_type_script_setup_true_lang.CErZUb08.js";import{_ as M}from"./empty-box.vue_vue_type_script_setup_true_lang.DDT9sx90.js";import{b as q,c as z,d as G,o as K,e as O}from"./order.DbsjjJvD.js";import{u as U}from"./useList.cF42RyDa.js";import{d as H}from"./groupon.CM2aLW4Q.js";import{d as X}from"./dayjs.min.BETqfnlQ.js";import"./currency.Dn5A4d7X.js";import"./product.BH5dMQls.js";const F=T(a({__name:"list",setup(a){const{t:T}=t(),F=e([{type:"all",value:T("全部订单"),badge:{value:0}},{type:"awaitPay",value:T("待支付"),badge:{value:0}},{type:"awaitShipping",value:T("待发货"),badge:{value:0}},{type:"awaitReceived",value:T("待收货"),badge:{value:0}},{type:"awaitComment",value:T("待评价"),badge:{value:0}}]),J=s("all"),W=e({page:1,size:10,orderStatus:-1,commentStatus:-1}),Z=s(0),B=a=>{J.value!==a.type&&(J.value=a.type,W.page=1,Q.value=[],"awaitComment"===a.type?(W.commentStatus=0,W.orderStatus=-1):(W.orderStatus=sa(a.type),W.commentStatus=-1),E())},{getList:E,data:Q,isLoadMore:aa,isLoading:ta,total:ea}=U(q,{params:W,path:{dataKey:"records"}}),sa=a=>{switch(a){case"all":default:return-1;case"awaitPay":return 0;case"awaitShipping":return 1;case"awaitReceived":return 2}};return l(a=>{a&&a.type&&(Z.value=F.findIndex(t=>t.type===a.type),"awaitComment"===a.type?W.commentStatus=0:W.orderStatus=sa(a.type),J.value=a.type),E()}),(a,t)=>{const e=i(n("up-tabs"),u),s=p,l=v,q=i(n("tig-image"),P),U=i(n("format-price"),V),J=I,sa=i(n("tig-button"),R),la=i(n("loading-box"),Y),oa=i(n("tig-loadingpage"),L),ra=i(n("tig-layout"),N);return c(),o(ra,{title:"我的订单"},{default:r(()=>[d(s,{class:"order"},{default:r(()=>[d(s,{class:"order-menu badgecolor"},{default:r(()=>[d(e,{current:Z.value,"onUpdate:current":t[0]||(t[0]=a=>Z.value=a),"line-color":"var(--general)",list:F,"active-style":{padding:"0 10rpx"},"inactive-style":{padding:"0 10rpx"},scrollable:!0,"key-name":"value",onChange:B},null,8,["current","list"])]),_:1}),d(s,{class:"placeholder"}),d(s,{class:"order-list"},{default:r(()=>[(c(!0),y(f,null,g(_(Q),t=>(c(),o(s,{key:t.orderId,class:"order-list-item"},{default:r(()=>[d(s,{class:"order-list-item-header"},{default:r(()=>{return[t.shop?(c(),o(l,{key:0,class:"special-text",onClick:k(a=>{var e,s;return s=null==(e=t.shop)?void 0:e.shopId,void D({url:`/pages/shop/index?shopId=${s}`})},["stop"])},{default:r(()=>{var a;return[d(l,{class:"iconfont icon-dianpu"}),x(" "+h(null==(a=t.shop)?void 0:a.shopTitle)+" ",1),d(l,{class:"iconfont icon-xiangyou"})]}),_:2},1032,["onClick"])):(c(),o(l,{key:1,class:"order-special-text"},{default:r(()=>[x(h(a.$t("订单编号"))+"：",1),d(l,{class:"special-color"},{default:r(()=>[x(h(t.orderSn),1)]),_:2},1024)]),_:2},1024)),t.grouponPromotionRecordId?(c(),o(l,{key:2,style:b((e=t.orderStatus,s=t.joinStatus,1===e&&1===s?{color:"var(--general)"}:{}))},{default:r(()=>[x(h(t.orderStatusName),1)]),_:2},1032,["style"])):(c(),o(l,{key:3},{default:r(()=>[x(h(t.orderStatusName),1)]),_:2},1024))];var e,s}),_:2},1024),d(s,{class:"order-list-item-content"},{default:r(()=>[d(s,{class:"item-content-text"},{default:r(()=>[d(s,null,{default:r(()=>[x(h(a.$t("收件人"))+"："+h(t.consignee),1)]),_:2},1024),d(s,{class:"special-color"},{default:r(()=>[x(h(t.addTime),1)]),_:2},1024)]),_:2},1024),d(s,{class:"item-content-product"},{default:r(()=>[(c(!0),y(f,null,g(t.items,e=>(c(),o(J,{key:e.itemId,url:"/pages/user/order/info?id="+e.orderId,"hover-class":"navigator-hover"},{default:r(()=>[d(s,{class:"item-content-product-item"},{default:r(()=>[d(s,{class:"item-content-product-img"},{default:r(()=>[d(q,{src:e.picThumb},null,8,["src"]),1===e.isGift?(c(),o(s,{key:0,class:"gift-text"},{default:r(()=>[x(h(a.$t("赠品")),1)]),_:1})):m("",!0)]),_:2},1024),d(s,{class:"item-content-product-info"},{default:r(()=>[d(s,{class:"product-item-title"},{default:r(()=>[t.joinStatus?(c(),o(s,{key:0,class:"groupon-tag"},{default:r(()=>[d(l,{class:"groupon-tag-text"},{default:r(()=>[x("拼")]),_:1})]),_:1})):m("",!0),x(" "+h(e.productName),1)]),_:2},1024),d(s,{class:C(["sku-card",{nodata:!e.skuData||0===e.skuData.length}])},{default:r(()=>[e.skuData&&e.skuData.length>0?(c(!0),y(f,{key:0},g(e.skuData,(a,t)=>(c(),o(s,{key:t,class:"sku-item line1"},{default:r(()=>[x(h(a.value),1)]),_:2},1024))),128)):m("",!0)]),_:2},1032,["class"]),e.extraSkuData&&e.extraSkuData.length?(c(),o(s,{key:0,class:"extraskudata-box"},{default:r(()=>[d(s,{class:"extraskudata"},{default:r(()=>[(c(!0),y(f,null,g(e.extraSkuData,a=>(c(),o(s,{key:a,class:"extraskudata-item"},{default:r(()=>[d(s,{class:"title"},{default:r(()=>[x(h(a.attrName),1)]),_:2},1024),d(s,{class:"line-box"},{default:r(()=>[d(s,{class:"line"})]),_:1}),d(s,{class:"content"},{default:r(()=>[d(l,{class:"line1 content-text"},{default:r(()=>[x(h(a.attrValue),1)]),_:2},1024),d(U,{"show-text":!1,class:"price","price-data":a.attrPrice},null,8,["price-data"]),d(s,{class:"num"},{default:r(()=>[x("x"+h(e.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):m("",!0),d(s,{class:"product-item-price"},{default:r(()=>[d(U,{"show-text":!1,class:"product-item-pricenum","decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"},"price-data":e.price},null,8,["price-data"]),d(s,{class:"product-item-quantity"},{default:r(()=>[x("x "+h(e.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["url"]))),128))]),_:2},1024),d(s,{class:"item-content-pay"},{default:r(()=>[d(s,{class:"item-content-pay-box"},{default:r(()=>[d(s,{class:"pay-item pay-type"},{default:r(()=>[x(h(1===t.payTypeId?a.$t("在线支付"):2===t.payTypeId?a.$t("货到付款"):_(T)("线下支付")),1)]),_:2},1024),d(s,{class:"pay-item total-money"},{default:r(()=>[x(h(a.$t("总额"))+"：",1),d(U,{"show-text":!1,"is-bottom":!1,"price-data":t.totalAmount},null,8,["price-data"])]),_:2},1024),0===t.orderStatus&&Number(t.unpaidAmount)>0?(c(),o(s,{key:0,class:"pay-item"},{default:r(()=>[x(h(a.$t("应付"))+"：",1),d(U,{"show-text":!1,"is-bottom":!1,"price-data":t.unpaidAmount},null,8,["price-data"])]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),d(s,{class:"order-list-item-btn"},{default:r(()=>[d(s,{class:"autodeliverydays"},{default:r(()=>[t.autoDeliveryDays?(c(),o(s,{key:0,class:"autodeliverydays-text line1"},{default:r(()=>[x("订单将在"+h(t.autoDeliveryDays)+"天后自动收货 ",1)]),_:2},1024)):m("",!0)]),_:2},1024),d(s,{class:"item-btn-box"},{default:r(()=>[d(sa,{class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,"plain-main-color":!0,onClick:a=>{return e=t.orderId,void D({url:`/pages/user/order/info?id=${e}`});var e}},{default:r(()=>[x(h(a.$t("订单详情")),1)]),_:2},1032,["onClick"]),t.availableActions.toPay?(c(),o(sa,{key:0,class:"btn-margin",color:"#333","custom-style":{height:"55rpx"},plain:!0,onClick:a=>{return e=t.orderId,void D({url:`/pages/order/pay?orderId=${e}`});var e}},{default:r(()=>[x(h(a.$t("去付款")),1)]),_:2},1032,["onClick"])):m("",!0),t.availableActions.cancelOrder?(c(),o(sa,{key:1,color:"#333",class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,onClick:a=>(async a=>{S({title:T("提示"),content:T("确认要取消该订单吗？"),success:async t=>{if(t.confirm)try{await z({id:a}),W.page=1,Q.value=[],E()}catch(e){$({title:e.message,icon:"none"})}}})})(t.orderId)},{default:r(()=>[x(h(a.$t("取消订单")),1)]),_:2},1032,["onClick"])):m("",!0),t.availableActions.delOrder?(c(),o(sa,{key:2,color:"#333",class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,onClick:a=>(async a=>{S({title:T("提示"),content:T("确认要删除该订单吗？"),success:async t=>{if(t.confirm)try{await G({id:a}),W.page=1,Q.value=[],E()}catch(e){$({title:e.message,icon:"none"})}}})})(t.orderId)},{default:r(()=>[x(h(a.$t("删除订单")),1)]),_:2},1032,["onClick"])):m("",!0),t.availableActions.rebuy?(c(),o(sa,{key:3,color:"#333",class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,onClick:a=>(async a=>{try{if(a.grouponPromotionRecordId){const t=await H({productId:a.items[0].productId});if(t&&t.endTime>X().format("YYYY-MM-DD HH:mm:ss")){let e="/pages/product/index?id="+t.productId;a.items[0].skuId&&(e=e+"&skuId="+a.items[0].skuId),j({url:e})}else await K({id:a.orderId}),j({url:"/pages/cart/index"})}else await K({id:a.orderId}),j({url:"/pages/cart/index"})}catch(t){$({title:t.message,icon:"none"})}})(t)},{default:r(()=>[x(h(a.$t("再次购买")),1)]),_:2},1032,["onClick"])):m("",!0),t.availableActions.toComment?(c(),o(sa,{key:4,color:"#333",class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,onClick:a=>{return e=t.orderId,void D({url:`/pages/user/comment/info?id=${e}`});var e}},{default:r(()=>[x(h(a.$t("去评价")),1)]),_:2},1032,["onClick"])):m("",!0),t.availableActions.confirmReceipt?(c(),o(sa,{key:5,color:"#333",class:"btn-margin","custom-style":{height:"55rpx"},plain:!0,onClick:a=>{return e=t.orderId,void S({title:T("提示"),content:T("确认收货吗？"),success:async a=>{if(a.confirm)try{await O({id:e}),A({url:"/pages/user/order/list?type=awaitComment"})}catch(t){$({title:t.message,icon:"none"})}}});var e}},{default:r(()=>[x(h(a.$t("确认收货")),1)]),_:2},1032,["onClick"])):m("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),d(la,{modelValue:_(aa),"onUpdate:modelValue":t[1]||(t[1]=a=>w(aa)?aa.value=a:null),page:W.page,length:_(Q).length},null,8,["modelValue","page","length"]),_(ta)||0!==_(ea)?m("",!0):(c(),o(M,{key:0,mode:"list",background:"#f5f5f5",text:a.$t("暂无订单")},null,8,["text"]))]),_:1}),d(oa,{modelValue:_(ta),"onUpdate:modelValue":t[2]||(t[2]=a=>w(ta)?ta.value=a:null)},null,8,["modelValue"])]),_:1})}}}),[["__scopeId","data-v-a8c138e6"]]);export{F as default};

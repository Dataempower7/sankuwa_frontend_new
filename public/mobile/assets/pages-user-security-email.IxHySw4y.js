import{d as e,r as a,n as l,m as t,c as i,w as s,C as u,F as n,b as o,e as r,i as c,J as d,K as v,G as p,h as f,t as m,R as y,X as _,_ as h}from"./index-BZxHr1FI.js";import{_ as k}from"./uni-easyinput.DHFPvsdC.js";import{T as b,a as g}from"./tig-layout.DTz8E-sj.js";import{V as x}from"./index.DfptdAaC.js";import{c as $,d as C,e as U,f as w}from"./security.tfcDL43Q.js";import"./uni-icons.DMMn2oBg.js";const j=h(e({__name:"email",setup(e){const h=e=>{G.value=e},j=e=>{E.value=e},q=e=>{D.value=e},I=e=>{T.value=e},E=a(""),T=a(""),D=a(""),G=a(""),M=a(""),R=a(!0),F=a(!1),J=a(!1);l(e=>{e.email?(F.value=!0,E.value=e.email):F.value=!1});const K=t(()=>!G.value||!M.value),V=e=>{y({title:e,duration:1500,icon:"none"})},X=async()=>{try{let e={email:E.value,code:G.value};await U({...e}),y({title:"绑定成功",icon:"none"}),_({url:"/pages/user/index"})}catch(e){y({title:e.message,icon:"none"})}},z=async()=>{if(!J.value)return await(async()=>{try{await w({email:E.value,code:G.value}),J.value=!0}catch(e){y({title:e.message,icon:"none"}),console.error("Email validation failed:",e)}})();try{let e={email:J.value?T.value:E.value,code:J.value?D.value:G.value};await U({...e}),y({title:"绑定成功",icon:"none"}),_({url:"/pages/user/index"})}catch(e){y({title:e.message,icon:"none"})}};return(e,a)=>{const l=u(n("uni-easyinput"),k),t=c,y=u(n("tig-button"),g),_=u(n("tig-layout"),b);return o(),i(_,{title:"账户安全"},{default:s(()=>[r(t,{class:"profile-edit-main"},{default:s(()=>[r(t,{class:"profile-edit-content"},{default:s(()=>[J.value?(o(),d(v,{key:0},[r(t,{class:"item special-item line"},{default:s(()=>[r(l,{"input-border":!1,value:T.value,focus:!0,class:"uni-input item-input",placeholder:e.$t("请输入新邮箱"),"primary-color":"rgb(192, 196, 204)",onInput:I},null,8,["value","placeholder"])]),_:1}),r(t,{class:"flex align-center"},{default:s(()=>[r(t,{class:"item line"},{default:s(()=>[r(l,{"input-border":!1,value:D.value,class:"",placeholder:e.$t("新邮箱验证码"),"primary-color":"rgb(192, 196, 204)",onInput:q},null,8,["value","placeholder"])]),_:1}),r(x,{"is-checked":R.value,"onUpdate:isChecked":a[0]||(a[0]=e=>R.value=e),email:T.value,"onUpdate:email":a[1]||(a[1]=e=>T.value=e),"verify-token-data":M.value,"onUpdate:verifyTokenData":a[2]||(a[2]=e=>M.value=e),style:{height:"65rpx"},"request-api":p($),onMobileErrorCallback:V},null,8,["is-checked","email","verify-token-data","request-api"])]),_:1})],64)):(o(),d(v,{key:1},[F.value?(o(),i(t,{key:0,class:"item"},{default:s(()=>[r(t,{class:"title"},{default:s(()=>[r(t,null,{default:s(()=>[f(m(e.$t("请输入")),1)]),_:1}),r(t,{class:"info"},{default:s(()=>[f(m(E.value.replace(/(\w{2})[\w.-]*@/,"$1*****@")),1)]),_:1}),r(t,null,{default:s(()=>[f(m(e.$t("收到的短信验证码")),1)]),_:1})]),_:1})]),_:1})):(o(),d(v,{key:1},[r(t,{class:"item"},{default:s(()=>[r(t,{class:"title"},{default:s(()=>[r(t,null,{default:s(()=>[f(m(e.$t("您还未绑定邮箱，请输入邮箱绑定")),1)]),_:1})]),_:1})]),_:1}),r(t,{class:"item special-item line"},{default:s(()=>[r(l,{"input-border":!1,value:E.value,class:"uni-input item-input",placeholder:e.$t("请输入邮箱"),"primary-color":"rgb(192, 196, 204)",onInput:j},null,8,["value","placeholder"])]),_:1})],64)),r(t,{class:"flex align-center"},{default:s(()=>[r(t,{class:"item line"},{default:s(()=>[r(l,{"input-border":!1,value:G.value,class:"",placeholder:e.$t("邮箱验证码"),"primary-color":"rgb(192, 196, 204)",onInput:h},null,8,["value","placeholder"])]),_:1}),F.value?(o(),i(x,{key:0,"is-checked":R.value,"onUpdate:isChecked":a[3]||(a[3]=e=>R.value=e),email:E.value,"onUpdate:email":a[4]||(a[4]=e=>E.value=e),"verify-token-data":M.value,"onUpdate:verifyTokenData":a[5]||(a[5]=e=>M.value=e),style:{height:"65rpx"},"request-api":p(C),onMobileErrorCallback:V},null,8,["is-checked","email","verify-token-data","request-api"])):(o(),i(x,{key:1,"is-checked":R.value,"onUpdate:isChecked":a[6]||(a[6]=e=>R.value=e),email:E.value,"onUpdate:email":a[7]||(a[7]=e=>E.value=e),"verify-token-data":M.value,"onUpdate:verifyTokenData":a[8]||(a[8]=e=>M.value=e),style:{height:"65rpx"},"request-api":p($),onMobileErrorCallback:V},null,8,["is-checked","email","verify-token-data","request-api"]))]),_:1})],64)),F.value?(o(),i(t,{key:3,class:"item",style:{height:"60rpx"}},{default:s(()=>[r(y,{disabled:K.value,class:"next",onClick:z},{default:s(()=>[f(m(e.$t("下一步")),1)]),_:1},8,["disabled"])]),_:1})):(o(),i(t,{key:2,class:"item",style:{height:"60rpx"}},{default:s(()=>[r(y,{disabled:K.value,class:"next",onClick:X},{default:s(()=>[f(m(e.$t("下一步")),1)]),_:1},8,["disabled"])]),_:1}))]),_:1}),r(t,{class:"profile-edit-content"},{default:s(()=>[r(t,{class:"btn-item"},{default:s(()=>[r(t,{class:"title"},{default:s(()=>[r(t,{class:"big-title"},{default:s(()=>[f(m(e.$t("为什么要进行身份验证"))+"？",1)]),_:1})]),_:1}),r(t,{class:"info"},{default:s(()=>[f("1. "+m(e.$t("为保障您的账户信息安全，在变更账户中的重要信息时需要进行身份验证，感谢您的理解和支持"))+"。",1)]),_:1}),r(t,{class:"info"},{default:s(()=>[f("2. "+m(e.$t("验证身份遇到问题？您可以通知我们的客服，我们将尽快联系您"))+"。",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-e910326b"]]);export{j as default};

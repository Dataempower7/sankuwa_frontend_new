import{a4 as e,d as a,a7 as l,L as s,a5 as t,m as u,r as o,V as n,c as i,w as d,C as r,F as g,b as c,e as v,i as m,h as p,t as h,J as f,P as y,K as _,Z as w,a as k,W as I,O as V,_ as C}from"./index-BZxHr1FI.js";import{_ as N}from"./tig-layout.DTz8E-sj.js";const R=C(a({__name:"selectRegion",props:l({show:{type:Boolean,default:!1},height:{type:String,default:"60vh"}},{modelValue:{type:Array,default:()=>[]},modelModifiers:{}}),emits:l(["update:show","update:modelValue","sendRegionNames"],["update:modelValue"]),setup(a,{emit:l}){const{t:C}=s(),R=a,b=t(a,"modelValue"),j=l,x=u({get:()=>R.show,set:()=>{j("update:show",!1)}}),E=o([]),$=o(0),A=async()=>{try{let a="";b.value.length>0&&(a=b.value.join(","));const l=await(a=>e({url:"sys/region/getRegion",method:"get",params:{regionIds:a}}))(a);E.value=l,E.value.length>1?E.value[E.value.length-1].length>0?$.value=E.value.length-1:$.value=E.value.length-2:$.value=0}catch(a){}};n(()=>b.value,e=>{e&&A()},{immediate:!0,deep:!0});const B=e=>b.value.includes(Number(e)),F=u(()=>{let e=[];return E.value.forEach((a,l)=>{if(a.length>0){let s=!1;a.forEach(a=>{B(a.regionId)&&(e[l]=a.regionName,s=!0)}),0==s&&(e[l]=C("请选择地区"))}}),e});return(e,a)=>{const l=m,s=I,t=r(g("tig-popup"),N);return c(),i(t,{show:x.value,"onUpdate:show":a[0]||(a[0]=e=>x.value=e),position:"bottom"},{default:d(()=>[v(l,{class:"select-region-main"},{default:d(()=>[v(l,{class:"popup-title"},{default:d(()=>[p(h(e.$t("选择地区")),1)]),_:1}),v(l,{class:"content"},{default:d(()=>[v(l,{class:"region-menu"},{default:d(()=>[(c(!0),f(_,null,y(F.value,(a,s)=>(c(),i(l,{key:s,class:w(["region-menu-item",{active:$.value===s}]),onClick:e=>$.value=s},{default:d(()=>[p(h(a||e.$t("请选择")),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),(c(!0),f(_,null,y(E.value,(e,a)=>(c(),f(_,{key:a},[$.value===a?(c(),i(s,{key:0,"scroll-y":"true",class:"region-list"},{default:d(()=>[(c(!0),f(_,null,y(e,e=>(c(),i(l,{key:e.regionId,class:w(["region-list-item",{active:B(e.regionId)}]),onClick:V(l=>(async(e,a)=>{e>=0&&e<=b.value.length&&(b.value[e]=a,b.value.length>e+1&&b.value.splice(e+1)),await A(),E.value.length==e+1||0==E.value[e+1].length?(j("update:modelValue",b.value),j("update:show",!1),j("sendRegionNames",F.value)):$.value=e+1})(a,e.regionId),["stop"])},{default:d(()=>[p(h(e.regionName),1)]),_:2},1032,["class","onClick"]))),128))]),_:2},1024)):k("",!0)],64))),128))]),_:1})]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-362e65df"]]);export{R as s};

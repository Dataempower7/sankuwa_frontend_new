import{d as e,c as t,b as a,w as o,e as l,i as s,aB as n,a as c,I as r,Z as i,h as u,t as d,am as p,_ as f,ab as g,J as h,P as b,G as y,K as m,a9 as k,$ as v,f as _,ae as S,a0 as x,j as w,u as B,C,F as I,bl as T,b7 as $,m as z,bm as L,bn as N,bo as A,L as D,az as P,l as V,r as H,v as M,M as R,k as j,X as U,R as X,bp as q,bq as O,Q as F,Y as G,aM as J,br as W,D as Y,bs as Z,aR as E,af as K}from"./index-BZxHr1FI.js";const Q=f(e({__name:"tig-navbar",props:{title:{type:String,default:""},background:{type:String,default:"#fff"},showLeft:{type:Boolean,default:!0},customBack:{type:Boolean,default:!1},borderBottom:{type:Boolean,default:!1},color:{type:String,default:"#000"}},emits:["back"],setup(e,{emit:f}){const g=e,h=f,b=()=>{p(),g.customBack?h("back"):history.back()};return(p,f)=>{const g=s;return a(),t(g,{class:"tig-navbar"},{default:o(()=>[l(g,{class:i(["navbar-box",{"border-bottom":e.borderBottom}]),style:r(`background: ${e.background};`)},{default:o(()=>[l(g,{class:"navbar"},{default:o(()=>[l(g,{class:"navbar-content"},{default:o(()=>[l(g,{class:"left"},{default:o(()=>[e.showLeft?n(p.$slots,"left",{key:0},()=>[l(g,{class:"iconfont icon-houtui",onClick:b})],!0):c("",!0)]),_:3}),l(g,{class:"middle"},{default:o(()=>[n(p.$slots,"title",{},()=>[l(g,{class:"title line1",style:r(`color: ${e.color};`)},{default:o(()=>[u(d(p.$t(e.title)),1)]),_:1},8,["style"])],!0)]),_:3}),l(g,{class:"right"},{default:o(()=>[n(p.$slots,"right",{},void 0,!0)]),_:3})]),_:3})]),_:3})]),_:3},8,["class","style"]),l(g,{class:"placeholder"})]),_:3})}}}),[["__scopeId","data-v-f5895c8c"]]),ee=f(e({__name:"tig-tabbar",props:{backgroundColor:{type:String,default:"#fff"},color:{type:String,default:"#000"},activeColor:{type:String,default:"#ea3c2d"}},setup(e){k(e=>({"29effe0e":c.backgroundColor,"30cb39dc":c.color,"01e08094":c.activeColor}));const n=g(),c=e;return(e,c)=>{const r=_,p=s;return a(),t(p,{class:"tabbar-box"},{default:o(()=>[l(p,{class:"tabbar-container"},{default:o(()=>[l(p,{class:"tabbar"},{default:o(()=>[(a(!0),h(m,null,b(y(n).tabbarList,(s,c)=>(a(),t(p,{key:c,class:"tabbar-item",onClick:e=>((e,t)=>{n.currentActiveValue!==t&&e.link&&w({url:B(e.link)})})(s,c)},{default:o(()=>[l(p,{class:"tabbar-icon"},{default:o(()=>[v(l(r,{class:"tabbar-icon-img",src:y(S)(s.activeImage)},null,8,["src"]),[[x,y(n).currentActiveValue===c]]),v(l(r,{class:"tabbar-icon-img",src:y(S)(s.image)},null,8,["src"]),[[x,y(n).currentActiveValue!==c]])]),_:2},1024),l(p,{class:i(["tabbar-text",{active:y(n).currentActiveValue===c}])},{default:o(()=>[u(d(e.$t(s.text)),1)]),_:2},1032,["class"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),l(p,{class:"placeholder"})]),_:1})}}}),[["__scopeId","data-v-794620d5"]]),te=f(e({__name:"tig-button",props:{shape:{type:String,default:"circle"},type:{type:String,default:"primary"},color:{type:String,default:"var(--main-bg)"},text:{type:String,default:"确定"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},plain:{type:Boolean,default:!1},loadingText:{type:String,default:""},size:{type:String,default:"normal"},customStyle:{type:Object,default:()=>({})},openType:{type:String,default:""}},emits:["click","getPhoneNumber"],setup(e,{emit:l}){const s=l,c=e=>{s("click",e)},r=e=>{s("getPhoneNumber",e)};return(l,s)=>{const i=C(I("up-button"),T);return a(),t(i,{"custom-style":e.customStyle,type:e.type,size:e.size,plain:e.plain,color:e.color,shape:e.shape,disabled:e.disabled,text:e.text,loading:e.loading,"loading-text":e.loadingText,"open-type":e.openType,onClick:c,onGetphonenumber:r},{default:o(()=>[n(l.$slots,"default",{},void 0,!0)]),_:3},8,["custom-style","type","size","plain","color","shape","disabled","text","loading","loading-text","open-type"])}}}),[["__scopeId","data-v-5beee3c7"]]),ae=f(e({__name:"tig-checkbox",props:{checkedText:{type:String,default:""},checkedSize:{type:Number,default:.8},checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},shape:{type:String,default:"circle"},size:{type:String,default:"15"}},emits:["update:checked","change"],setup(e,{emit:s}){const n=e,c=$(),r=z(()=>c.themeStyle["--general"]||"#ee0a24"),i=s,p=()=>{n.disabled||(i("update:checked",!n.checked),i("change"))};return(s,n)=>{const c=C(I("up-checkbox"),L),i=N;return a(),t(i,{class:"check",onClick:p},{default:o(()=>[l(c,{shape:e.shape,"used-alone":!0,disabled:e.disabled,"active-color":r.value,checked:e.checked,size:e.size,onChange:p},null,8,["shape","disabled","active-color","checked","size"]),u(" "+d(e.checkedText),1)]),_:1})}}}),[["__scopeId","data-v-faa6bfc6"]]),oe=f(e({__name:"tig-popup",props:{show:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},position:{type:String,default:"bottom"},round:{type:[String,Number],default:10},backgroundColor:{type:String,default:"#fff"},customStyle:{type:Object,default:()=>({})},maskClick:{type:Boolean,default:!0},zIndex:{type:Number,default:201},height:{type:String,default:"50vh"}},emits:["update:show","change","handleShade","close"],setup(e,{emit:l}){const s=e,c=l,r=z({get:()=>s.show,set(e){c("update:show",e)}}),i=()=>{c("close"),c("update:show",!1)};return(l,s)=>{const c=C(I("up-popup"),A);return a(),t(c,{show:r.value,"onUpdate:show":s[0]||(s[0]=e=>r.value=e),"close-on-click-overlay":e.maskClick,overlay:e.overlay,mode:e.position,round:e.round,"bg-color":e.backgroundColor,"custom-style":{...e.customStyle},"z-index":e.zIndex,"safe-area-inset-top":!1,"safe-area-inset-bottom":!1,closeable:e.showClose,onClose:i},{default:o(()=>[n(l.$slots,"default",{},void 0,!0)]),_:3},8,["show","close-on-click-overlay","overlay","mode","round","bg-color","custom-style","z-index","closeable"])}}}),[["__scopeId","data-v-780a5652"]]),le=f(e({__name:"tig-wechart-login",emits:["loginSuccess"],setup(e,{emit:n}){const{t:r}=D(),i=n,p=P(),f=V(),g=z({get:()=>!!p.authType,set(e){p.setAuthType("")}}),h=H(!1),b=H(!1),y=()=>{U({url:"/pages/login/mallAgreement"})},m=()=>{if(!h.value)return X({title:r("请先同意用户协议"),duration:1500,icon:"none"})},k=async()=>{const e=await q({url:location.origin+location.pathname});window.location.href=e.url},v=e=>{p.setAuthType(""),U({url:`/pages/login/index?loginType=${e}`})},_=()=>{p.setAuthType("")};return M(()=>{if("wechat"===f.XClientType&&!R("token")){const e=(e=>{const t={},a=e.split("?")[1];return a&&a.split("&").forEach(e=>{const[a,o]=e.split("=");t[a]=o}),t})(location.href);e.code&&e.code.length>12&&(async e=>{const t=await O({code:e});1==t.type&&(p.setToken(t.token),await p.getUserInfo(),i("loginSuccess"),p.setAuthType("")),2==t.type&&1===f.wechatRegisterBindPhone&&(F("openData",t.openData),U({url:"/pages/user/bindMobilePhone/index"}))})(e.code)}}),(e,n)=>{const r=C(I("tig-button"),te),i=C(I("tig-checkbox"),ae),p=j,f=s,S=C(I("tig-popup"),oe);return a(),t(S,{show:g.value,"onUpdate:show":n[4]||(n[4]=e=>g.value=e),"z-index":1e3,onClose:_},{default:o(()=>[g.value?(a(),t(f,{key:0,class:"wechart-login-content"},{default:o(()=>[l(f,{class:"wechart-login-box"},{default:o(()=>[h.value?(a(),t(r,{key:0,"custom-style":{"border-radius":"20rpx",height:"95rpx"},shape:"square",loading:b.value,onClick:k},{default:o(()=>[u(d(e.$t("微信授权")),1)]),_:1},8,["loading"])):(a(),t(r,{key:1,"custom-style":{"border-radius":"20rpx",height:"95rpx"},shape:"square",onClick:m},{default:o(()=>[u(d(e.$t("微信授权")),1)]),_:1})),l(f,{class:"rule-text"},{default:o(()=>[l(i,{checked:h.value,"onUpdate:checked":n[0]||(n[0]=e=>h.value=e)},null,8,["checked"]),l(f,{class:"rule-xieyi"},{default:o(()=>[l(p,{onClick:n[1]||(n[1]=e=>h.value=!h.value)},{default:o(()=>[u(d(e.$t("登录即为同意")),1)]),_:1}),l(p,{class:"special-color",onClick:y},{default:o(()=>[u(d(e.$t("《商城用户服务协议》")),1)]),_:1})]),_:1})]),_:1}),l(f,{class:"other-login"},{default:o(()=>[l(f,{class:"mobile-login",onClick:n[2]||(n[2]=e=>v("mobile"))},{default:o(()=>[u(d(e.$t("手机登录")),1)]),_:1}),l(f,{class:"account-login",onClick:n[3]||(n[3]=e=>v("password"))},{default:o(()=>[u(d(e.$t("账号登录")),1)]),_:1})]),_:1})]),_:1})]),_:1})):c("",!0)]),_:1},8,["show"])}}}),[["__scopeId","data-v-a38e11af"]]),se=e({__name:"tig-statistic-log",props:{productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,l=G({}),s=async()=>{o.productId&&(l.productId=o.productId),o.shopId&&(l.shopId=o.shopId),o.shopCategoryId&&(l.shopCategoryId=o.shopCategoryId);try{await W(l)}catch(e){console.error(e)}},n=z(()=>{const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`});return(()=>{const e=R("lastDate");!e||((e,t)=>{const a=new Date(e),o=new Date(t);return Math.abs(a.getTime()-o.getTime())>=864e5})(n.value,e)?(l.isNew=1,F("untranslatedCache",JSON.stringify([]))):l.click=1,F("lastDate",n.value)})(),J(()=>{o.immediateLog&&s()}),t({__commonLog:s}),(e,t)=>(a(),h("div"))}});function ne(e){const t=H(0);return e&&"function"==typeof e?e(e=>{t.value=e.scrollTop}):Y(e=>{t.value=e.scrollTop}),{scrollTop:t}}function ce(){const e=V(),{top:t,bottom:a}=Z(e.safeAreaInsets);return{saveTop:t,safeBottom:a}}function re(e=0){const t=H(e),a=H("100%"),o=H(0),{saveTop:l}=ce();return function(){const e=V(),{left:t,right:a,top:o,height:l}=Z(e.menuButtonInfo)}(),o.value=l.value+t.value,{height:o,contentHeight:t,contentWidth:a,statusBarHeight:l}}const ie=f(e({__name:"tig-layout",props:{needSafeTop:{type:Boolean,default:!1},needSafeBottom:{type:Boolean,default:!0},safeTopBgColor:{type:String,default:"#fff"},productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0},title:{type:String,default:""},customBack:{type:Boolean,default:!1},borderBottom:{type:Boolean,default:!1},showLeft:{type:Boolean,default:!0},background:{type:String,default:"#fff"},color:{type:String,default:"#000"}},emits:["loginSuccess","back"],setup(e,{expose:u,emit:d}){k(e=>({ce79fb50:p.safeTopBgColor}));const p=e,f=d,h=g(),b=V(),m=$();E();const _=z(()=>!0);b.setH5Title();const{safeBottom:S}=ce(),{height:w}=re(),B=z(()=>({...m.themeStyle,"--tabbar-height":h.tabbarHeight,"--safe-bottom":`${S.value}px`,"--safe-top":`${w.value}px`,"--nav-height":`${b.navHeight}rpx`})),T=H();return u({handleLog:()=>{var e;null==(e=T.value)||e.__commonLog()},isZh:_}),(u,d)=>{const p=s,g=C(I("tig-navbar"),Q),m=C(I("tig-tabbar"),ee),k=C(I("tig-wechart-login"),le),S=C(I("tig-statistic-log"),se);return a(),t(p,{class:i(["layout",{"not-zh":!_.value&&y(K)()}]),style:r({...B.value})},{default:o(()=>[e.needSafeTop?(a(),t(p,{key:0,class:"safe-top-box"})):c("",!0),e.title?(a(),t(g,{key:1,title:e.title,"border-bottom":e.borderBottom,"show-left":e.showLeft,background:e.background,color:e.color,"custom-back":e.customBack,onBack:d[0]||(d[0]=e=>f("back"))},null,8,["title","border-bottom","show-left","background","color","custom-back"])):c("",!0),n(u.$slots,"default",{},void 0,!0),-1===y(h).currentActiveValue&&e.needSafeBottom?(a(),t(p,{key:2,class:"layout-safe-bottom"})):c("",!0),v(l(p,null,{default:o(()=>[l(m)]),_:1},512),[[x,y(h).currentActiveValue>-1]]),"miniProgram"!==y(b).XClientType&&"wechat"!==y(b).XClientType||1!==y(b).openWechatRegister?c("",!0):(a(),t(k,{key:3,onLoginSuccess:d[1]||(d[1]=e=>u.$emit("loginSuccess"))})),l(S,{ref_key:"statisticLogRef",ref:T,"immediate-log":e.immediateLog,"product-id":e.productId,"shop-id":e.shopId,"shop-category-id":e.shopCategoryId},null,8,["immediate-log","product-id","shop-id","shop-category-id"])]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-1d9f9f67"]]);export{ie as T,oe as _,te as a,ce as b,Q as c,ae as d,re as e,ne as u};

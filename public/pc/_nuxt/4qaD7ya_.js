import{E as e}from"./mwh1qCMm.js";import{_ as o}from"./BR_yKGQj.js";import{_ as l}from"./BPBPggU1.js";import{v as s}from"./D-C0HBq9.js";import{e as a,cw as n,cx as u,r as c,h as i,b_ as d,c as t,o as p,a as v,i as m,b as r,w as y,t as b,a9 as f,F as k,m as h,x as C,d as g,_ as I}from"./r4GZdGYg.js";import"./Bd103Yf7.js";import"./g8XVjk5f.js";import"./CIKxL71l.js";import"./BNGL4P8m.js";const V={class:"from"},$={class:"check-box"},_={class:"tit"},M={key:0,class:"from_list"},U={class:"coupon-box"},j={key:0,class:"coupon_list"},x=["onClick"],L={class:"item-selected-cancel"},N={key:0,class:"priceNum"},T={key:0,class:"coupon-globle"},D={key:1,class:"zk"},G={key:0,class:"coupon-globle"},R={class:"time"},w={class:"detail"},z={key:2,class:"coupon-notice"},B={key:3,class:"coupon-notice"},E={class:"item-selected-cancel"},F={key:0,class:"priceNum"},P={key:0,class:"coupon-globle"},q={key:1,class:"zk"},A={key:0,class:"coupon-globle"},H={class:"time"},J={class:"detail"},K={key:2,class:"coupon-notice"},O={key:3,class:"coupon-notice"},Q={key:1,class:"no-cou"},S=I(a({__name:"CouponInfo",props:{useCoupon:{type:Boolean},useCouponModifiers:{},couponList:{},couponListModifiers:{},couponLoading:{},couponLoadingModifiers:{},selectedIds:{},selectedIdsModifiers:{},selectedUserCouponIds:{},selectedUserCouponIdsModifiers:{}},emits:n(["change"],["update:useCoupon","update:couponList","update:couponLoading","update:selectedIds","update:selectedUserCouponIds"]),setup(a,{emit:n}){const I=n,S=u(a,"useCoupon"),W=u(a,"couponList"),X=u(a,"couponLoading"),Y=c(0);i(["商品优惠券","优惠码兑换"]);const Z=()=>{!1===S.value?(ee.value=[],oe.value=[],I("change")):I("change",!0)},ee=u(a,"selectedIds"),oe=u(a,"selectedUserCouponIds"),le=c([]);d(()=>{W.value&&W.value.enableCoupons&&(le.value=W.value.enableCoupons.filter(e=>e.selected))});const se=e=>{const o=Number(e.userCouponId);if(l=o,oe.value&&oe.value.includes(l))le.value=le.value.filter(e=>e.userCouponId!==o);else{if(le.value.findIndex(o=>o.shopId===e.shopId)>-1)le.value=le.value.filter(o=>o.shopId!==e.shopId);else{le.value.findIndex(o=>o.id===e.id)>-1&&(le.value=le.value.filter(o=>o.id!==e.id))}le.value.push(e)}var l;ee.value=le.value.map(({id:e})=>Number(e)),oe.value=le.value.map(({userCouponId:e})=>Number(e)),I("change")};return(a,n)=>{var u,c,i,d;const I=e,ee=o,oe=l,le=s;return p(),t("div",null,[v("div",V,[v("div",$,[r(I,{modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=e=>S.value=e),onChange:Z},{default:y(()=>[v("div",_,b(a.$t("使用优惠券")),1)]),_:1},8,["modelValue"])])]),S.value?(p(),t("div",M,[n[10]||(n[10]=v("div",{class:"arrow"},null,-1)),v("div",U,[m("",!0),f((p(),t("div",null,[0==Y.value?(p(),t("div",j,[W.value&&((null==(u=W.value)?void 0:u.enableCoupons.length)>0||(null==(c=W.value)?void 0:c.disableCoupons.length)>0)?(p(),t(k,{key:0},[(null==(i=W.value)?void 0:i.enableCoupons.length)>0?(p(!0),t(k,{key:0},h(W.value.enableCoupons,(e,o)=>(p(),t("div",{class:C(["coupon_item hand-pointer",{active:e.selected}]),type:"checkbox",onClick:o=>se(e)},[n[3]||(n[3]=v("div",{class:"c-top-dong"},null,-1)),v("div",L,b(a.$t("取消勾选")),1),1==e.couponType?(p(),t("div",N,[r(ee,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(p(),t("span",T,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.couponType?(p(),t("div",D,[g(b(e.couponDiscount)+" ",1),v("span",null,b(a.$t("折")),1),e.isGlobal?(p(),t("span",G,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",R,b(a.$t("有效期至"))+b(e.endDate),1),v("div",w,b(e.couponName),1),n[4]||(n[4]=v("i",{class:"icon-gou"},null,-1)),e.disableReason?(p(),t("div",z,[n[1]||(n[1]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(b(e.disableReason),1)])):m("",!0),e.selected&&1==e.couponType?(p(),t("div",B,[n[2]||(n[2]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(" "+b(a.$t("已减")),1),r(ee,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],10,x))),256)):m("",!0),W.value&&(null==(d=W.value)?void 0:d.disableCoupons.length)>0?(p(!0),t(k,{key:1},h(W.value.disableCoupons,e=>(p(),t("div",{class:C(["coupon_item hand-pointer disabled",{active:e.selected}]),type:"checkbox"},[n[7]||(n[7]=v("div",{class:"c-top-dong"},null,-1)),v("div",E,b(a.$t("取消勾选")),1),1==e.couponType?(p(),t("div",F,[r(ee,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(p(),t("span",P,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.couponType?(p(),t("div",q,[g(b(e.couponDiscount)+" ",1),v("span",null,b(a.$t("折")),1),e.isGlobal?(p(),t("span",A,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",H,b(a.$t("有效期至"))+b(e.endDate),1),v("div",J,b(e.couponName),1),n[8]||(n[8]=v("i",{class:"icon-gou"},null,-1)),e.disableReason?(p(),t("div",K,[n[5]||(n[5]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(b(e.disableReason),1)])):m("",!0),e.selected&&2==e.couponType?(p(),t("div",O,[n[6]||(n[6]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(" "+b(a.$t("已减")),1),r(ee,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],2))),256)):m("",!0)],64)):(p(),t("div",Q,[g(b(a.$t("暂无可用优惠券"))+"～",1),r(oe,{target:"_blank",class:"font-color",to:"/coupon/list"},{default:y(()=>[g(b(a.$t("去领券")),1)]),_:1})]))])):m("",!0)])),[[le,X.value]]),m("",!0)])])):m("",!0)])}}}),[["__scopeId","data-v-41e492e6"]]);export{S as default};

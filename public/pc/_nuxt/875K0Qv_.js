import{E as j}from"./BhwkTUtM.js";import{_ as D}from"./Dcyx2-kv.js";import{a as G,E as H}from"./Ckzsp_T1.js";import{E as J}from"./B_vjKAZC.js";import{e as K,ax as Q,ay as X,f as Y,z as ee,r as y,I as oe,h as $,c as _,o as n,i as M,b as i,j as u,a as d,F as te,m as le,x as se,t as f,w as a,n as w,aG as re,dA as ie,d as ae,dB as ne,dC as ue,cA as S,_ as de}from"./BjkHNVA8.js";/* empty css        *//* empty css        */import{_ as me}from"./DbAxkXJA.js";import{M as A}from"./DYce8M0P.js";import"./C1B8-dXF.js";import"./FYm-MTMW.js";import"./cfDoaBtk.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./Bnvi_g-K.js";import"./CXwPJP5h.js";import"./x_rD_Ya3.js";import"./UVx7YjW9.js";const pe={key:0,class:"register-menu"},fe={class:"menu-box"},ve=["onClick"],be={class:"label"},ce={class:"area-code-input"},ge={key:0,class:"area-code-select"},ye={class:"label"},_e={class:"label"},we=K({__name:"StepOne",props:{step:{},stepModifiers:{}},emits:Q(["success"],["update:step"]),setup(x,{emit:F}){const q=X(x,"step"),k=F,m=Y(),{t:r}=ee(),v=y(!1),b=y("86"),T=oe(),U=(l,e,t)=>{e?o.value.tigTips[l]={type:"valid",message:t}:o.value.tigTips[l]={type:"error",message:t}},B=[{label:r("手机号找回"),value:""},{label:r("邮箱找回"),value:"email"}],c=l=>{o.value.tigTips[l]={type:"info",message:C[l]}},O=(l,e,t)=>{const p=m.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;if(e)if(p.test(e))t();else return t(new Error(r("格式错误，请输入正确的手机号码")));else return t(new Error(r("手机号不能为空")))},I=(l,e,t)=>{if(e)if(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e))t();else return t(new Error(r("格式错误，请输入正确的邮箱地址")));else return t(new Error(r("邮箱不能为空")))},R=(l,e,t)=>{if(e){if(e.length!=6)return t(new Error(r("请输入6位验证码")));t()}else return t(new Error(r("验证码不能为空")))},z=l=>{o.value.registType=l,o.value.tigTips={},l==="email"?(o.value.mobile="",o.value.code="",o.value.tigTips.mobile={type:"info",message:C.mobile}):(o.value.email="",o.value.code="",o.value.tigTips.email={type:"info",message:C.email})},N=(l,e,t)=>{if(e){if(e.length>20||e.length<6)return t(new Error(r("密码应为6-20位字符")));if(/\s/.test(e))return t(new Error(r("密码中不允许有空格")));if(/^\d+$/.test(e))return t(new Error(r("密码不能全为数字")));if(/^(?=.*[\d\W]).+$/.test(e))if(/^(?=.*[a-zA-Z0-9]).+$/.test(e))if(/^(?!([a-zA-Z0-9])\1*$).+$/.test(e))t();else return t(new Error(r("密码不能全为相同字符或数字")));else return t(new Error(r("密码不能全为符号")));else return t(new Error(r("密码不能全为字母")))}else return t(new Error(r("密码不能为空")))},C=$({mobile:r("请填写手机号码"),email:r("请填写邮箱地址"),code:r("请输入验证码"),password:r("6-20个大小写英文字母、符号或数字的组合")}),L=$({mobile:[{validator:O,trigger:"blur",required:!0}],email:[{validator:I,trigger:"blur",required:!0}],code:[{validator:R,trigger:"blur",required:!0}],password:[{validator:N,trigger:"blur",required:!0}]}),E=y(!1),o=y({tigTips:{},mobile:"",registType:"",code:""}),P=async()=>{await T.value.validate();try{E.value=!0;let l;if(o.value.registType==="email"){const e={email:o.value.email,code:o.value.code};l=await ne(e)}else{const e={mobile:m.isOpenMobileAreaCode?b.value+o.value.mobile:o.value.mobile,code:o.value.code};l=await ue(e)}k("success",l),q.value=2}catch(l){S.error(l.message||r("操作失败")),o.value.code="",o.value.tigTips={}}finally{E.value=!1}},V=l=>{S.error(l)};return(l,e)=>{const t=j,p=D,g=H,W=J,Z=G;return n(),_("div",null,[u(m).openEmailRegister===1?(n(),_("div",pe,[d("div",fe,[(n(),_(te,null,le(B,(s,h)=>d("div",{key:h,class:se(["menu-item",{active:o.value.registType===s.value}]),onClick:Ce=>z(s.value)},f(s.label),11,ve)),64))])])):M("",!0),i(Z,{ref_key:"formRef",ref:T,"hide-required-asterisk":!0,model:o.value,rules:u(L),"show-message":!1,class:"form-body","label-width":"auto",onValidate:U},{default:a(()=>[o.value.registType==="mobile"||!o.value.registType?(n(),w(g,{key:0,prop:"mobile"},{default:a(()=>[d("div",be,f(l.$t("手机号")),1),d("div",ce,[i(t,{modelValue:o.value.mobile,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.mobile=s),class:"input-border-style",onFocus:e[2]||(e[2]=s=>c("mobile"))},{prefix:a(()=>[u(m).isOpenMobileAreaCode?(n(),_("div",ge,[i(me,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s)},null,8,["modelValue"])])):M("",!0)]),_:1},8,["modelValue"])]),i(p,{info:o.value.tigTips.mobile},null,8,["info"])]),_:1})):(n(),w(g,{key:1,prop:"email"},{default:a(()=>[d("div",ye,f(l.$t("邮箱")),1),i(t,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.email=s),class:"input-border-style",onFocus:e[4]||(e[4]=s=>c("email"))},null,8,["modelValue"]),i(p,{info:o.value.tigTips.email},null,8,["info"])]),_:1})),i(g,{prop:"code"},{default:a(()=>[d("div",_e,f(l.$t("验证码")),1),o.value.registType==="mobile"||!o.value.registType?(n(),w(t,{key:0,modelValue:o.value.code,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.code=s),class:"input-border-style",onFocus:e[7]||(e[7]=s=>c("code"))},{suffix:a(()=>[i(u(A),{class:"mobile-code-text",event:"forgetPassword",mobile:u(m).isOpenMobileAreaCode?b.value+o.value.mobile:o.value.mobile,mobileCodeSended:v.value,"onUpdate:mobileCodeSended":e[5]||(e[5]=s=>v.value=s),requestApi:u(re),onMobileErrorCallback:V},null,8,["mobile","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])):(n(),w(t,{key:1,modelValue:o.value.code,"onUpdate:modelValue":e[9]||(e[9]=s=>o.value.code=s),class:"input-border-style",onFocus:e[10]||(e[10]=s=>c("code"))},{suffix:a(()=>[i(u(A),{event:"forgetPassword",class:"mobile-code-text",email:o.value.email,mobileCodeSended:v.value,"onUpdate:mobileCodeSended":e[8]||(e[8]=s=>v.value=s),requestApi:u(ie),onMobileErrorCallback:V},null,8,["email","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])),i(p,{info:o.value.tigTips.code},null,8,["info"])]),_:1}),i(g,{label:"",prop:"firstWord"},{default:a(()=>[i(W,{loading:E.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:P},{default:a(()=>[ae(f(l.$t("下 一 步")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])}}}),Ze=de(we,[["__scopeId","data-v-33ef094b"]]);export{Ze as default};

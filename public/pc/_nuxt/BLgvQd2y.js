import{_ as a}from"./IO9hpqeh.js";import{_ as s}from"./Dw0vWOz4.js";import{_ as t}from"./BR_yKGQj.js";import{e,G as o,r as l,z as r,y as i,p as c,ad as n,R as m,c as d,o as p,b as u,a as v,t as y,j as f,d as j,i as w,E as h,_ as $}from"./r4GZdGYg.js";import{_ as g}from"./DkwXwj3h.js";import{E as k}from"./Oz6DVX0g.js";import"./5EY5iYNX.js";import"./YKVlRHu9.js";import"./bHTXMzV5.js";import{Q as _}from"./xSPxQ0UB.js";import{w as b,z as C}from"./CAihOkzd.js";import{e as I,f as S,d as x}from"./IbbeVozb.js";import{s as V}from"./DSXY0Md2.js";import"./70QeHNk8.js";import"./BPBPggU1.js";import"./CDFFSI_k.js";import"./DgAv7tgp.js";import"./g8XVjk5f.js";import"./BNGL4P8m.js";import"./Bd103Yf7.js";import"./CIKxL71l.js";import"./DL5ZnEaR.js";import"./VWWcEZs1.js";const z={class:"wechat-com"},B={class:"wechat container"},L={class:"message"},U={class:"message"},q={class:"payment"},E={key:0,class:"title"},P={key:1,class:"title"},Q={class:"image-div"},R={class:"left-image"},D={key:0,class:"ewm"},G={key:1,class:"ewm-empty"},M={class:"pw-box-ft"},O={key:0},T={key:1},X={key:2},Y={class:"right-image"},Z={key:0,class:"image"},A={key:1,class:"image"},F=$(e({__name:"yabanpay",setup(e){const $=o(),F=l($.query.id),H=l($.query.type),J=l(!0);l({});const K=l(""),N=l({orderSn:"",amount:0}),{t:W}=r();(async()=>{try{const a=await S({orderId:F.value});N.value=a.order}catch(a){c.error(a.message),n("/member/account/detail")}})();const aa=l(0);let sa=null;i(()=>{(async()=>{J.value=!0;try{const a=await x({id:F.value,type:"yabanpay_"+H.value});ea(null==a?void 0:a.payInfo.codeUrl)}catch(a){c.error(a.message)}finally{J.value=!1}})(),sa=V(()=>{ta(),aa.value++,50===aa.value&&(clearInterval(sa),c.error(W("支付已超时，您可以刷新页面重新支付")))},2e3)});const ta=()=>{I({id:F.value}).then(a=>{1==a&&(clearInterval(sa),k.confirm(W("订单支付成功"),W("提示"),{confirmButtonText:W("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{n("/member/account/detail")}).catch(()=>{}))})},ea=async a=>{const s=a;K.value=await _.toDataURL(s,{margin:1,width:500,height:500})},oa=()=>{window.close()},la=()=>{window.location.reload()};return m(()=>{clearInterval(sa)}),(e,o)=>{const l=a,r=s,i=t,c=h,n=g;return p(),d("div",null,[u(l,{title:"YaBandPay"}),u(r,{showLogin:!1}),v("div",z,[v("div",B,[v("div",L,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(f(N).orderSn),1),v("div",U,[j(y(e.$t("应付金额"))+"： ",1),u(i,{modelValue:f(N).amount,"onUpdate:modelValue":o[0]||(o[0]=a=>f(N).amount=a),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",q,["wechat"==f(H)?(p(),d("div",E,y(e.$t("微信支付")),1)):w("",!0),"alipay"==f(H)?(p(),d("div",P,y(e.$t("支付宝支付")),1)):w("",!0),v("div",Q,[v("div",R,[v("div",null,[j(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),v("span",{onClick:la,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),j(y(e.$t("页面重新获取二维码"))+"。 ",1)]),f(aa)<=50?(p(),d("div",D,[u(c,{class:"image",src:f(K)},null,8,["src"])])):(p(),d("div",G,[j(y(e.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:la},y(e.$t("点击刷新")),1)])),v("div",M,["wechat"==f(H)?(p(),d("div",O,y(e.$t("请使用微信扫一扫")),1)):w("",!0),"alipay"==f(H)?(p(),d("div",T,y(e.$t("请使用支付宝扫一扫")),1)):w("",!0),"yunshanfu"==f(H)?(p(),d("div",X,y(e.$t("请使用云闪付扫一扫")),1)):w("",!0),v("div",null,y(e.$t("扫描二维码支付")),1)])]),v("div",Y,["wechat"==f(H)?(p(),d("div",Z,[u(c,{src:f(b)},null,8,["src"])])):w("",!0),"alipay"==f(H)?(p(),d("div",A,[u(c,{src:f(C)},null,8,["src"])])):w("",!0)])]),v("div",{onClick:oa,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-0dc2abed"]]);export{F as default};

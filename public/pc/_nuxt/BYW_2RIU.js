import{b as e}from"./BAtlsuzY.js";import{_ as l}from"./IO9hpqeh.js";import{_ as a}from"./CfxJu6rg.js";import{_ as o}from"./BR_yKGQj.js";import{_ as t}from"./BPBPggU1.js";import{a2 as s,K as i,bS as n,L as r,M as d,dz as u,bR as c,dA as m,N as v,e as p,O as f,P as b,r as h,v as y,bx as x,bi as g,bK as V,a1 as w,H as j,c as k,o as I,i as C,F as T,m as $,x as S,j as _,b as N,w as U,a9 as F,n as O,aJ as P,aa as R,X as A,q as H,t as L,c0 as M,a0 as B,ac as z,z as E,y as J,an as D,ad as q,p as K,a as X,d as W,k as Q,s as Y,E as Z,_ as G}from"./r4GZdGYg.js";import{u as ee,b as le,d as ae,e as oe,f as te}from"./Bd103Yf7.js";import{U as se,C as ie}from"./CIKxL71l.js";import{E as ne}from"./YKVlRHu9.js";import{E as re}from"./5EY5iYNX.js";import{_ as de}from"./DkwXwj3h.js";import{g as ue,u as ce}from"./AMZl9hfR.js";import{U as me}from"./audGqujR.js";import"./CdHUvLv6.js";import"./CDFFSI_k.js";import"./po9zIj7I.js";import"./BNGL4P8m.js";import"./g8XVjk5f.js";import"./CBKhgGlL.js";import"./DXQ6s2L8.js";import"./DONyGZrs.js";import"./DL5ZnEaR.js";import"./VWWcEZs1.js";import"./B0FaLosy.js";/* empty css        */import"./Oz6DVX0g.js";import"./bHTXMzV5.js";import"./70QeHNk8.js";import"./DgAv7tgp.js";import"./DzkGXNvy.js";import"./C4N9DVAQ.js";const ve=i({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:d([Array,Object]),default:()=>r(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:d([Array,Object]),default:()=>[u,u,u]},voidIcon:{type:c,default:()=>m},disabledVoidIcon:{type:c,default:()=>u},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:d(Array),default:()=>r(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:n,clearable:Boolean,...ee(["ariaLabel"])}),pe={[ie]:e=>s(e),[se]:e=>s(e)},fe=p({name:"ElRate"});const be=z(v(p({...fe,props:ve,emits:pe,setup(e,{expose:l,emit:a}){const o=e;function t(e,l){const a=e=>g(e),o=Object.keys(l).map(e=>+e).filter(o=>{const t=l[o];return!!a(t)&&t.excluded?e<o:e<=o}).sort((e,l)=>e-l),t=l[o[0]];return a(t)&&t.value||t}const s=f(oe,void 0),i=f(te,void 0),n=le(),r=b("rate"),{inputId:d,isLabeledByFormItem:u}=ae(o,{formItemContext:i}),c=h(o.modelValue),m=h(-1),v=h(!0),p=y(()=>[r.b(),r.m(n.value)]),z=y(()=>o.disabled||(null==s?void 0:s.disabled)),E=y(()=>r.cssVarBlock({"void-color":o.voidColor,"disabled-void-color":o.disabledVoidColor,"fill-color":K.value})),J=y(()=>{let e="";return o.showScore?e=o.scoreTemplate.replace(/\{\s*value\s*\}/,z.value?`${o.modelValue}`:`${c.value}`):o.showText&&(e=o.texts[Math.ceil(c.value)-1]),e}),D=y(()=>100*o.modelValue-100*Math.floor(o.modelValue)),q=y(()=>x(o.colors)?{[o.lowThreshold]:o.colors[0],[o.highThreshold]:{value:o.colors[1],excluded:!0},[o.max]:o.colors[2]}:o.colors),K=y(()=>{const e=t(c.value,q.value);return g(e)?"":e}),X=y(()=>{let e="";return z.value?e=`${D.value}%`:o.allowHalf&&(e="50%"),{color:K.value,width:e}}),W=y(()=>{let e=x(o.icons)?[...o.icons]:{...o.icons};return e=V(e),x(e)?{[o.lowThreshold]:e[0],[o.highThreshold]:{value:e[1],excluded:!0},[o.max]:e[2]}:e}),Q=y(()=>t(o.modelValue,W.value)),Y=y(()=>z.value?w(o.disabledVoidIcon)?o.disabledVoidIcon:V(o.disabledVoidIcon):w(o.voidIcon)?o.voidIcon:V(o.voidIcon)),Z=y(()=>t(c.value,W.value));function G(e){const l=z.value&&D.value>0&&e-1<o.modelValue&&e>o.modelValue,a=o.allowHalf&&v.value&&e-.5<=c.value&&e>c.value;return l||a}function ee(e){o.clearable&&e===o.modelValue&&(e=0),a(se,e),o.modelValue!==e&&a(ie,e)}function ne(e){if(z.value)return;let l=c.value;const t=e.code;return t===B.up||t===B.right?(o.allowHalf?l+=.5:l+=1,e.stopPropagation(),e.preventDefault()):t!==B.left&&t!==B.down||(o.allowHalf?l-=.5:l-=1,e.stopPropagation(),e.preventDefault()),l=l<0?0:l,l=l>o.max?o.max:l,a(se,l),a(ie,l),l}function re(e,l){if(!z.value){if(o.allowHalf&&l){let a=l.target;M(a,r.e("item"))&&(a=a.querySelector(`.${r.e("icon")}`)),(0===a.clientWidth||M(a,r.e("decimal")))&&(a=a.parentNode),v.value=2*l.offsetX<=a.clientWidth,c.value=v.value?e-.5:e}else c.value=e;m.value=e}}function de(){z.value||(o.allowHalf&&(v.value=o.modelValue!==Math.floor(o.modelValue)),c.value=o.modelValue,m.value=-1)}return j(()=>o.modelValue,e=>{c.value=e,v.value=o.modelValue!==Math.floor(o.modelValue)}),o.modelValue||a(se,0),l({setCurrentValue:re,resetCurrentValue:de}),(e,l)=>{var a;return I(),k("div",{id:_(d),class:S([_(p),_(r).is("disabled",_(z))]),role:"slider","aria-label":_(u)?void 0:e.ariaLabel||"rating","aria-labelledby":_(u)?null==(a=_(i))?void 0:a.labelId:void 0,"aria-valuenow":c.value,"aria-valuetext":_(J)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:H(_(E)),onKeydown:ne},[(I(!0),k(T,null,$(e.max,(e,l)=>(I(),k("span",{key:l,class:S(_(r).e("item")),onMousemove:l=>re(e,l),onMouseleave:de,onClick:l=>{return a=e,void(z.value||(o.allowHalf&&v.value?ee(c.value):ee(a)));var a}},[N(_(A),{class:S([_(r).e("icon"),{hover:m.value===e},_(r).is("active",e<=c.value)])},{default:U(()=>[G(e)?C("v-if",!0):(I(),k(T,{key:0},[F((I(),O(P(_(Z)),null,null,512)),[[R,e<=c.value]]),F((I(),O(P(_(Y)),null,null,512)),[[R,!(e<=c.value)]])],64)),G(e)?(I(),k(T,{key:1},[(I(),O(P(_(Y)),{class:S([_(r).em("decimal","box")])},null,8,["class"])),N(_(A),{style:H(_(X)),class:S([_(r).e("icon"),_(r).e("decimal")])},{default:U(()=>[(I(),O(P(_(Q))))]),_:1},8,["style","class"])],64)):C("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),e.showText||e.showScore?(I(),k("span",{key:0,class:S(_(r).e("text")),style:H({color:e.textColor})},L(_(J)),7)):C("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}}),[["__file","rate.vue"]])),he={class:"container flex"},ye={class:"menu"},xe={class:"info-row"},ge={class:"collection"},Ve={class:"nav"},we={class:"collection-list-tag"},je={key:0,class:"white-card"},ke={class:"product-left"},Ie=["src"],Ce={style:{"line-height":"2"}},Te={class:"product-right"},$e={class:"lab-text"},Se={key:0},_e={class:"tips"},Ne={class:"lab-text"},Ue={key:0,class:"label-list"},Fe=["onClick"],Oe=["onClick"],Pe={key:1,class:"label-edit-input"},Re=["onClick"],Ae={key:1,class:"label-list"},He={class:"label-item-txt"},Le={class:"lab-text"},Me={key:1},Be={class:"tips"},ze={class:"lab-text"},Ee={key:1},Je=G(p({__name:"Info",setup(s){const{t:i}=E();h(999),h(0);const n=h(["1分","2分","3分","4分","5分"]),r=h(!0),d=h(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),u=h([]);J(()=>{c()});const c=async()=>{try{u.value=[];const e=await ue({id:m.currentRoute.value.query.id});e.items.map(e=>{e.allCommentTag=JSON.parse(JSON.stringify(d.value)),Object.assign(e,{commentRank:0,content:"",showPics:[],commentTag:[],isAdd:!1,rankVerification:!0,contentVerification:!0,isCommentInfo:!!e.commentInfo},e.commentInfo)}),Object.assign(u.value,e.items);u.value.every(e=>1===e.isShowed)&&q("/member/comment/list?orderType=2")}catch(e){K.error(e.message)}finally{r.value=!1}},m=D(),v=h(""),p=(e,l)=>{let a=u.value[e].commentTag;a.includes(l)?u.value[e].commentTag=a.filter(e=>e!==l):a.push(l)};return(s,r)=>{const d=e,m=l,f=a,b=o,h=t,y=be,x=ne,g=Z,V=re,w=de;return I(),k(T,null,[N(d),N(m,{title:"评价晒单"}),X("div",he,[X("div",ye,[N(f)]),X("div",xe,[X("div",ge,[X("div",Ve,[X("div",we,L(s.$t("订单评价")),1),X("div",null,[W(L(s.$t("评价立送")),1),r[1]||(r[1]=X("span",{class:"font-color"},"5",-1)),W(L(s.$t("积分"))+"，"+L(s.$t("晒单额外赠送")),1),r[2]||(r[2]=X("span",{class:"font-color"},"5",-1)),W(L(s.$t("积分")),1)])]),(I(!0),k(T,null,$(u.value,(e,l)=>(I(),k("div",null,[e.isShowed?C("",!0):(I(),k("div",je,[X("div",ke,[N(h,{title:e.productName,to:("urlFormat"in s?s.urlFormat:_(Y))({path:"product",id:e.productId,sn:e.productSn}),class:"nuxt",target:"_blank"},{default:U(()=>[X("div",null,[X("img",{alt:"",src:("imageFormat"in s?s.imageFormat:_(Q))(e.picThumb)},null,8,Ie)]),X("div",null,[X("div",Ce,[X("a",null,L(e.productName),1)]),X("div",null,[N(b,{modelValue:e.price,"onUpdate:modelValue":l=>e.price=l,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1032,["title","to"])]),X("div",Te,[X("div",null,[X("span",$e,L(s.$t("商品评分"))+"：",1),X("span",null,[N(y,{disabled:e.isCommentInfo,modelValue:e.commentRank,"onUpdate:modelValue":l=>e.commentRank=l,size:"large",texts:n.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),e.rankVerification?C("",!0):(I(),k("div",Se,[r[3]||(r[3]=X("span",{class:"lab-text"},null,-1)),X("p",_e,L(s.$t("请先评价商品")),1)])),X("div",null,[X("div",Ne,L(s.$t("评价标签"))+"：",1),e.isCommentInfo?(I(),k("div",Ae,[(I(!0),k(T,null,$(e.commentTag,e=>(I(),k("div",He,[X("span",null,L(e),1)]))),256))])):(I(),k("div",Ue,[(I(!0),k(T,null,$(e.allCommentTag,a=>(I(),k("div",{style:H({border:e.commentTag.includes(a)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:e=>p(l,a)},[X("span",null,L(s.$t(a)),1)],12,Fe))),256)),e.isAdd?(I(),k("div",Pe,[X("div",null,[N(x,{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=e=>v.value=e),autofocus:""},null,8,["modelValue"])]),X("p",{onClick:e=>(e=>{if(""!==v.value){const l=JSON.parse(JSON.stringify(u.value[e].allCommentTag));l.push(v.value),u.value[e].allCommentTag=l,p(e,v.value)}v.value="",u.value[e].isAdd=!1})(l)},L(s.$t("确定")),9,Re)])):(I(),k("div",{key:0,class:"label-edit",onClick:e=>(e=>{u.value[e].isAdd=!u.value[e].isAdd})(l)},[r[4]||(r[4]=X("div",null,null,-1)),X("p",null,L(s.$t("自定义")),1)],8,Oe))]))]),X("div",null,[X("div",Le,L(s.$t("购物心得"))+"：",1),N(x,{class:"label-textarea","show-word-limit":!0,modelValue:e.content,"onUpdate:modelValue":l=>e.content=l,disabled:e.isCommentInfo,rows:5,type:"textarea",maxlength:500,placeholder:s.$t("商品是否给力？快分享你的购买心得吧~")},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])]),e.contentVerification?C("",!0):(I(),k("div",Me,[r[5]||(r[5]=X("span",{class:"lab-text"},null,-1)),X("p",Be,L(s.$t("请填写购买心得")),1)])),X("div",null,[X("div",ze,L(s.$t("晒单"))+"：",1),e.isShowed?(I(),k("div",Ee,[(I(!0),k(T,null,$(e.showPics,e=>(I(),O(g,{src:("imageFormat"in s?s.imageFormat:_(Q))(e.picThumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"]))),256))])):(I(),O(me,{key:0,uploadList:e.showPics,"onUpdate:uploadList":l=>e.showPics=l,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),X("div",null,[N(V,{type:"primary",onClick:l=>(async e=>{if(e.commentRank<1)e.rankVerification=!1;else if(""!=e.content)try{const l={productId:e.productId,orderId:e.orderId,orderItemId:e.itemId,shopId:e.shopId,commentRank:e.commentRank,commentTag:e.commentTag,content:e.content,showPics:e.showPics};await ce(l),e.rankVerification=!0,e.contentVerification=!0,K.success(i("评价成功")),c()}catch(l){K.error(l.message)}else e.contentVerification=!1})(e)},{default:U(()=>[W(L(s.$t("提交评论")),1)]),_:2},1032,["onClick"])])])]))]))),256))])])]),N(w)],64)}}}),[["__scopeId","data-v-c0d68868"]]);export{Je as default};

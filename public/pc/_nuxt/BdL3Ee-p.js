import{_ as H}from"./CBcH1uzJ.js";import{e as q,ax as C,ay as L,c as I,o as p,b as V,_ as K,v as E,r as b,y as Q,i as S,j as n,F as G,m as T,a as u,t as l,x as B,k as W,H as O,G as X,n as x,aA as Y,w as _,d as A}from"./BjkHNVA8.js";import{C as Z}from"./DzWKETDE.js";import{E as ee}from"./B_vjKAZC.js";import{B as te}from"./CWzVxcs9.js";import{E as oe}from"./BsZFmHoh.js";import"./Ibc-iJtI.js";import{E as ue}from"./Xh6SD5hO.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        */import J from"./Bhdvu4cX.js";const re={class:"input-box"},se=q({__name:"InputNumber",props:C({modelValue:{type:Number,default:1},max:Number,min:{type:Number,default:1},step:{type:Number,default:1}},{modelValue:{},modelModifiers:{}}),emits:C(["change"],["update:modelValue"]),setup(e,{emit:c}){const g=e,d=L(e,"modelValue"),i=c,h=m=>{i("change"),(!Number.isInteger(m)||m<1)&&(d.value=g.min)};return(m,k)=>{const t=ue;return p(),I("div",re,[V(t,{modelValue:d.value,"onUpdate:modelValue":k[0]||(k[0]=s=>d.value=s),step:e.step,max:e.max,min:e.min,onChange:h},null,8,["modelValue","step","max","min"])])}}}),M=K(se,[["__scopeId","data-v-8eef1a41"]]),ne={key:0,class:"product-sku-info"},ie={class:"sku-item flex align-start"},ae={class:"tit"},le={class:"sku-tag flex-wrap"},de=["onClick"],ce=["src"],me={__name:"ProductSku",props:{modelValue:{type:Object,default:{}},skuList:{type:Array},checkedValue:{type:Array},productType:{type:String,default:"product"}},emits:["change"],setup(e,{emit:c}){const g=c,d=e,i=E(()=>d.modelValue.spe||[]),h=b(d.checkedValue),m=()=>{if(i.value.length>0){h.value.length==0&&i.value.forEach(s=>{h.value.push(s.attrList[0].attrName+":"+s.attrList[0].attrValue)}),i.value.forEach((s,f)=>{s.attrList.forEach(N=>{h.value[f]&&h.value[f]==N.attrName+":"+N.attrValue?N.checked=!0:N.checked=!1;let a=JSON.parse(JSON.stringify(h.value));a[f]=N.attrName+":"+N.attrValue;let D=d.skuList.find($=>$.skuValue==a.join("|"));N.skuStock=D?D.skuStock:0})});const t=d.skuList.find(s=>s.skuValue==h.value.join("|"));g("change",{skuStock:t&&t.skuStock||0,skuId:t&&t.skuId||0})}else d.skuList.length>0?(g("change",{skuStock:d.skuList[0].skuStock||0,skuId:d.skuList[0].skuId||0}),console.log(selectedItem,"selectedItem2")):g("change",null)};m();const k=(t,s)=>{if(d.productType!="product")return;const f=i.value[t].attrList[s];h.value[t]=f.attrName+":"+f.attrValue,m()};return Q(()=>{m()}),(t,s)=>n(i).length>0?(p(),I("div",ne,[(p(!0),I(G,null,T(n(i),(f,N)=>(p(),I("div",ie,[u("div",ae,l(f.attrName)+"：",1),u("div",le,[(p(!0),I(G,null,T(f.attrList,(a,D)=>(p(),I("div",{class:B({tag:!0,checked:a.checked,disabled:!a.checked&&a.skuStock==0,outstock:a.skuStock==0}),onClick:$=>k(N,D)},[N===0&&a.attrPic?(p(),I("img",{key:0,src:n(W)(a.attrPic),alt:""},null,8,ce)):S("",!0),u("p",null,l(a.attrValue),1),s[0]||(s[0]=u("i",{class:"icon-gou"},null,-1))],10,de))),256))])]))),256))])):S("",!0)}},pe=K(me,[["__scopeId","data-v-0aefdad4"]]),ge={key:0,class:"product-sku-info"},ke={class:"sku-item flex align-start"},fe={class:"tit"},Ne={class:"sku-tag flex-wrap"},ye=["onClick"],ve={__name:"ProductJt",props:C({type:{type:String,default:""}},{groupNums:{default:[{}]},groupNumsModifiers:{},groupNumKey:{},groupNumKeyModifiers:{},currentGroupNum:{},currentGroupNumModifiers:{}}),emits:["update:groupNums","update:groupNumKey","update:currentGroupNum"],setup(e){const c=L(e,"groupNums"),g=L(e,"groupNumKey"),d=L(e,"currentGroupNum"),i=e;O(()=>g,m=>{c.value.forEach(k=>{k.checked=k.groupNumKey===g.value})},{deep:!0,immediate:!0});const h=(m,k)=>{m.groupNumKey!==g.value&&i.type==="invited"||(c.value.forEach((t,s)=>{t.checked=!1}),m.checked=!0,g.value=m?.groupNumKey,d.value=m?.groupNum)};return(m,k)=>c.value.length>0?(p(),I("div",ge,[u("div",ke,[u("div",fe,l(m.$t("阶梯"))+"：",1),u("div",Ne,[(p(!0),I(G,null,T(c.value,(t,s)=>(p(),I("div",{class:B({tag:!0,checked:t.checked,disabled:!t.checked&&e.type==="invited"}),onClick:f=>h(t)},[u("p",null,l(t.groupNum)+l(m.$t("人团")),1),k[0]||(k[0]=u("i",{class:"icon-gou"},null,-1))],10,ye))),256))])])])):S("",!0)}},he=K(ve,[["__scopeId","data-v-1d9b6467"]]),Ie={class:"product_joining"},De={class:"productName"},Ve={class:"name"},be={class:"active-box flex justify-between"},Pe={class:"active-ico flex align-center"},_e={class:"text"},Se={key:0,class:"group-num"},$e={class:"active-time"},Le={class:"joiningPrice"},xe={class:"joiningPriceLine"},Ce={class:"toJoiningListHeader"},Ke={class:"total"},Ae={class:"btns"},Ee={class:"number-box"},Ge={class:"title"},Te={class:"con"},je={class:"flex",style:{"margin-left":"10px"}},we=q({__name:"ProductJoining",props:C({product:{type:Object,default:()=>({})},skuList:{type:Array,default:()=>[]},checkedValue:{type:Array,default:()=>[]},productType:{type:String,default:"product"},grouponDetail:{type:Object,default:()=>({})},type:{type:String,default:""}},{attrList:{},attrListModifiers:{}}),emits:["update:attrList"],setup(e){const c=b(1),g=L(e,"attrList"),d=b(!1),i=X(),{grouponPromotionItemId:h,productSn:m,type:k}=i.query,t=e,s=b(null),f=b(null),N=b(0);b([]),O(()=>t.grouponDetail,o=>{if(console.log(o,"value"),o){const r=o.groupNums.findIndex(y=>y.checked);s.value=o.groupNums?.[r>=0?r:0]?.groupNumKey||null,f.value=o.groupNums?.[r>=0?r:0]?.groupNum||null,N.value=o.joinNumCount}},{deep:!0,immediate:!0});const a=b(null),D=E(()=>{if(!t.grouponDetail)return"";if(t.grouponDetail.groupNums.length&&a.value){const o=t.grouponDetail.grouponPromotionDetails.find(P=>P.skuId===+a.value);return JSON.parse(o?.groupPrice||"[]")?.find(P=>P.groupNumKey===s.value)?.price||t.grouponDetail?.minGrouponPrice}if(t.grouponDetail.groupNums.length&&!a.value)return JSON.parse(t.grouponDetail.grouponPromotionDetails[0]?.groupPrice||"[]")?.find(y=>y.groupNumKey===s.value)?.price||t.grouponDetail?.minGrouponPrice;if(!t.grouponDetail.groupNums.length)return JSON.parse(t.grouponDetail.grouponPromotionDetails[0]?.groupPrice||"[]")[0]?.price||t.grouponDetail?.minGrouponPrice}),$=E(()=>{const o=t.grouponDetail?.orderLimitNum;if(t.grouponDetail?.groupType===2){const y=t.grouponDetail?.grouponPromotionDetails?.find(P=>P.skuId===+a.value)?.limitNum||t.grouponDetail?.grouponPromotionDetails?.[0]?.limitNum;return o&&o>0?Math.min(y||0,o):y}else return o||0}),U=o=>{a.value=o.skuId+"",g.value.spe.forEach(r=>{r.attrList.forEach(y=>{y.checked&&o.skuStock===y.skuStock&&(y.skuId=o.skuId)})})},R=()=>{d.value=!0};return(o,r)=>{const y=H,P=pe,F=he,j=ee,w=te,z=oe;return p(),I("div",Ie,[u("div",De,[r[7]||(r[7]=u("div",{class:"tagName"},"拼团",-1)),u("div",Ve,l(o.$t(e.product.productName)),1)]),u("div",be,[u("div",Pe,[u("div",_e,l(o.$t("拼团优惠")),1),e.grouponDetail?.minGroupNum?(p(),I("div",Se,l(f.value)+l(o.$t("人团")),1)):S("",!0)]),u("div",$e,[V(n(Z),{"countdown-type":"specifyTime","specify-time":new Date(e.grouponDetail?.endTime)?.getTime()},null,8,["specify-time"])])]),u("div",Le,[u("div",xe,[u("span",null,l(o.$t("拼团价"))+"：",1),V(y,{decimalsStyle:{fontSize:"14px",alignSelf:"self-end"},class:"priceBox",modelValue:n(D),"onUpdate:modelValue":r[0]||(r[0]=v=>Y(D)?D.value=v:null)},null,8,["modelValue"])]),u("div",null,l(o.$t("已成团"))+"："+l(e.grouponDetail?.groupSuccessCount===0||e.grouponDetail?.groupSuccessCount?e.grouponDetail?.groupSuccessCount:"--"),1)]),V(J,{class:"toJoiningListScroll",extraAttrIds:a.value,productId:e.product.productId,productNumber:c.value,skuId:n(i).query.skuId?Number(n(i).query.skuId):void 0,grouponDetail:{...e.grouponDetail,groupNumKey:s.value,price:n(D)}},{header:_(()=>[u("div",Ce,[u("div",Ke,l(N.value?N.value:0)+l(o.$t("人在拼单，可直接参与")),1),u("div",{class:"more",onClick:R},[A(l(o.$t("查看更多"))+" ",1),r[8]||(r[8]=u("i",{class:"iconfont-pc icon-a-right-arrow"},null,-1))])])]),_:1},8,["extraAttrIds","productId","productNumber","skuId","grouponDetail"]),e.skuList.length>0?(p(),x(P,{key:0,style:{padding:"0"},modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=v=>g.value=v),skuList:e.skuList,checkedValue:e.checkedValue,productType:e.productType,onChange:U},null,8,["modelValue","skuList","checkedValue","productType"])):S("",!0),e.grouponDetail?.groupNums&&e.grouponDetail?.groupNums?.length>0&&e.grouponDetail?.groupType===2?(p(),x(F,{key:1,groupNums:e.grouponDetail.groupNums,"onUpdate:groupNums":r[2]||(r[2]=v=>e.grouponDetail.groupNums=v),groupNumKey:s.value,"onUpdate:groupNumKey":r[3]||(r[3]=v=>s.value=v),currentGroupNum:f.value,type:n(k)},null,8,["groupNums","groupNumKey","currentGroupNum","type"])):S("",!0),u("div",Ae,[u("div",Ee,[u("div",Ge,l(o.$t("数量"))+"：",1),u("div",Te,[n($)?(p(),x(n(M),{key:0,modelValue:c.value,"onUpdate:modelValue":r[4]||(r[4]=v=>c.value=v),max:n($)},null,8,["modelValue","max"])):(p(),x(n(M),{key:1,modelValue:c.value,"onUpdate:modelValue":r[5]||(r[5]=v=>c.value=v)},null,8,["modelValue"])),u("div",je,l(o.$t("件")),1)])]),V(w,{extraAttrIds:a.value,id:e.product.productId,skuId:Number(n(i).query.skuId),number:c.value,isQuick:!0},{default:_(()=>[V(j,{class:"soloBuy btn",type:"primary"},{default:_(()=>[A(l(o.$t("单独购买")),1)]),_:1})]),_:1},8,["extraAttrIds","id","skuId","number"]),V(w,{extraAttrIds:a.value,id:e.product.productId,skuId:n(i).query.skuId?Number(n(i).query.skuId):void 0,number:c.value,isQuick:!0,grouponDetail:{...e.grouponDetail,groupNumKey:s.value,price:n(D),grouponPromotionRecordId:n(i).query.grouponPromotionRecordId?Number(n(i).query.grouponPromotionRecordId):0}},{default:_(()=>[V(j,{class:"startAGroup btn",type:"primary"},{default:_(()=>[A(l(n(k)==="invited"?o.$t("参与拼团"):o.$t("我要开团")),1)]),_:1})]),_:1},8,["extraAttrIds","id","skuId","number","grouponDetail"])]),V(z,{title:o.$t("更多拼团"),modelValue:d.value,"onUpdate:modelValue":r[6]||(r[6]=v=>d.value=v),width:"20%"},{default:_(()=>[V(J,{extraAttrIds:a.value,productId:e.product.productId,productNumber:c.value,skuId:n(i).query.skuId?Number(n(i).query.skuId):void 0,grouponDetail:{...e.grouponDetail,groupNumKey:s.value,price:n(D)},isMore:!0},null,8,["extraAttrIds","productId","productNumber","skuId","grouponDetail"])]),_:1},8,["title","modelValue"])])}}}),Je=K(we,[["__scopeId","data-v-5820e035"]]),Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"}));export{M as I,Je as P,pe as _,Ze as a};

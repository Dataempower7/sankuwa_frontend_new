import{_ as U}from"./Drr4mNEN.js";import{_ as z}from"./paAvucAg.js";import{_ as N}from"./CBcH1uzJ.js";import{e as T,G as q,r as i,z as L,y as M,p as g,ah as I,T as Q,c as s,o as n,b as c,a as o,t,j as a,d as _,i as l,E as D,_ as F}from"./BjkHNVA8.js";import{_ as H}from"./B85mN9rA.js";import{E as j}from"./Csy7st1x.js";import"./B_vjKAZC.js";/* empty css        */import"./Ibc-iJtI.js";import{Q as G}from"./OUv6bgZh.js";import{w as W,z as Y}from"./DzflT03m.js";import{e as A,f as J,d as K}from"./CfoQFCHA.js";import{s as X}from"./x_rD_Ya3.js";import"./XdJ5ILcf.js";import"./BipSnJcb.js";import"./n1vI1_Nv.js";import"./BNVM5YSV.js";import"./BhwkTUtM.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";const Z={class:"wechat-com"},x={class:"wechat container"},ee={class:"message"},te={class:"message"},oe={class:"payment"},ae={key:0,class:"title"},se={key:1,class:"title"},ne={class:"image-div"},re={class:"left-image"},ie={key:0,class:"ewm"},ce={key:1,class:"ewm-empty"},le={class:"pw-box-ft"},de={key:0},me={key:1},pe={key:2},ue={class:"right-image"},_e={key:0,class:"image"},ye={key:1,class:"image"},fe=T({__name:"yabanpay",setup(he){const w=q(),y=i(w.query.id),r=i(w.query.type),k=i(!0);i({});const $=i(""),d=i({orderSn:"",amount:0}),{t:m}=L();(async()=>{try{const e=await J({orderId:y.value});d.value=e.order}catch(e){g.error(e.message),I("/member/account/detail")}finally{}})();const b=async()=>{k.value=!0;try{const e=await K({id:y.value,type:"yabanpay_"+r.value});B(e?.payInfo.codeUrl)}catch(e){g.error(e.message)}finally{k.value=!1}},f=i(0);let p=null;M(()=>{b(),p=X(()=>{P(),f.value++,f.value===50&&(clearInterval(p),g.error(m("支付已超时，您可以刷新页面重新支付")))},2e3)});const P=()=>{A({id:y.value}).then(e=>{e==1&&(clearInterval(p),j.confirm(m("订单支付成功"),m("提示"),{confirmButtonText:m("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{I("/member/account/detail")}).catch(()=>{}))})},B=async e=>{const u=e;let h={margin:1,width:500,height:500};$.value=await G.toDataURL(u,h)},S=()=>{window.close()},C=()=>{window.location.reload()};return Q(()=>{clearInterval(p)}),(e,u)=>{const h=U,V=z,R=N,v=D,E=H;return n(),s("div",null,[c(h,{title:"YaBandPay"}),c(V,{showLogin:!1}),o("div",Z,[o("div",x,[o("div",ee,t(e.$t("订单提交成功，请尽快付款"))+"！"+t(e.$t("订单号"))+"："+t(a(d).orderSn),1),o("div",te,[_(t(e.$t("应付金额"))+"： ",1),c(R,{modelValue:a(d).amount,"onUpdate:modelValue":u[0]||(u[0]=O=>a(d).amount=O),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),o("div",oe,[a(r)=="wechat"?(n(),s("div",ae,t(e.$t("微信支付")),1)):l("",!0),a(r)=="alipay"?(n(),s("div",se,t(e.$t("支付宝支付")),1)):l("",!0),o("div",ne,[o("div",re,[o("div",null,[_(t(e.$t("如果二维码已过期"))+"，"+t(e.$t("请")),1),o("span",{onClick:C,class:"font-color",style:{cursor:"pointer"}},t(e.$t("刷新")),1),_(t(e.$t("页面重新获取二维码"))+"。 ",1)]),a(f)<=50?(n(),s("div",ie,[c(v,{class:"image",src:a($)},null,8,["src"])])):(n(),s("div",ce,[_(t(e.$t("已超时"))+"，",1),o("a",{class:"font-color",onClick:C},t(e.$t("点击刷新")),1)])),o("div",le,[a(r)=="wechat"?(n(),s("div",de,t(e.$t("请使用微信扫一扫")),1)):l("",!0),a(r)=="alipay"?(n(),s("div",me,t(e.$t("请使用支付宝扫一扫")),1)):l("",!0),a(r)=="yunshanfu"?(n(),s("div",pe,t(e.$t("请使用云闪付扫一扫")),1)):l("",!0),o("div",null,t(e.$t("扫描二维码支付")),1)])]),o("div",ue,[a(r)=="wechat"?(n(),s("div",_e,[c(v,{src:a(W)},null,8,["src"])])):l("",!0),a(r)=="alipay"?(n(),s("div",ye,[c(v,{src:a(Y)},null,8,["src"])])):l("",!0)])]),o("div",{onClick:S,class:"button-title"},"< "+t(e.$t("选择其他支付方式")),1)])])]),c(E,{bg:"white",mt30:!1,type:1})])}}}),je=F(fe,[["__scopeId","data-v-0dc2abed"]]);export{je as default};

import{_ as s}from"./IO9hpqeh.js";import{_ as a}from"./Dw0vWOz4.js";import{_ as t}from"./BR_yKGQj.js";import{e as o,G as e,v as l,r,z as i,y as c,p as n,ad as m,R as d,c as p,o as v,b as u,a as j,t as f,d as w,j as y,E as h,_ as g}from"./r4GZdGYg.js";import{_ as $}from"./DkwXwj3h.js";import{E as _}from"./Oz6DVX0g.js";import"./5EY5iYNX.js";import"./YKVlRHu9.js";import"./bHTXMzV5.js";import{Q as b}from"./xSPxQ0UB.js";import{e as k,f as C,d as I}from"./IbbeVozb.js";import{s as x}from"./DSXY0Md2.js";import"./70QeHNk8.js";import"./BPBPggU1.js";import"./CDFFSI_k.js";import"./DgAv7tgp.js";import"./g8XVjk5f.js";import"./BNGL4P8m.js";import"./Bd103Yf7.js";import"./CIKxL71l.js";import"./DL5ZnEaR.js";import"./VWWcEZs1.js";const L={class:"wechat-com"},S={class:"wechat container"},U={class:"message"},V={class:"message"},z={class:"payment"},B={class:"title"},E={class:"image-div"},Q={class:"left-image"},R={key:0,class:"ewm"},q={key:1,class:"ewm-empty"},D={class:"pw-box-ft"},G=g(o({__name:"wechat",setup(o){const g=e(),G=l(()=>g.query.id),M=r(!0);r({});const O=r(""),P=r({amount:0});(async()=>{try{const s=await C({orderId:G.value});P.value=s.order}catch(s){n.error(s.message)}})();const{t:T}=i(),X=r(0);let Z=null;c(()=>{(async()=>{M.value=!0;try{const s=await I({id:G.value,type:"wechat"});await F(null==s?void 0:s.payInfo.codeUrl)}catch(s){n.error(s.message)}finally{M.value=!1}})(),Z=x(()=>{A(),X.value++,50===X.value&&(clearInterval(Z),n.error(T("支付已超时，您可以刷新页面重新支付")))},2e3)});const A=()=>{k({id:G.value}).then(s=>{1==s&&(clearInterval(Z),_.confirm(T("充值成功"),T("提示"),{confirmButtonText:T("查看充值详情"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{m("/member/account/log")}).catch(()=>{}))})},F=async s=>{const a=s;O.value=await b.toDataURL(a,{margin:1,width:500,height:500})},H=()=>{window.close()},J=()=>{window.location.reload()};return d(()=>{clearInterval(Z)}),(o,e)=>{const l=s,r=a,i=t,c=h,n=$;return v(),p("div",null,[u(l,{title:"微信支付"}),u(r,{showLogin:!1}),j("div",L,[j("div",S,[j("div",U,f(o.$t("订单提交成功，请尽快付款")),1),j("div",V,[w(f(o.$t("应付金额"))+"： ",1),u(i,{modelValue:y(P).amount,"onUpdate:modelValue":e[0]||(e[0]=s=>y(P).amount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),j("div",z,[j("div",B,f(o.$t("微信支付")),1),j("div",E,[j("div",Q,[j("div",null,[w(f(o.$t("如果二维码已过期"))+"，",1),j("span",{onClick:J,class:"font-color",style:{cursor:"pointer"}},f(o.$t("刷新")),1),w(f(o.$t("重新获取二维码"))+"。 ",1)]),y(X)<=50?(v(),p("div",R,[u(c,{class:"image",src:y(O)},null,8,["src"])])):(v(),p("div",q,[w(f(o.$t("已超时"))+"，",1),j("a",{class:"font-color",onClick:J},f(o.$t("点击刷新")),1)])),j("div",D,[j("div",null,f(o.$t("请使用微信扫一扫")),1),j("div",null,f(o.$t("扫描二维码支付")),1)])]),e[1]||(e[1]=j("div",{class:"right-image"},[j("div",{class:"image"})],-1))]),j("div",{onClick:H,class:"button-title"},"< "+f(o.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-063ab991"]]);export{G as default};

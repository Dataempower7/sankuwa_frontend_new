import{_ as ct}from"./Drr4mNEN.js";import{E as rt}from"./B_vjKAZC.js";import{_ as ut}from"./BipSnJcb.js";import{E as mt}from"./HneMuvcA.js";import{_ as _t}from"./CBcH1uzJ.js";import{e as vt,f as ht,z as ft,r as y,y as R,ak as pt,B as kt,c as i,o as a,b as r,i as u,n as W,a as t,t as l,w as x,d as h,F as C,m as V,j as b,al as yt,x as U,s as L,k as O,E as gt,am as Ct,p as N,an as j,ao as Y,ap as Vt,ah as bt,aq as $t,_ as wt}from"./BjkHNVA8.js";import{_ as xt}from"./CM_M6Xgj.js";import{_ as Tt}from"./B85mN9rA.js";import"./DWKyHDnW.js";import Dt from"./BHDQHaYT.js";import Ut from"./D3Ah-7xg.js";import Et from"./BPHs5Elj.js";import{E as St}from"./D0QC44yL.js";import"./XdJ5ILcf.js";import"./CXwPJP5h.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./n1vI1_Nv.js";import"./ClRMjIOJ.js";import"./FYm-MTMW.js";import"./cfDoaBtk.js";import"./C1B8-dXF.js";import"./Bnvi_g-K.js";import"./yB3A8U-z.js";import"./UVx7YjW9.js";import"./BzIkMksr.js";/* empty css        */import"./BNVM5YSV.js";import"./CWzVxcs9.js";import"./CQ93QHlZ.js";/* empty css        */import"./D5AuvtSp.js";const Ft={style:{"background-color":"#f2f3f5"}},At={key:0,class:"container"},It={class:"no_goods clearfix"},Bt={class:"left main"},Lt={class:"strong"},Ot={key:1,class:"container"},Nt={class:"cart-tit"},jt={class:"cart-head"},Pt={class:"product-list-cart flex"},qt={class:"item col-1 center"},zt={class:"item col-1",style:{"justify-content":"left"}},Ht={class:"item col-3",style:{"justify-content":"left"}},Mt={class:"item col-2 center"},Rt={class:"item col-2 center"},Wt={class:"item col-2 center"},Yt={class:"item col-2 center"},Gt={class:"cart_table"},Jt={class:"cart_store_title flex"},Kt={class:"item col-1 center"},Qt={class:"item col-3 flex align-center"},Xt={key:0,class:"tag"},Zt={key:1,class:"tit"},te={class:"cart_list_wrap"},ee={class:"product-item flex"},se={class:"item col-1 center flex align-center justify-center"},oe={class:"item col-4 flex"},le={class:"pic"},ae=["href"],ie=["src"],ne={key:1},de=["src"],ce={key:2,class:"disabled"},re={key:0},ue={class:"name pt5"},me=["href"],_e={key:1},ve={class:"info"},he={key:2,class:"extraskudata"},fe={class:"title"},pe={class:"content"},ke={class:"content-text"},ye={class:"num"},ge={key:3,class:"promotion-box"},Ce={key:0,class:"promotion"},Ve={class:"ticket-content"},be={key:1,class:"promotion"},$e={class:"ticket-type"},we={class:"ticket-content"},xe={class:"item col-2 center"},Te={class:"price pt5 center-price"},De={class:"item col-2 center"},Ue={class:"pt5 flex justify-center"},Ee={class:"item col-2 center"},Se={class:"money pt5"},Fe={class:"item col-2 center"},Ae=["onClick"],Ie={key:0,class:"gift-box"},Be={class:"gift-title"},Le={class:"gift-content"},Oe={class:"gift-content-item"},Ne={class:"gift-item-left"},je={class:"gift-item-right"},Pe={class:"gift-item-name"},qe={key:0,class:"sku-card"},ze={class:"gift-item-num"},He={class:"pay_tools_inner flex justify-between align-center container"},Me={class:"pay_tools_l flex align-center"},Re={class:"item col-1 center"},We={class:"pay_txt_row flex"},Ye={class:"font-color"},Ge={class:"pay_tools_r flex align-center"},Je={class:"pay_tools_total_box"},Ke={class:"flex align-center justify-end"},Qe={class:"r_prod_view"},Xe={class:"font-color"},Ze={class:"r_price_total"},ts={class:"tit"},es={class:"discounts-btn-box"},ss={class:"discounts-btn"},os={class:"discount"},ls={class:"discount-title"},as={class:"title-text"},is={class:"discount-content"},ns={class:"discount-item-box"},ds={class:"item-label"},cs={class:"item-value"},rs={key:0,class:"discount-item-box"},us={class:"item-label"},ms={class:"item-value"},_s={class:"discount-item-box"},vs={class:"item-label"},hs={class:"item-value discounts-value",style:{color:"var(--general)"}},fs={key:0,class:"sub-item-box"},ps={class:"sub-item-label"},ks={class:"sub-item-value discounts-value"},ys={key:1,class:"discount-detail"},gs={class:"sub-item-label"},Cs={class:"sub-item-value discounts-value"},Vs={class:"discount-item-box"},bs={class:"item-label"},$s={class:"item-value"},ws={class:"discount-desc"},xs={key:3},Ts=vt({__name:"index",setup(Ds){const G=ht(),{t:_}=ft(),T=y(!0),f=y([]),c=y({}),P=y(!1),q=y();R(()=>{g()});const E=e=>e.productStatus==0||e.stock==0||e.isDisabled==!0,g=async()=>{try{q.value=St.service({lock:!1,text:_("请求加载中"),customClass:"tig-normal-loading"});const e=await pt();f.value=e.cartList,c.value=e.total,A()}catch{}finally{T.value=!1,q.value.close(),P.value=!0}},S=async()=>{try{const e=[];f.value.forEach(m=>{m.carts.forEach(v=>{e.push({cartId:v.cartId,isChecked:v.isChecked&&v.isDisabled===!1?1:0})})});const s=await $t({data:e});g()}catch{}finally{}},J=e=>{K(e)};let F;const K=e=>{F&&clearTimeout(F),F=setTimeout(()=>{Q(e)},300)},Q=async e=>{try{await Ct(e.cartId,{quantity:e.quantity}),g()}catch(s){console.log(s),N.error(s.message),g()}},X=e=>{j.confirm({title:_("确认要删除该商品吗"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=await Y([e]);g()}catch{}finally{}}})},Z=()=>{let e=0;f.value.forEach(s=>{s.carts.forEach(m=>{m.isChecked==!0&&(e+=1)})}),e!=0?j.confirm({title:_("确认要删除指定的商品吗"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=[];f.value.forEach(v=>{v.carts.forEach(k=>{k.isChecked&&s.push(k.cartId)})});const m=await Y(s);await g()}catch{}finally{}}}):N.error(_("您还未选中任何商品"))},tt=()=>{j.confirm({title:_("确认要清空购物车吗？"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const e=await Vt();await g()}catch{}finally{}}})},et=()=>{S()},z=()=>{f.value.forEach(e=>{e.carts.forEach(s=>{s.isChecked=$.value==!0&&s.isDisabled===!1})}),A(),S()},st=e=>{e.carts.forEach(s=>{s.isChecked=e.isChecked==!0}),A(),S()},$=y(!1),A=()=>{f.value.forEach(e=>{const s=e.carts.filter(m=>!m.isDisabled);e.isChecked=s.every(m=>m.isChecked===!0&&!m.isDisabled)}),$.value=f.value.every(e=>e.isChecked===!0)},H=y(null),M=y(!1),I=()=>{const e=window.scrollY,s=window.innerHeight,v=H.value?.getBoundingClientRect()?.top+e;M.value=!(e+s-60>v)},ot={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},lt=e=>{const s=[],m=e.filter(k=>k.type===2),v=e.filter(k=>k.type!==2);return v.length>0&&s.push(v[0]),m.length>0&&s.push(m[0]),s},B=y(!1);R(()=>{window.addEventListener("scroll",I),I()}),kt(()=>{window.removeEventListener("scroll",I)});const at=()=>{if(G.closeOrder===1)return N.error(_("商城已关闭下单"));bt("/order/check/")};return(e,s)=>{const m=ct,v=rt,k=ut,D=mt,p=_t,it=gt,nt=xt,dt=Tt;return a(),i("div",Ft,[r(m,{title:"购物车"}),r(Dt,{step:1}),!T.value&&f.value.length===0?(a(),i("div",At,[t("div",It,[s[13]||(s[13]=t("div",{class:"left icon"},null,-1)),t("div",Bt,[t("div",Lt,l(e.$t("您的购物车中暂时没有商品"))+"！",1),r(k,{to:"/"},{default:x(()=>[r(v,{type:"primary",size:"large",title:e.$t("马上挑选商品")},{default:x(()=>[h(l(e.$t("去逛逛")),1)]),_:1},8,["title"])]),_:1})])])])):u("",!0),!T.value&&f.value.length>0?(a(),i("div",Ot,[t("p",Nt,l(e.$t("你好，欢迎来到您的购物车")),1),t("div",null,[t("div",jt,[t("div",Pt,[t("div",qt,[r(D,{modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=n=>$.value=n),onChange:z},null,8,["modelValue"])]),t("div",zt,l(e.$t("全选")),1),t("div",Ht,l(e.$t("商品信息")),1),t("div",Mt,l(e.$t("单价")),1),t("div",Rt,l(e.$t("数量")),1),t("div",Wt,l(e.$t("小计")),1),t("div",Yt,l(e.$t("操作")),1)])]),f.value?(a(!0),i(C,{key:0},V(f.value,(n,Us)=>(a(),i("div",Gt,[t("div",Jt,[t("div",Kt,[r(D,{modelValue:n.isChecked,"onUpdate:modelValue":o=>n.isChecked=o,onChange:o=>st(n)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),t("div",Qt,[n.shopId==0?(a(),i("div",Xt,l(e.$t("自营")),1)):b(yt)()?(a(),i("div",Zt,l(n.shopTitle),1)):u("",!0)])]),t("div",te,[(a(!0),i(C,null,V(n.carts,o=>(a(),i("div",{class:U(["product-list-cart",E(o)?"disabled-item":""])},[t("div",ee,[t("div",se,[r(D,{modelValue:o.isChecked,"onUpdate:modelValue":d=>o.isChecked=d,onChange:s[1]||(s[1]=d=>et()),disabled:E(o)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",oe,[t("div",le,[o.stock!=0&&o.productStatus!=0?(a(),i("a",{key:0,target:"_blank",href:b(L)({path:"product",id:o.productId,sn:o.productSn})},[t("img",{src:("imageFormat"in e?e.imageFormat:b(O))(o.picThumb),alt:""},null,8,ie)],8,ae)):(a(),i("div",ne,[t("img",{src:("imageFormat"in e?e.imageFormat:b(O))(o.picThumb),alt:""},null,8,de)])),(o.stock==0||o.productStatus==0)&&o.isDisabled==!0?(a(),i("div",ce,[o.stock==0||o.productStatus==0?(a(),i("div",re,l(o.productStatus==0?e.$t("已下架"):e.$t("已售罄")),1)):u("",!0)])):u("",!0)]),t("div",ue,[o.stock!=0&&o.productStatus!=0?(a(),i("a",{key:0,target:"_blank",href:b(L)({path:"product",id:o.productId,sn:o.productSn})},l(o.productName),9,me)):(a(),i("p",_e,l(o.productName),1)),t("div",ve,[(a(!0),i(C,null,V(o.skuData,(d,w)=>(a(),i("span",null,l(w!==0?" , ":"")+l(d.name)+":"+l(d.value),1))),256))]),o.extraSkuData&&o.extraSkuData.length?(a(),i("div",he,[(a(!0),i(C,null,V(o.extraSkuData,d=>(a(),i("div",{key:d,class:"extraskudata-item"},[t("div",fe,l(d.attrName),1),s[14]||(s[14]=t("div",{class:"line-box"},[t("div",{class:"line"})],-1)),t("div",pe,[t("span",ke,l(d.attrValue),1),r(p,{modelValue:d.attrPrice,"onUpdate:modelValue":w=>d.attrPrice=w,showText:!1},null,8,["modelValue","onUpdate:modelValue"]),t("span",ye,"x"+l(o.quantity),1)])]))),128))])):u("",!0),o.activityInfo?(a(),i("div",ge,[(a(!0),i(C,null,V(lt(o.activityInfo),d=>(a(),i("div",{class:"promotion-box-item",key:d.promotionId},[d.type!=2?(a(),i("div",Ce,[t("div",Ve,l(e.$t(ot[d.type])),1)])):u("",!0),d.type==2?(a(),i("div",be,[t("div",$e,[h(l(e.$t("券")),1),s[15]||(s[15]=t("span",{class:"ticket-line"},null,-1))]),t("div",we,l(d.data.promotionDesc),1)])):u("",!0)]))),128))])):u("",!0)])]),t("div",xe,[t("div",Te,[r(p,{modelValue:o.price,"onUpdate:modelValue":d=>o.price=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),t("div",De,[t("div",Ue,[r(Ut,{max:o.stock,modelValue:o.quantity,"onUpdate:modelValue":d=>o.quantity=d,onChange:d=>J(o),disabled:E(o)},null,8,["max","modelValue","onUpdate:modelValue","onChange","disabled"])])]),t("div",Ee,[t("div",Se,[r(p,{modelValue:o.subtotal,"onUpdate:modelValue":d=>o.subtotal=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),t("div",Fe,[t("div",null,[t("a",{onClick:d=>X(o.cartId),style:{cursor:"pointer"}},s[16]||(s[16]=[t("i",{class:"iconfont-pc icon-shanchu"},null,-1)]),8,Ae)])])]),s[17]||(s[17]=t("div",{class:"cart-line"},null,-1))],2))),256))]),n.gift.length>0?(a(),i("div",Ie,[t("div",Be,l(e.$t("赠品")),1),t("div",Le,[(a(!0),i(C,null,V(n.gift,o=>(a(),W(k,{key:o.giftId,target:"_blank",to:b(L)({path:"product",id:o.productId,sn:o.productSn})},{default:x(()=>[t("div",Oe,[t("div",Ne,[r(it,{class:"gift-img",lazy:"",src:("imageFormat"in e?e.imageFormat:b(O))(o.picThumb)},null,8,["src"])]),t("div",je,[t("div",Pe,l(o.productName),1),o.skuData.length>0?(a(),i("div",qe,[(a(!0),i(C,null,V(o.skuData,(d,w)=>(a(),i("div",{key:w,class:"sku-item"},l(d.value),1))),128))])):u("",!0),t("div",ze,"x"+l(o.num),1)])])]),_:2},1032,["to"]))),128))])])):u("",!0)]))),256)):u("",!0),t("div",{class:"checkOutBar",id:"price-total",ref_key:"checkOutBarRef",ref:H},[t("div",{class:U({pay_tools_bar:!0,tools_bar_bottom:M.value})},[t("div",He,[t("div",Me,[t("div",Re,[r(D,{modelValue:$.value,"onUpdate:modelValue":s[2]||(s[2]=n=>$.value=n),onChange:z},null,8,["modelValue"])]),t("div",We,[h(l(e.$t("全选"))+" ",1),t("div",null,[t("span",null,[h(l(e.$t("共"))+" ",1),t("span",Ye,l(c.value.totalCount),1),h(" "+l(e.$t("件")),1)])]),t("div",null,[t("a",{onClick:Z},l(e.$t("删除勾选商品")),1)]),t("div",null,[t("a",{onClick:tt},l(e.$t("清空购物车")),1)])])]),t("div",Ge,[t("div",Je,[t("div",Ke,[t("p",Qe,[h(l(e.$t("已选商品"))+" ",1),t("span",Xe,l(c.value.checkedCount),1),h(" "+l(e.$t("件")),1)]),t("div",Ze,[t("span",ts,l(e.$t("合计"))+"：",1),r(p,{modelValue:c.value.discountAfter,"onUpdate:modelValue":s[3]||(s[3]=n=>c.value.discountAfter=n),showText:!1},null,8,["modelValue"])])]),t("div",es,[t("div",null,[h(l(e.$t("共优惠"))+"：",1),r(p,{modelValue:c.value.discounts,"onUpdate:modelValue":s[4]||(s[4]=n=>c.value.discounts=n),showText:!1},null,8,["modelValue"])]),r(nt,{modelValue:B.value,"onUpdate:modelValue":s[11]||(s[11]=n=>B.value=n)},{reference:x(()=>[t("div",ss,[h(l(e.$t("优惠明细"))+" ",1),t("span",{class:U(["iconfont-pc icon-shangjiantou",{"icon-active":B.value}])},null,2)])]),default:x(()=>[t("div",os,[t("div",ls,[t("div",as,l(e.$t("优惠明细")),1)]),t("div",is,[t("div",ns,[t("div",ds,l(e.$t("商品总额")),1),t("div",cs,[r(p,{showText:!1,modelValue:c.value.productAmount,"onUpdate:modelValue":s[5]||(s[5]=n=>c.value.productAmount=n),fontStyle:{fontWeight:"bold"}},null,8,["modelValue"])])]),c.value.serviceFee&&c.value.serviceFee>0?(a(),i("div",rs,[t("div",us,l(e.$t("附加费用")),1),t("div",ms,[r(p,{modelValue:c.value.serviceFee,"onUpdate:modelValue":s[6]||(s[6]=n=>c.value.serviceFee=n),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])])):u("",!0),t("div",_s,[t("div",vs,l(e.$t("共优惠")),1),t("div",hs,[s[18]||(s[18]=h(" - ",-1)),r(p,{modelValue:c.value.discounts,"onUpdate:modelValue":s[7]||(s[7]=n=>c.value.discounts=n),showText:!1},null,8,["modelValue"])]),c.value.discountDiscountAmount>0?(a(),i("div",fs,[t("div",ps,l(e.$t("活动优惠")),1),t("div",ks,[s[19]||(s[19]=h(" - ",-1)),r(p,{modelValue:c.value.discountDiscountAmount,"onUpdate:modelValue":s[8]||(s[8]=n=>c.value.discountDiscountAmount=n),showText:!1},null,8,["modelValue"])])])):u("",!0)]),c.value.discountCouponAmount>0?(a(),i("div",ys,[t("div",gs,l(e.$t("优惠券")),1),t("div",Cs,[s[20]||(s[20]=h(" - ",-1)),r(p,{modelValue:c.value.discountCouponAmount,"onUpdate:modelValue":s[9]||(s[9]=n=>c.value.discountCouponAmount=n),showText:!1},null,8,["modelValue"])])])):u("",!0),t("div",Vs,[t("div",bs,l(e.$t("合计")),1),t("div",$s,[r(p,{modelValue:c.value.discountAfter,"onUpdate:modelValue":s[10]||(s[10]=n=>c.value.discountAfter=n),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])]),t("div",ws,l(e.$t("以上优惠不包含运费，实际优惠金额请以确认订单页为准")),1)])])]),_:1},8,["modelValue"])])]),t("div",{onClick:s[12]||(s[12]=n=>c.value.checkedCount&&at()),class:U("checkout_btn hand-pointer "+(c.value.checkedCount==0?"disabled":""))},l(e.$t("去结算")),3)])])],2)],512)])])):u("",!0),P.value?(a(),W(Et,{key:2,onOnBuy:g})):u("",!0),T.value?(a(),i("div",xs,s[21]||(s[21]=[t("div",null,[t("div",{style:{height:"300px",width:"100%"}})],-1)]))):u("",!0),r(dt)])}}}),uo=wt(Ts,[["__scopeId","data-v-4feba1b0"]]);export{uo as default};

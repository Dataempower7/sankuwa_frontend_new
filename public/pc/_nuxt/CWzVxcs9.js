import{a as g,b as I}from"./CQ93QHlZ.js";import{e as y,b0 as b,f as D,ar as k,z as x,r as B,c as C,o as P,x as _,a6 as h,A as T,p as a,_ as A}from"./BjkHNVA8.js";/* empty css        */const S=y({__name:"Buy",props:{id:Number,number:{type:Number},skuId:{type:Number},extraAttrIds:{type:String,default:""},disabled:{type:Boolean,default:!1},isQuick:{type:Boolean,default:!1},productType:{type:String,default:"product"},skuItem:{type:Array},grouponDetail:{type:Object,default:()=>({})}},emits:["callback"],setup(s,{emit:i}){const d=b(),p=D(),l=k(),e=s,{t:u}=x(),c=i,t=B(!1),m=async()=>{try{if(e.disabled||t.value)return;t.value=!0;let o={};const r={id:e.id??0,number:e.number,skuId:e.skuId,isQuick:e.isQuick?1:0};e.extraAttrIds&&(r.extraAttrIds=e.extraAttrIds),T();let n={};if(e.grouponDetail&&e.grouponDetail.productId&&(n={grouponPromotionId:e.grouponDetail.grouponPromotionId,grouponPromotionItemId:e.grouponDetail.grouponPromotionItemId,groupNumKey:e.grouponDetail.groupNumKey,grouponDetailId:e.grouponDetail.grouponPromotionDetails?.find(f=>f.skuId===e.extraAttrIds)?.grouponDetailId||e.grouponDetail.grouponPromotionDetails[0]?.grouponDetailId,price:e.grouponDetail.price,grouponPromotionRecordId:e.grouponDetail.grouponPromotionRecordId}),e.productType=="product"?o=await g({...r,grouponData:n}):e.productType=="exchange"&&(o=await I(r)),e.isQuick==!0){if(p.closeOrder===1)return a.error(u("商城已关闭下单"));l.push({path:"/order/check",query:{flowType:o.flowType}})}else d.changeCartList(),a.success(u("加入购物车成功")),c("callback")}catch(o){a.error(o.message)}finally{t.value=!1}};return(o,r)=>(P(),C("div",{class:_("buy "+(s.disabled==!0?"disabled":"")),onClick:m},[h(o.$slots,"default",{},void 0,!0)],2))}}),Q=A(S,[["__scopeId","data-v-c479253b"]]);export{Q as B};

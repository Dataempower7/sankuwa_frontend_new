import{b as e,e as l,f as a}from"./Bd103Yf7.js";import{cJ as t,bx as r,a1 as i,bw as s,K as o,M as n,bG as u,r as d,v,N as c,e as p,h as f,P as m,H as g,a6 as h,bN as b,c as y,o as w,a3 as S,x as F,j as W,bv as j,O as I,y as $,R as q,W as M,Q as k,b as B,F as O,T as P,a7 as x,cK as E,b$ as L,cL as A,a as V,w as _,n as R,i as N,aJ as C,q as z,d as T,t as G,cM as J,cN as K,ac as H,ab as Q}from"./r4GZdGYg.js";import{c as D}from"./DONyGZrs.js";import{d as U,t as X}from"./CIKxL71l.js";import{a as Y}from"./g8XVjk5f.js";function Z(e){return t(e,4)}const ee=o({size:{type:String,values:u},disabled:Boolean}),le=o({...ee,model:Object,rules:{type:n(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean],default:!0}}),ae={validate:(e,l,a)=>(r(e)||i(e))&&s(l)&&i(a)};function te(){const e=d([]),l=v(()=>{if(!e.value.length)return"0";const l=Math.max(...e.value);return l?`${l}px`:""});function a(a){const t=e.value.indexOf(a);return-1===t&&l.value,t}return{autoLabelWidth:l,registerLabelWidth:function(l,t){if(l&&t){const r=a(t);e.value.splice(r,1,l)}else l&&e.value.push(l)},deregisterLabelWidth:function(l){const t=a(l);t>-1&&e.value.splice(t,1)}}}const re=(e,l)=>{const a=D(l).map(e=>r(e)?e.join("."):e);return a.length>0?e.filter(e=>e.propString&&a.includes(e.propString)):e},ie=p({name:"ElForm"});var se=c(p({...ie,props:le,emits:ae,setup(a,{expose:t,emit:r}){const i=a,s=d(),o=f([]),n=e(),u=m("form"),c=v(()=>{const{labelPosition:e,inline:l}=i;return[u.b(),u.m(n.value||"default"),{[u.m(`label-${e}`)]:e,[u.m("inline")]:l}]}),p=e=>re(o,[e])[0],I=(e=[])=>{i.model&&re(o,e).forEach(e=>e.resetField())},$=(e=[])=>{re(o,e).forEach(e=>e.clearValidate())},q=v(()=>!!i.model),M=async e=>B(void 0,e),k=async(e=[])=>{if(!q.value)return!1;const l=(e=>{if(0===o.length)return[];const l=re(o,e);return l.length?l:[]})(e);if(0===l.length)return!0;let a={};for(const r of l)try{await r.validate(""),"error"===r.validateState&&r.resetField()}catch(t){a={...a,...t}}return 0===Object.keys(a).length||Promise.reject(a)},B=async(e=[],l)=>{let a=!1;const t=!j(l);try{return a=await k(e),!0===a&&await(null==l?void 0:l(a)),a}catch(r){if(r instanceof Error)throw r;const e=r;if(i.scrollToError&&s.value){const e=s.value.querySelector(`.${u.b()}-item.is-error`);null==e||e.scrollIntoView(i.scrollIntoViewOptions)}return!a&&await(null==l?void 0:l(!1,e)),t&&Promise.reject(e)}};return g(()=>i.rules,()=>{i.validateOnRuleChange&&M().catch(e=>U())},{deep:!0,flush:"post"}),h(l,f({...b(i),emit:r,resetFields:I,clearValidate:$,validateField:B,getField:p,addField:e=>{o.push(e)},removeField:e=>{e.prop&&o.splice(o.indexOf(e),1)},...te()})),t({validate:M,validateField:B,resetFields:I,clearValidate:$,scrollToField:e=>{var l;const a=p(e);a&&(null==(l=a.$el)||l.scrollIntoView(i.scrollIntoViewOptions))},getField:p,fields:o}),(e,l)=>(w(),y("form",{ref_key:"formRef",ref:s,class:F(W(c))},[S(e.$slots,"default")],2))}}),[["__file","form.vue"]]);const oe=o({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:n([String,Array])},required:{type:Boolean,default:void 0},rules:{type:n([Object,Array])},error:String,validateStatus:{type:String,values:["","error","validating","success"]},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:u}}),ne="ElLabelWrap";var ue=p({name:ne,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const r=I(l,void 0),i=I(a);i||X(ne,"usage: <el-form-item><label-wrap /></el-form-item>");const s=m("form"),o=d(),n=d(0),u=(l="update")=>{P(()=>{t.default&&e.isAutoWidth&&("update"===l?n.value=(()=>{var e;if(null==(e=o.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(o.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0})():"remove"===l&&(null==r||r.deregisterLabelWidth(n.value)))})},c=()=>u("update");return $(()=>{c()}),q(()=>{u("remove")}),M(()=>c()),g(n,(l,a)=>{e.updateAll&&(null==r||r.registerLabelWidth(l,a))}),k(v(()=>{var e,l;return null!=(l=null==(e=o.value)?void 0:e.firstElementChild)?l:null}),c),()=>{var l,a;if(!t)return null;const{isAutoWidth:u}=e;if(u){const e=null==r?void 0:r.autoLabelWidth,a={};if((null==i?void 0:i.hasLabel)&&e&&"auto"!==e){const l=Math.max(0,Number.parseInt(e,10)-n.value),t=i.labelPosition||r.labelPosition;l&&(a["left"===t?"marginRight":"marginLeft"]=`${l}px`)}return B("div",{ref:o,class:[s.be("item","label-wrap")],style:a},[null==(l=t.default)?void 0:l.call(t)])}return B(O,{ref:o},[null==(a=t.default)?void 0:a.call(t)])}}});const de=p({name:"ElFormItem"});var ve=c(p({...de,props:oe,setup(t,{expose:i}){const o=t,n=x(),u=I(l,void 0),c=I(a,void 0),p=e(void 0,{formItem:!1}),M=m("form-item"),k=Y().value,O=d([]),H=d(""),Q=E(H,100),U=d(""),X=d();let ee,le=!1;const ae=v(()=>o.labelPosition||(null==u?void 0:u.labelPosition)),te=v(()=>{if("top"===ae.value)return{};const e=L(o.labelWidth||(null==u?void 0:u.labelWidth)||"");return e?{width:e}:{}}),re=v(()=>{if("top"===ae.value||(null==u?void 0:u.inline))return{};if(!o.label&&!o.labelWidth&&pe)return{};const e=L(o.labelWidth||(null==u?void 0:u.labelWidth)||"");return o.label||n.label?{}:{marginLeft:e}}),ie=v(()=>[M.b(),M.m(p.value),M.is("error","error"===H.value),M.is("validating","validating"===H.value),M.is("success","success"===H.value),M.is("required",he.value||o.required),M.is("no-asterisk",null==u?void 0:u.hideRequiredAsterisk),"right"===(null==u?void 0:u.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[M.m("feedback")]:null==u?void 0:u.statusIcon,[M.m(`label-${ae.value}`)]:ae.value}]),se=v(()=>s(o.inlineMessage)?o.inlineMessage:(null==u?void 0:u.inlineMessage)||!1),oe=v(()=>[M.e("error"),{[M.em("error","inline")]:se.value}]),ne=v(()=>o.prop?r(o.prop)?o.prop.join("."):o.prop:""),de=v(()=>!(!o.label&&!n.label)),ve=v(()=>{var e;return null!=(e=o.for)?e:1===O.value.length?O.value[0]:void 0}),ce=v(()=>!ve.value&&de.value),pe=!!c,fe=v(()=>{const e=null==u?void 0:u.model;if(e&&o.prop)return A(e,o.prop).value}),me=v(()=>{const{required:e}=o,l=[];o.rules&&l.push(...D(o.rules));const a=null==u?void 0:u.rules;if(a&&o.prop){const e=A(a,o.prop).value;e&&l.push(...D(e))}if(void 0!==e){const a=l.map((e,l)=>[e,l]).filter(([e])=>Object.keys(e).includes("required"));if(a.length>0)for(const[t,r]of a)t.required!==e&&(l[r]={...t,required:e});else l.push({required:e})}return l}),ge=v(()=>me.value.length>0),he=v(()=>me.value.some(e=>e.required)),be=v(()=>{var e;return"error"===Q.value&&o.showMessage&&(null==(e=null==u?void 0:u.showMessage)||e)}),ye=v(()=>`${o.label||""}${(null==u?void 0:u.labelSuffix)||""}`),we=e=>{H.value=e},Se=async e=>{const l=ne.value;return new K({[l]:e}).validate({[l]:fe.value},{firstFields:!0}).then(()=>(we("success"),null==u||u.emit("validate",o.prop,!0,""),!0)).catch(e=>((e=>{var l,a;const{errors:t,fields:r}=e;t&&r||console.error(e),we("error"),U.value=t?null!=(a=null==(l=null==t?void 0:t[0])?void 0:l.message)?a:`${o.prop} is required`:"",null==u||u.emit("validate",o.prop,!1,U.value)})(e),Promise.reject(e)))},Fe=async(e,l)=>{if(le||!o.prop)return!1;const a=j(l);if(!ge.value)return null==l||l(!1),!1;const t=(e=>me.value.filter(l=>!l.trigger||!e||(r(l.trigger)?l.trigger.includes(e):l.trigger===e)).map(({trigger:e,...l})=>l))(e);return 0===t.length?(null==l||l(!0),!0):(we("validating"),Se(t).then(()=>(null==l||l(!0),!0)).catch(e=>{const{fields:t}=e;return null==l||l(!1,t),!a&&Promise.reject(t)}))},We=()=>{we(""),U.value="",le=!1},je=async()=>{const e=null==u?void 0:u.model;if(!e||!o.prop)return;const l=A(e,o.prop);le=!0,l.value=Z(ee),await P(),We(),le=!1};g(()=>o.error,e=>{U.value=e||"",we(e?"error":"")},{immediate:!0}),g(()=>o.validateStatus,e=>we(e||""));const Ie=f({...b(o),$el:X,size:p,validateMessage:U,validateState:H,labelId:k,inputIds:O,isGroup:ce,hasLabel:de,fieldValue:fe,addInputId:e=>{O.value.includes(e)||O.value.push(e)},removeInputId:e=>{O.value=O.value.filter(l=>l!==e)},resetField:je,clearValidate:We,validate:Fe,propString:ne});return h(a,Ie),$(()=>{o.prop&&(null==u||u.addField(Ie),ee=Z(fe.value))}),q(()=>{null==u||u.removeField(Ie)}),i({size:p,validateMessage:U,validateState:H,validate:Fe,clearValidate:We,resetField:je}),(e,l)=>{var a;return w(),y("div",{ref_key:"formItemRef",ref:X,class:F(W(ie)),role:W(ce)?"group":void 0,"aria-labelledby":W(ce)?W(k):void 0},[B(W(ue),{"is-auto-width":"auto"===W(te).width,"update-all":"auto"===(null==(a=W(u))?void 0:a.labelWidth)},{default:_(()=>[W(de)?(w(),R(C(W(ve)?"label":"div"),{key:0,id:W(k),for:W(ve),class:F(W(M).e("label")),style:z(W(te))},{default:_(()=>[S(e.$slots,"label",{label:W(ye)},()=>[T(G(W(ye)),1)])]),_:3},8,["id","for","class","style"])):N("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),V("div",{class:F(W(M).e("content")),style:z(W(re))},[S(e.$slots,"default"),B(J,{name:`${W(M).namespace.value}-zoom-in-top`},{default:_(()=>[W(be)?S(e.$slots,"error",{key:0,error:U.value},()=>[V("div",{class:F(W(oe))},G(U.value),3)]):N("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}}),[["__file","form-item.vue"]]);const ce=H(se,{FormItem:ve}),pe=Q(ve);export{pe as E,ce as a};

import{E as K}from"./BhwkTUtM.js";import{E as Q}from"./B_vjKAZC.js";import{_ as W}from"./D7W3sM8Q.js";import{_ as Z}from"./BipSnJcb.js";import{e as x,z as ee,r as $,h as S,dg as te,y as oe,c as n,o as l,i as d,a as o,ad as ae,F as k,m as C,x as I,t as a,b as r,w as i,d as p,j as T,s as V,E as se,k as le,n as ne,p as v,an as z,cY as re,ah as N,_ as ie}from"./BjkHNVA8.js";import{_ as de}from"./CBcH1uzJ.js";import{E as ue}from"./BzIkMksr.js";import{v as ce}from"./DWKyHDnW.js";/* empty css        */import"./cfDoaBtk.js";import{g as pe,c as me,d as _e,r as F,a as ye,b as ve}from"./BW8dCpPB.js";import{P as fe}from"./BmiGu4wZ.js";import{L as he}from"./Yx7WDtrd.js";import{b as ge}from"./TIyJFtn7.js";const ke={class:"order-list"},be={key:0,class:"tag-and-input"},we={class:"tig-tabs"},$e=["onClick"],Se={key:0},Te={class:"input"},Ce={class:"order-title"},Ie={class:"ul"},Ve={style:{width:"23%"}},ze={style:{width:"28%"}},Ne={key:1,style:{width:"49%"}},Ae={style:{width:"6%"}},Oe={style:{width:"12%"}},je={style:{width:"14%"}},Le={style:{width:"12%"}},Pe={class:"order-table"},Ee={colspan:"4",class:"order-table-title"},Fe={class:"font-color"},De={key:0,style:{"margin-left":"30px"}},Re={class:"font-color"},Ue={style:{"margin-left":"30px"}},Be={class:"order-tr"},Me={class:"column-1"},Ye={class:"text-ellipsis"},He={key:0,class:"joining-tag"},qe={style:{color:"#aaa"}},Je={class:"column-2-4"},Xe={class:"black"},Ge={class:"money"},Ke={class:"column-2-4"},Qe={class:"black"},We={key:1,class:"black"},Ze={style:{cursor:"pointer"}},xe={class:"column-2-4"},et={key:0},tt=["onClick"],ot=["onClick"],at={key:3,class:"mb10"},st={key:4,class:"mb10"},lt={key:5,class:"mb10"},nt={key:6,class:"mb10"},rt={key:7,class:"mb10"},it={key:8},dt={class:"el-page"},ut={key:1,class:"no-result"},ct={key:0},pt={key:1},mt={style:{"font-size":"12px"}},_t=x({__name:"MemberOrderList",props:{modelValue:{type:Number,default:1}},emits:["change"],setup(A,{emit:yt}){const{t:_}=ee(),O=$([]),h=$(!0),b=$(0),u=S({page:1,sortField:"addTime",sortOrder:"desc",keyword:"",payStatus:-1,dateType:1}),D=te(),j=$("all"),L=S([{type:"all",value:"全部订单",num:0},{type:"awaitPay",value:"待支付",num:0},{type:"awaitShipping",value:"待发货",num:0},{type:"awaitReceived",value:"待收货",num:0},{type:"awaitComment",value:"待评价",num:0}]),P=t=>{u.page=1,u.orderStatus=-1,u.commentStatus=-1,t==="awaitPay"?u.orderStatus=0:t==="awaitShipping"?u.orderStatus=1:t==="awaitReceived"?u.orderStatus=2:t==="awaitComment"&&(u.commentStatus=0),j.value=t,f()},w=async()=>{h.value=!0;try{const t=await pe();L.forEach(s=>{let g=t;g[s.type]!==void 0&&(s.num=g[s.type])})}catch(t){v.error(t.message)}finally{h.value=!1}};S([{value:-1,label:"交易状态"},{value:0,label:"未支付"},{value:2,label:"已支付"}]);const R=S([{value:0,label:"全部订单"},{value:1,label:"最近三个月订单"},{value:2,label:"最近六个月订单"},{value:3,label:"最近一年内订单"}]),U=async t=>{z.confirm({title:_("确认要取消该订单吗"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=await me({id:t});v.success(_("取消成功")),await f(),await w()}catch(s){v.error(s.message)}finally{}}})},B=async t=>{z.confirm({title:_("确认要删除该订单吗"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await _e({id:t}),v.success(_("删除成功")),await f(),await w()}catch(s){v.error(s.message)}finally{}}})},M=async(t,s,g)=>{try{if(g){const m=await ge({productId:s});m.endTime>re().format("YYYY-MM-DD HH:mm:ss")?N(V({path:"joining",productSn:m.productSn})):(v.error(_("拼团已结束,可以按现价购买该商品")),await F({id:t}),N("/cart"))}else await F({id:t}),N("/cart")}catch(m){v.error(m.message)}},Y=async t=>{z.confirm({title:_("确认要收货吗"),cancelText:_("取消"),okText:_("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=await ye({id:t});f(),w()}catch(s){v.error(s.message)}finally{}}})},f=async()=>{h.value=!0;try{b.value=0;const t=await ve({...u});O.value=t.records,b.value=t.total}catch(t){v.error(t.message)}finally{h.value=!1}};return oe(()=>{w().then(()=>{P(D.query.type||"all"),f()})}),(t,s)=>{const g=K,m=Q,H=W,y=Z,q=se,E=de,J=ue,X=ce;return l(),n("div",ke,[A.modelValue?(l(),n("div",be,[o("div",we,[(l(!0),n(k,null,C(L,e=>(l(),n("div",{class:I([j.value==e.type?"active":"","tab"]),onClick:G=>P(e.type)},[e.num?(l(),n("span",Se,a(e.num),1)):d("",!0),o("p",null,a(t.$t(e.value)),1)],10,$e))),256))]),o("div",Te,[r(g,{modelValue:u.keyword,"onUpdate:modelValue":s[0]||(s[0]=e=>u.keyword=e),placeholder:t.$t("收货人名称或订单号"),type:"text"},null,8,["modelValue","placeholder"]),r(m,{class:"ml10",onClick:s[1]||(s[1]=e=>f())},{default:i(()=>[p(a(t.$t("搜索")),1)]),_:1})])])):d("",!0),o("div",Ce,[o("div",Ie,[A.modelValue?(l(),n(k,{key:0},[o("div",Ve,[r(H,{modelValue:u.dateType,"onUpdate:modelValue":s[2]||(s[2]=e=>u.dateType=e),selectList:R,onLoadFilter:f},null,8,["modelValue","selectList"])]),o("div",ze,a(t.$t("商品名称")),1)],64)):(l(),n("div",Ne,a(t.$t("商品名称")),1)),o("div",Ae,a(t.$t("数量")),1),s[5]||(s[5]=o("div",{style:{width:"7%"}},null,-1)),o("div",Oe,a(t.$t("金额")),1),o("div",je,a(t.$t("交易状态")),1),o("div",Le,a(t.$t("操作")),1)])]),ae((l(),n("div",null,[b.value>0?(l(),n(k,{key:0},[(l(!0),n(k,null,C(O.value,(e,G)=>(l(),n("table",Pe,[o("thead",null,[o("tr",null,[o("th",Ee,[p(a(t.$t("订单号"))+"：",1),r(y,{to:"/member/order/info?id="+e.orderId,target:"_blank"},{default:i(()=>[o("span",Fe,a(e.orderSn),1)]),_:2},1032,["to"]),e.shop&&e.shop.shopTitle?(l(),n("span",De,[p(a(t.$t("下单店铺"))+"：",1),r(y,{to:T(V)({path:"shop",id:e.shopId}),target:"_blank"},{default:i(()=>[o("span",Re,a(e.shop.shopTitle),1)]),_:2},1032,["to"])])):d("",!0),o("span",Ue,a(t.$t("下单时间"))+"："+a(e.addTime),1)])])]),o("tbody",null,[o("tr",Be,[o("td",Me,[(l(!0),n(k,null,C(e.items,c=>(l(),n("div",null,[r(y,{title:c.productName,to:T(V)({path:"product",id:c.productId,sn:c.productSn}),class:"nuxt",target:"_blank"},{default:i(()=>[r(q,{src:("imageFormat"in t?t.imageFormat:T(le))(c.picThumb),loading:"lazy",style:{height:"40px",width:"40px",transition:"opacity 0.2s linear","flex-shrink":"0"}},null,8,["src"]),o("div",null,[o("div",Ye,[e.joinStatus?(l(),n("span",He,"拼团")):d("",!0),p(" "+a(c.productName),1)])])]),_:2},1032,["title","to"]),o("div",qe,"X"+a(c.quantity),1),s[6]||(s[6]=o("div",null,null,-1))]))),256))]),o("td",Je,[o("div",null,[o("div",null,[p(a(t.$t("总额"))+": ",1),r(E,{modelValue:e.totalAmount,"onUpdate:modelValue":c=>e.totalAmount=c,showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),e.orderStatus==0&&e.unpaidAmount>0?(l(),n(k,{key:0},[o("div",Xe,a(t.$t("应付")),1),o("div",Ge,[r(E,{modelValue:e.unpaidAmount,"onUpdate:modelValue":c=>e.unpaidAmount=c,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])],64)):d("",!0),o("div",null,a(e.payTypeId===1?t.$t("在线支付"):e.payTypeId===2?t.$t("货到付款"):t.$t("线下支付")),1)])]),o("td",Ke,[o("div",null,[o("div",{class:I({orange:e.orderStatus===0,black:e.orderStatus===1||e.orderStatus===2||e.orderStatus===4,gray:e.orderStatus===3,green:e.orderStatus===5})},a(t.$t(e.orderStatusName)),3),e.joinStatusDesc?(l(),n("div",{key:0,class:I({orange:e.joinStatus===1,green:e.joinStatus===2,gray:e.joinStatus===3}),style:{"text-align":"center"}},a(t.$t(e.joinStatusDesc)),3)):d("",!0),o("div",Qe,[r(y,{to:"/member/order/info?id="+e.orderId,target:"_blank"},{default:i(()=>[p(a(t.$t("订单详情")),1)]),_:2},1032,["to"])]),(e.orderStatus==2||e.orderStatus==5)&&e.shippingMethod==1?(l(),n("div",We,[r(J,{width:600,placement:"bottom",onShow:c=>e.showPopover=!0,onHide:c=>e.showPopover=!1},{reference:i(()=>[o("span",Ze,[o("i",null,a(t.$t("物流跟踪")),1),s[7]||(s[7]=o("i",{style:{"font-size":"12px"},class:"iconfont-pc icon-xiajiantou1"},null,-1))])]),default:i(()=>[e.showPopover?(l(),ne(he,{key:0,trackingNo:e.trackingNo,logisticsName:e.logisticsName,id:e.orderId},null,8,["trackingNo","logisticsName","id"])):d("",!0)]),_:2},1032,["onShow","onHide"])])):d("",!0)])]),o("td",xe,[o("div",null,[e.availableActions.toPay?(l(),n("div",et,[r(y,{to:"/order/pay/?id="+e.orderId,target:"_balnk"},{default:i(()=>[r(m,{size:"small",type:"primary"},{default:i(()=>[p(a(t.$t("付款")),1)]),_:1})]),_:2},1032,["to"])])):d("",!0),e.availableActions.cancelOrder?(l(),n("a",{key:1,onClick:c=>U(e.orderId)},a(t.$t("取消订单")),9,tt)):d("",!0),e.availableActions.delOrder?(l(),n("a",{key:2,onClick:c=>B(e.orderId)},a(t.$t("删除")),9,ot)):d("",!0),e.availableActions.confirmReceipt?(l(),n("div",at,[r(m,{type:"primary",size:"small",onClick:c=>Y(e.orderId)},{default:i(()=>[p(a(t.$t("确认收货")),1)]),_:2},1032,["onClick"])])):d("",!0),e.availableActions.toAftersales?(l(),n("div",st,[r(y,{to:"/member/return/info/?orderId="+e.orderId},{default:i(()=>[r(m,{size:"small"},{default:i(()=>[p(a(t.$t("申请售后")),1)]),_:1})]),_:2},1032,["to"])])):d("",!0),e.items&&e.items[0]?.aftersalesItem?(l(),n("div",lt,[r(y,{to:"/member/return/logInfo?id="+e.items[0]?.aftersalesItem?.aftersaleId},{default:i(()=>[r(m,{size:"small"},{default:i(()=>[p(a(t.$t("售后详情")),1)]),_:1})]),_:2},1032,["to"])])):d("",!0),e.availableActions.rebuy?(l(),n("div",nt,[r(m,{size:"small",onClick:c=>M(e.orderId,e.items[0]?.productId,e.joinStatus)},{default:i(()=>[p(a(t.$t("再次购买")),1)]),_:2},1032,["onClick"])])):d("",!0),e.availableActions.toComment?(l(),n("div",rt,[r(y,{to:"/member/comment/info/?id="+e.orderId},{default:i(()=>[r(m,{size:"small"},{default:i(()=>[p(a(t.$t("去评价")),1)]),_:1})]),_:2},1032,["to"])])):d("",!0),e.joinStatus?(l(),n("div",it,[r(y,{to:"/member/group/info?id="+e.grouponPromotionRecordId,target:"_blank"},{default:i(()=>[r(m,{size:"small",type:"primary"},{default:i(()=>[p(a(t.$t("拼团详情")),1)]),_:1})]),_:2},1032,["to"])])):d("",!0)])])])])]))),256)),o("div",dt,[r(T(fe),{page:u.page,"onUpdate:page":s[3]||(s[3]=e=>u.page=e),size:u.size,"onUpdate:size":s[4]||(s[4]=e=>u.size=e),total:b.value,onCallback:f},null,8,["page","size","total"])])],64)):(l(),n("div",ut,[h.value?d("",!0):(l(),n("div",ct,s[8]||(s[8]=[o("span",{class:"sign sign1"},null,-1)]))),h.value?d("",!0):(l(),n("div",pt,[o("ul",null,[o("li",null,a(t.$t("当前筛选下还没有任何订单哦")),1),o("li",mt,[p(a(t.$t("现在就去"))+"： ",1),r(y,{class:"font-color",to:"/"},{default:i(()=>[p(a(t.$t("选购商品")),1)]),_:1})])])]))]))])),[[X,h.value]])])}}}),Nt=ie(_t,[["__scopeId","data-v-a2b062cb"]]);export{Nt as _};

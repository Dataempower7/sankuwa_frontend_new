import{E as Z}from"./BhwkTUtM.js";import{a as P,E as G}from"./Ckzsp_T1.js";import{E as H}from"./B_vjKAZC.js";import{e as j,f as J,ai as K,r as s,h as A,z as Q,y as W,p as O,c as z,o as k,n as R,i as q,a as _,w as d,b as t,j as X,d as L,t as D,_ as N,v as U,F as Y,q as ee,x as le,a6 as ae,bh as M}from"./BjkHNVA8.js";/* empty css        *//* empty css        */import{S as oe}from"./DX-St3sq.js";import{E as te}from"./BsZFmHoh.js";import"./Ibc-iJtI.js";import{g as se,u as ne}from"./B10zCnzm.js";/* empty css        */const re={class:"modal_region_box"},ie={class:"address_from"},de={class:"from_item"},ue={class:"btn_box"},me=j({__name:"EditRegion",props:{id:Number,act:{type:String,default:"add"},isDialog:Boolean,addressId:{type:Number,default:0},showClose:{type:Boolean,default:!0}},emits:["submitCallback","update:confirmLoading","close","change"],setup(g,{expose:h,emit:S}){const n=J(),c=S,u=g,f=K().currentRoute.value.query,p=s(u.isDialog?u.act:String(f.act)),$=s(p.value==="add"?"create":"update");s(!1);const a=A({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:""}),{t:b}=Q(),v=s(!0);W(()=>{u.addressId>0?E():v.value=!1});const E=async()=>{try{const e=await se(p.value,{id:u.addressId});Object.assign(a,e)}catch(e){O.error(e.message)}finally{v.value=!1}},w=A({mobile:[{validator:(e,l,o)=>{const r=n.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+86)?1(?:3[0-9]|4[5-9]|5[0-35-9]|6[5-7]|7[0-8]|8[0-9]|9[189])\d{8}$/;if(l)if(r.test(l))o();else return o(new Error(b("格式错误，请输入正确的手机号码")));else return o(new Error(b("手机号不能为空")))},trigger:"blur",required:!0}],email:[{validator:(e,l,o)=>{if(l&&!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l))return o(new Error(b("格式错误，请输入正确的邮箱地址")));o()},trigger:"blur",required:!0}]}),y=s(null),V=async()=>{await y.value.validate();try{c("update:confirmLoading",!0);const e=await ne($.value,{id:u.addressId,...a});setTimeout(()=>{O.success(b("操作成功"))},100),c("submitCallback",e)}catch(e){O.error(e.message)}finally{c("update:confirmLoading",!1)}},B=()=>{y.value.validateField("regionIds")},F=()=>{c("close")};return h({onFormSubmit:()=>{V()}}),(e,l)=>{const o=Z,r=G,T=P,x=H;return k(),z("div",re,[v.value?q("",!0):(k(),R(T,{key:0,"label-width":"auto","inline-message":!1,ref_key:"formRef",ref:y,rules:w,model:a,autocomplete:"off","label-suffix":"："},{default:d(()=>[t(r,{label:e.$t("收货人"),prop:"consignee",rules:[{required:!0,message:e.$t("请您填写收货人姓名")}]},{default:d(()=>[t(o,{modelValue:a.consignee,"onUpdate:modelValue":l[0]||(l[0]=i=>a.consignee=i),maxlength:20},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(r,{label:e.$t("所在地区"),prop:"regionIds",rules:[{required:!0,message:e.$t("请选择收货人所在地区")}],autoLink:""},{default:d(()=>[t(X(oe),{modelValue:a.regionIds,"onUpdate:modelValue":l[1]||(l[1]=i=>a.regionIds=i),onChange:B},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(r,{label:e.$t("详细地址"),prop:"address",rules:[{required:!0,message:e.$t("请您填写详细收货地址")},{min:3,message:e.$t("收货人地址过短")}]},{default:d(()=>[t(o,{modelValue:a.address,"onUpdate:modelValue":l[2]||(l[2]=i=>a.address=i),maxlength:100},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(r,{label:e.$t("手机号码"),prop:"mobile"},{default:d(()=>[t(o,{modelValue:a.mobile,"onUpdate:modelValue":l[3]||(l[3]=i=>a.mobile=i),maxlength:20},null,8,["modelValue"])]),_:1},8,["label"]),t(r,{label:e.$t("固定电话"),prop:"telephone",rules:[],"wrapper-col":{span:8},extra:""},{default:d(()=>[t(o,{modelValue:a.telephone,"onUpdate:modelValue":l[4]||(l[4]=i=>a.telephone=i),maxlength:20},null,8,["modelValue"])]),_:1},8,["label"]),t(r,{required:!1,label:e.$t("邮箱地址"),prop:"email",rules:[],"wrapper-col":{span:8}},{default:d(()=>[t(o,{modelValue:a.email,"onUpdate:modelValue":l[5]||(l[5]=i=>a.email=i),maxlength:50},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"])),_("div",ie,[_("div",de,[l[6]||(l[6]=_("div",{class:"tit"},null,-1)),_("div",ue,[t(x,{type:"primary",onClick:V},{default:d(()=>[L(D(p.value==="add"?e.$t("新增"):e.$t("修改"))+D(e.$t("地址")),1)]),_:1}),u.showClose?(k(),R(x,{key:0,onClick:F},{default:d(()=>[L(D(e.$t("取消")),1)]),_:1})):q("",!0)])])])])}}}),pe=N(me,[["__scopeId","data-v-9a5a66d5"]]),ce=j({__name:"DialogEditRegion",props:{path:String,class:{type:String,default:""},dialogClass:{type:String,default:""},params:{type:Object,default:{}},width:{type:String,default:"800px"},title:{type:String,default:""},isDrawer:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},showOnOk:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!0},data:{type:Object,default:{}},style:{type:[String,Object],default:"display:inline-flex;"},maskClosable:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},type:String},emits:["okCallback","callback"],setup(g,{expose:h,emit:S}){const n=g,c=S,u=s(!1),f=s(!1),p=s(!1),$=s(!1),a=s(n.dialogClass),b=s(n.title),v=s({});n.showFooter===!1&&(v.value.footer="");const E=U(()=>Object.assign(n.params,{isDialog:!0}));U(()=>n.type=="gallery"?"811px":n.width);function C(){p.value=!1,u.value=!0,f.value=!0}function I(m){f.value=!1}const w=s(),y=m=>{f.value=!1,p.value=!1,c("okCallback",m,n.data)},V=m=>{c("callback",m,n.data)},B=()=>{w.value.onFormSubmit()},F=m=>{$.value=!m};return h({show:C,close:I}),(m,e)=>{const l=pe,o=te;return k(),z(Y,null,[_("div",{onClick:C,class:le("dialog-link "+n.class),style:ee(n.style)},[ae(m.$slots,"default",{},void 0,!0)],6),u.value?(k(),R(o,M({key:0,class:a.value,modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=r=>f.value=r),width:g.width,title:b.value,destroyOnClose:!0,onOk:B},v.value,{"close-on-click-modal":g.maskClosable,"show-close":g.closable,centered:""}),{default:d(()=>[t(l,M({ref_key:"submitForm",ref:w,onSubmitCallback:y,onCallback:V,onShow:C,onClose:I,onOkType:F},E.value,{confirmLoading:p.value,"onUpdate:confirmLoading":e[0]||(e[0]=r=>p.value=r)}),null,16,["confirmLoading"])]),_:1},16,["class","modelValue","width","title","close-on-click-modal","show-close"])):q("",!0)],64)}}}),Se=N(ce,[["__scopeId","data-v-ad57d92d"]]);export{Se as _};

import{b as we}from"./5VTus1_X.js";import{_ as Ce}from"./Drr4mNEN.js";import{_ as Ie}from"./DUyqL_E3.js";import{_ as ke}from"./CBcH1uzJ.js";import{_ as Te}from"./BipSnJcb.js";import{a4 as de,M as xe,bW as Se,N as me,O as te,dE as K,bV as pe,dF as $e,P as Ne,e as re,Q as fe,R as Ee,r as I,v as b,bA as le,bl as ve,bO as se,a3 as _e,H as Pe,c,o as r,i as P,F as k,m as O,x as N,j as n,b as y,w as Z,ad as he,n as E,aN as W,ae as be,Z as ye,q as Q,t as f,b_ as ge,a2 as J,ag as Ae,f as Fe,z as De,y as Oe,ar as He,ah as Me,p as q,a as t,d as G,k as Ve,s as Re,E as Ue,_ as Be}from"./BjkHNVA8.js";import{u as Le}from"./d3UjsK-T.js";import{U as X,C as ne}from"./BKu6lkEW.js";import{a as je,c as ze,d as Ke,f as We}from"./BIqqf5dq.js";import{E as Je}from"./BhwkTUtM.js";import{E as qe}from"./B_vjKAZC.js";import{_ as Ge}from"./B85mN9rA.js";/* empty css        */import{g as Qe,u as Xe}from"./NkVna5g-.js";import{U as Ze}from"./BrM2Mo0y.js";import"./CM_M6Xgj.js";import"./n1vI1_Nv.js";import"./ClRMjIOJ.js";import"./CXwPJP5h.js";import"./CH9-T1LE.js";import"./FYm-MTMW.js";import"./cfDoaBtk.js";import"./C1B8-dXF.js";import"./Bnvi_g-K.js";import"./yB3A8U-z.js";import"./UVx7YjW9.js";import"./BzIkMksr.js";/* empty css        */import"./Csy7st1x.js";import"./Ibc-iJtI.js";import"./XdJ5ILcf.js";import"./BNVM5YSV.js";import"./DoNaAjK4.js";import"./BsZFmHoh.js";const Ye=xe({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:te([Array,Object]),default:()=>me(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:te([Array,Object]),default:()=>[K,K,K]},voidIcon:{type:pe,default:()=>$e},disabledVoidIcon:{type:pe,default:()=>K},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:te(Array),default:()=>me(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Se,clearable:Boolean,...Le(["ariaLabel"])}),eo={[ne]:x=>de(x),[X]:x=>de(x)},oo=re({name:"ElRate"}),ao=re({...oo,props:Ye,emits:eo,setup(x,{expose:H,emit:V}){const e=x;function A(a,i){const d=h=>ve(h),g=Object.keys(i).map(h=>+h).filter(h=>{const z=i[h];return(d(z)?z.excluded:!1)?a<h:a<=h}).sort((h,z)=>h-z),D=i[g[0]];return d(D)&&D.value||D}const M=fe(Ke,void 0),_=fe(We,void 0),R=je(),v=Ee("rate"),{inputId:w,isLabeledByFormItem:U}=ze(e,{formItemContext:_}),m=I(e.modelValue),S=I(-1),C=I(!0),o=b(()=>[v.b(),v.m(R.value)]),l=b(()=>e.disabled||M?.disabled),p=b(()=>v.cssVarBlock({"void-color":e.voidColor,"disabled-void-color":e.disabledVoidColor,"fill-color":L.value})),T=b(()=>{let a="";return e.showScore?a=e.scoreTemplate.replace(/\{\s*value\s*\}/,l.value?`${e.modelValue}`:`${m.value}`):e.showText&&(a=e.texts[Math.ceil(m.value)-1]),a}),B=b(()=>e.modelValue*100-Math.floor(e.modelValue)*100),Y=b(()=>le(e.colors)?{[e.lowThreshold]:e.colors[0],[e.highThreshold]:{value:e.colors[1],excluded:!0},[e.max]:e.colors[2]}:e.colors),L=b(()=>{const a=A(m.value,Y.value);return ve(a)?"":a}),ee=b(()=>{let a="";return l.value?a=`${B.value}%`:e.allowHalf&&(a="50%"),{color:L.value,width:a}}),F=b(()=>{let a=le(e.icons)?[...e.icons]:{...e.icons};return a=se(a),le(a)?{[e.lowThreshold]:a[0],[e.highThreshold]:{value:a[1],excluded:!0},[e.max]:a[2]}:a}),oe=b(()=>A(e.modelValue,F.value)),j=b(()=>l.value?_e(e.disabledVoidIcon)?e.disabledVoidIcon:se(e.disabledVoidIcon):_e(e.voidIcon)?e.voidIcon:se(e.voidIcon)),ae=b(()=>A(m.value,F.value));function s(a){const i=l.value&&B.value>0&&a-1<e.modelValue&&a>e.modelValue,d=e.allowHalf&&C.value&&a-.5<=m.value&&a>m.value;return i||d}function $(a){e.clearable&&a===e.modelValue&&(a=0),V(X,a),e.modelValue!==a&&V(ne,a)}function u(a){l.value||(e.allowHalf&&C.value?$(m.value):$(a))}function ie(a){if(l.value)return;let i=m.value;const d=a.code;return d===J.up||d===J.right?(e.allowHalf?i+=.5:i+=1,a.stopPropagation(),a.preventDefault()):(d===J.left||d===J.down)&&(e.allowHalf?i-=.5:i-=1,a.stopPropagation(),a.preventDefault()),i=i<0?0:i,i=i>e.max?e.max:i,V(X,i),V(ne,i),i}function ue(a,i){if(!l.value){if(e.allowHalf&&i){let d=i.target;ge(d,v.e("item"))&&(d=d.querySelector(`.${v.e("icon")}`)),(d.clientWidth===0||ge(d,v.e("decimal")))&&(d=d.parentNode),C.value=i.offsetX*2<=d.clientWidth,m.value=C.value?a-.5:a}else m.value=a;S.value=a}}function ce(){l.value||(e.allowHalf&&(C.value=e.modelValue!==Math.floor(e.modelValue)),m.value=e.modelValue,S.value=-1)}return Pe(()=>e.modelValue,a=>{m.value=a,C.value=e.modelValue!==Math.floor(e.modelValue)}),e.modelValue||V(X,0),H({setCurrentValue:ue,resetCurrentValue:ce}),(a,i)=>{var d;return r(),c("div",{id:n(w),class:N([n(o),n(v).is("disabled",n(l))]),role:"slider","aria-label":n(U)?void 0:a.ariaLabel||"rating","aria-labelledby":n(U)?(d=n(_))==null?void 0:d.labelId:void 0,"aria-valuenow":m.value,"aria-valuetext":n(T)||void 0,"aria-valuemin":"0","aria-valuemax":a.max,tabindex:"0",style:Q(n(p)),onKeydown:ie},[(r(!0),c(k,null,O(a.max,(g,D)=>(r(),c("span",{key:D,class:N(n(v).e("item")),onMousemove:h=>ue(g,h),onMouseleave:ce,onClick:h=>u(g)},[y(n(ye),{class:N([n(v).e("icon"),{hover:S.value===g},n(v).is("active",g<=m.value)])},{default:Z(()=>[s(g)?P("v-if",!0):(r(),c(k,{key:0},[he((r(),E(W(n(ae)),null,null,512)),[[be,g<=m.value]]),he((r(),E(W(n(j)),null,null,512)),[[be,!(g<=m.value)]])],64)),s(g)?(r(),c(k,{key:1},[(r(),E(W(n(j)),{class:N([n(v).em("decimal","box")])},null,8,["class"])),y(n(ye),{style:Q(n(ee)),class:N([n(v).e("icon"),n(v).e("decimal")])},{default:Z(()=>[(r(),E(W(n(oe))))]),_:1},8,["style","class"])],64)):P("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),a.showText||a.showScore?(r(),c("span",{key:0,class:N(n(v).e("text")),style:Q({color:a.textColor})},f(n(T)),7)):P("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var to=Ne(ao,[["__file","rate.vue"]]);const lo=Ae(to),so={class:"container flex"},no={class:"menu"},ro={class:"info-row"},io={class:"collection"},uo={class:"nav"},co={class:"collection-list-tag"},mo={key:0,class:"white-card"},po={class:"product-left"},fo=["src"],vo={style:{"line-height":"2"}},_o={class:"product-right"},ho={class:"lab-text"},bo={key:0},yo={class:"tips"},go={class:"lab-text"},Vo={key:0,class:"label-list"},wo=["onClick"],Co=["onClick"],Io={key:1,class:"label-edit-input"},ko=["onClick"],To={key:1,class:"label-list"},xo={class:"label-item-txt"},So={class:"lab-text"},$o={key:1},No={class:"tips"},Eo={class:"lab-text"},Po={key:1},Ao=re({__name:"Info",setup(x){const H=Fe(),{t:V}=De(),e=I(["1分","2分","3分","4分","5分"]),A=I(!0),M=I(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),_=I([]);Oe(()=>{R()});const R=async()=>{try{_.value=[];const o=await Qe({id:v.currentRoute.value.query.id});o.items.map(p=>{p.allCommentTag=JSON.parse(JSON.stringify(M.value)),Object.assign(p,{commentRank:0,content:"",showPics:[],commentTag:[],isAdd:!1,rankVerification:!0,contentVerification:!0,isCommentInfo:!!p.commentInfo},p.commentInfo)}),Object.assign(_.value,o.items),_.value.every(p=>p.isShowed===1)&&Me("/member/comment/list?orderType=2")}catch(o){q.error(o.message)}finally{A.value=!1}},v=He(),w=I(""),U=o=>{_.value[o].isAdd=!_.value[o].isAdd},m=o=>{if(w.value!==""){const l=JSON.parse(JSON.stringify(_.value[o].allCommentTag));l.push(w.value),_.value[o].allCommentTag=l,S(o,w.value)}w.value="",_.value[o].isAdd=!1},S=(o,l)=>{let p=_.value[o].commentTag;p.includes(l)?_.value[o].commentTag=p.filter(T=>T!==l):p.push(l)},C=async(o,l)=>{if(o.commentRank<1){o.rankVerification=!1;return}if(o.content==""){o.contentVerification=!1;return}if(o.content.length<10){q.error(V("购买心得最少10个字"));return}try{const p={productId:o.productId,orderId:o.orderId,orderItemId:o.itemId,shopId:o.shopId,commentRank:o.commentRank,commentTag:o.commentTag,content:o.content,showPics:o.showPics},T=await Xe(p);o.rankVerification=!0,o.contentVerification=!0,q.success(V("评价成功")),R()}catch(p){q.error(p.message)}finally{}};return(o,l)=>{const p=we,T=Ce,B=Ie,Y=ke,L=Te,ee=lo,F=Je,oe=Ue,j=qe,ae=Ge;return r(),c(k,null,[y(p),y(T,{title:"评价晒单"}),t("div",so,[t("div",no,[y(B)]),t("div",ro,[t("div",io,[t("div",uo,[t("div",co,f(o.$t("订单评价")),1),t("div",null,[G(f(o.$t("评价立送")),1),l[1]||(l[1]=t("span",{class:"font-color"},"5",-1)),G(f(o.$t(n(H).integralName))+"，"+f(o.$t("晒单额外赠送")),1),l[2]||(l[2]=t("span",{class:"font-color"},"5",-1)),G(f(o.$t(n(H).integralName)),1)])]),(r(!0),c(k,null,O(_.value,(s,$)=>(r(),c("div",null,[s.isShowed?P("",!0):(r(),c("div",mo,[t("div",po,[y(L,{title:s.productName,to:("urlFormat"in o?o.urlFormat:n(Re))({path:"product",id:s.productId,sn:s.productSn}),class:"nuxt",target:"_blank"},{default:Z(()=>[t("div",null,[t("img",{alt:"",src:("imageFormat"in o?o.imageFormat:n(Ve))(s.picThumb)},null,8,fo)]),t("div",null,[t("div",vo,[t("a",null,f(s.productName),1)]),t("div",null,[y(Y,{modelValue:s.price,"onUpdate:modelValue":u=>s.price=u,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1032,["title","to"])]),t("div",_o,[t("div",null,[t("span",ho,f(o.$t("商品评分"))+"：",1),t("span",null,[y(ee,{disabled:s.isCommentInfo,modelValue:s.commentRank,"onUpdate:modelValue":u=>s.commentRank=u,size:"large",texts:e.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),s.rankVerification?P("",!0):(r(),c("div",bo,[l[3]||(l[3]=t("span",{class:"lab-text"},null,-1)),t("p",yo,f(o.$t("请先评价商品")),1)])),t("div",null,[t("div",go,f(o.$t("评价标签"))+"：",1),s.isCommentInfo?(r(),c("div",To,[(r(!0),c(k,null,O(s.commentTag,u=>(r(),c("div",xo,[t("span",null,f(u),1)]))),256))])):(r(),c("div",Vo,[(r(!0),c(k,null,O(s.allCommentTag,u=>(r(),c("div",{style:Q({border:s.commentTag.includes(u)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:ie=>S($,u)},[t("span",null,f(o.$t(u)),1)],12,wo))),256)),s.isAdd?(r(),c("div",Io,[t("div",null,[y(F,{modelValue:w.value,"onUpdate:modelValue":l[0]||(l[0]=u=>w.value=u),autofocus:""},null,8,["modelValue"])]),t("p",{onClick:u=>m($)},f(o.$t("确定")),9,ko)])):(r(),c("div",{key:0,class:"label-edit",onClick:u=>U($)},[l[4]||(l[4]=t("div",null,null,-1)),t("p",null,f(o.$t("自定义")),1)],8,Co))]))]),t("div",null,[t("div",So,f(o.$t("购物心得"))+"：",1),y(F,{class:"label-textarea","show-word-limit":!0,modelValue:s.content,"onUpdate:modelValue":u=>s.content=u,disabled:s.isCommentInfo,rows:5,type:"textarea",minlength:10,maxlength:500,placeholder:o.$t("商品是否给力？快分享你的购买心得吧~")},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])]),s.contentVerification?P("",!0):(r(),c("div",$o,[l[5]||(l[5]=t("span",{class:"lab-text"},null,-1)),t("p",No,f(o.$t("请填写购买心得")),1)])),t("div",null,[t("div",Eo,f(o.$t("晒单"))+"：",1),s.isShowed?(r(),c("div",Po,[(r(!0),c(k,null,O(s.showPics,u=>(r(),E(oe,{src:("imageFormat"in o?o.imageFormat:n(Ve))(u.picThumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"]))),256))])):(r(),E(Ze,{key:0,uploadList:s.showPics,"onUpdate:uploadList":u=>s.showPics=u,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),t("div",null,[y(j,{type:"primary",onClick:u=>C(s)},{default:Z(()=>[G(f(o.$t("提交评论")),1)]),_:2},1032,["onClick"])])])]))]))),256))])])]),y(ae)],64)}}}),va=Be(Ao,[["__scopeId","data-v-98fc98f4"]]);export{va as default};

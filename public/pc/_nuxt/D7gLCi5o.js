import{_ as a}from"./IO9hpqeh.js";import{_ as s}from"./Dw0vWOz4.js";import{_ as t}from"./BR_yKGQj.js";import{e,G as o,r as l,z as r,y as i,p as c,ad as n,R as m,c as d,o as p,b as v,a as u,t as y,j,d as f,i as w,E as h,_ as g}from"./r4GZdGYg.js";import{_ as $}from"./DkwXwj3h.js";import{E as k}from"./Oz6DVX0g.js";import"./5EY5iYNX.js";import"./YKVlRHu9.js";import"./bHTXMzV5.js";import{a as _,o as b,c as C}from"./74RQ6hvW.js";import{Q as I}from"./xSPxQ0UB.js";import{w as x,z as S}from"./CAihOkzd.js";import{s as V}from"./DSXY0Md2.js";import"./70QeHNk8.js";import"./BPBPggU1.js";import"./CDFFSI_k.js";import"./DgAv7tgp.js";import"./g8XVjk5f.js";import"./BNGL4P8m.js";import"./Bd103Yf7.js";import"./CIKxL71l.js";import"./DL5ZnEaR.js";import"./VWWcEZs1.js";const z={class:"wechat-com"},L={class:"wechat container"},U={class:"message"},q={class:"message"},A={class:"payment"},B={key:0,class:"title"},E={key:1,class:"title"},P={class:"image-div"},Q={class:"left-image"},R={key:0,class:"ewm"},D={key:1,class:"ewm-empty"},G={class:"pw-box-ft"},M={key:0},O={key:1},T={class:"right-image"},X={key:0,class:"image"},Y={key:1,class:"image"},Z=g(e({__name:"yabanpay",setup(e){const g=o(),Z=l(g.query.id),F=l(g.query.type),H=l(!0);l({});const J=l(""),K=l({}),{t:N}=r();(async()=>{try{const a=await b({id:Z.value});K.value=a.order}catch(a){c.error(a.message),n("/member/order/list/")}})();const W=l(0);let aa=null;i(()=>{(async()=>{H.value=!0;try{const a=await C({id:Z.value,type:"yabanpay_"+F.value});ta(null==a?void 0:a.payInfo.codeUrl)}catch(a){c.error(a.message)}finally{H.value=!1}})(),aa=V(()=>{sa(),W.value++,50===W.value&&(clearInterval(aa),c.error(N("支付已超时，您可以刷新页面重新支付")))},2e3)});const sa=()=>{_({id:Z.value}).then(a=>{1==a&&(clearInterval(aa),k.confirm(N("订单支付成功"),N("提示"),{confirmButtonText:N("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{n("/member/order/list")}).catch(()=>{}))})},ta=async a=>{const s=a;J.value=await I.toDataURL(s,{margin:1,width:500,height:500})},ea=()=>{window.close()},oa=()=>{window.location.reload()};return m(()=>{clearInterval(aa)}),(e,o)=>{const l=a,r=s,i=t,c=h,n=$;return p(),d("div",null,[v(l,{title:"YabandPay"}),v(r,{showLogin:!1}),u("div",z,[u("div",L,[u("div",U,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(j(K).orderSn),1),u("div",q,[f(y(e.$t("应付金额"))+"： ",1),v(i,{modelValue:j(K).totalAmount,"onUpdate:modelValue":o[0]||(o[0]=a=>j(K).totalAmount=a),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),u("div",A,["wechat"==j(F)?(p(),d("div",B,y(e.$t("微信支付")),1)):w("",!0),"alipay"==j(F)?(p(),d("div",E,y(e.$t("支付宝支付")),1)):w("",!0),u("div",P,[u("div",Q,[u("div",null,[f(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),u("span",{onClick:oa,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),f(y(e.$t("页面重新获取二维码"))+"。 ",1)]),j(W)<=50?(p(),d("div",R,[v(c,{class:"image",src:j(J)},null,8,["src"])])):(p(),d("div",D,[f(y(e.$t("已超时"))+"，",1),u("a",{class:"font-color",onClick:oa},y(e.$t("点击刷新")),1)])),u("div",G,["wechat"==j(F)?(p(),d("div",M,y(e.$t("请使用微信扫一扫")),1)):w("",!0),"alipay"==j(F)?(p(),d("div",O,y(e.$t("请使用支付宝扫一扫")),1)):w("",!0),u("div",null,y(e.$t("扫描二维码支付")),1)])]),u("div",T,["wechat"==j(F)?(p(),d("div",X,[v(c,{src:j(x)},null,8,["src"])])):w("",!0),"alipay"==j(F)?(p(),d("div",Y,[v(c,{src:j(S)},null,8,["src"])])):w("",!0)])]),u("div",{onClick:ea,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),v(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-1e2c7646"]]);export{Z as default};

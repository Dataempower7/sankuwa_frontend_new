import{b as Y}from"./5VTus1_X.js";import{_ as Z}from"./Drr4mNEN.js";import{_ as ee}from"./DUyqL_E3.js";import{_ as te}from"./CrI35J-I.js";import{e as oe,z as le,r as c,v as ae,ar as re,y as se,p as g,H as ne,I as ue,h as de,c as i,o as n,b as a,a as o,ad as ie,t as s,F as h,m as I,w as d,i as k,E as me,j as N,k as pe,s as ce,n as T,d as U,ah as _e,_ as fe}from"./BjkHNVA8.js";import{_ as ve}from"./BipSnJcb.js";import{_ as he}from"./CBcH1uzJ.js";import{E as be}from"./Xh6SD5hO.js";import{a as ye,E as ge}from"./ClRMjIOJ.js";import{E as Ie,a as Ve}from"./Ckzsp_T1.js";import{E as $e,a as we}from"./FYm-MTMW.js";import{E as Ee}from"./BhwkTUtM.js";import{E as Ae}from"./B_vjKAZC.js";import{_ as Re}from"./B85mN9rA.js";import{v as Se}from"./DWKyHDnW.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./C1B8-dXF.js";import"./cfDoaBtk.js";import{g as ke,a as Ne,u as Te}from"./Pa5C9ETO.js";import{U as Ue}from"./BrM2Mo0y.js";import"./CM_M6Xgj.js";import"./n1vI1_Nv.js";import"./BzIkMksr.js";import"./Csy7st1x.js";import"./Ibc-iJtI.js";import"./UVx7YjW9.js";import"./BKu6lkEW.js";import"./CH9-T1LE.js";import"./XdJ5ILcf.js";import"./d3UjsK-T.js";import"./B-yDVAuh.js";import"./BIqqf5dq.js";import"./CXwPJP5h.js";import"./Bnvi_g-K.js";import"./yB3A8U-z.js";import"./BNVM5YSV.js";import"./DoNaAjK4.js";import"./BsZFmHoh.js";const Fe={class:"container flex"},xe={class:"menu"},qe={class:"info-row"},Ce={class:"title-or-tabs"},Le={class:"tag-and-input"},Me={class:"tig-tabs"},ze={key:0,class:"log-return-content"},Be={class:"info-card"},Pe={class:"table-header"},De={class:"header-cell"},je={class:"header-cell",style:{width:"90px"}},Ge={class:"header-cell",style:{width:"90px"}},He={class:"header-cell",style:{width:"90px"}},Oe={class:"header-cell",style:{width:"90px"}},Qe={class:"header-cell",style:{width:"90px"}},Je={key:0,class:"gift-tag"},Ke={class:"pro_pic-box"},We={class:"text-ellipsis"},Xe={class:"name"},Ye={class:"value"},Ze={key:0},et={class:"file-card"},tt={key:1,class:"log-return-content"},ot=oe({__name:"Info",setup(lt){const{t:F}=le(),b=c([]),$=c([]),_=c([]),r=c({items:[],pics:[],refundAmount:0,refundAmountMax:0});ae(()=>{let e=f.currentRoute.value.query.itemId,l=f.currentRoute.value.query.orderId;if(l&&e)return"one";if(!e&&l)return"all"});const y=c(!0);se(async()=>{await x(),await q()});const x=async()=>{try{let e={itemId:f.currentRoute.value.query.itemId?f.currentRoute.value.query.itemId:void 0,orderId:f.currentRoute.value.query.orderId?f.currentRoute.value.query.orderId:void 0};r.value.orderId=Number(e.orderId);const l=await ke({...e});r.value.orderStatus=l.order.orderStatus,b.value=l.list,b.value.forEach(p=>{p.number=0});let u=0;l.list.forEach((p,A)=>{u=u+Number(p.canApplyQuantity*p.price)}),w.value=l?.order?.productAmount,E.value=l?.order?.totalAmount,u=u/Number(w.value)*Number(E.value),r.value.refundAmountMax=u.toFixed(2)}catch(e){g.error(e.message)}finally{y.value=!1}},q=async()=>{try{const e=await Ne();if($.value=e.aftersaleReason,_.value=e.aftersaleType,r.value.orderStatus==1)for(let l in _.value)_.value[l]===F("退货/退款")&&delete _.value[l]}catch(e){g.error(e.message)}finally{y.value=!1}},w=c(),E=c();ne(()=>b.value,e=>{let l=0;e.forEach((u,p)=>{l=l+Number(u.number*u.price)}),r.value.refundAmount=l},{deep:!0,immediate:!0});function C(e){return e?Object.entries(e).map(([l,u])=>({id:Number(l),name:String(u)})):[]}const V=ue(),L=async()=>{try{await V.value.validate(),r.value.orderItemId=r.value.itemId,r.value.items=[],b.value.forEach(l=>{r.value.items.push({orderItemId:l.itemId,number:l.number})});const e=await Te({...r.value});g.success("提交成功"),await V.value.resetFields(),_e("/member/return/log")}catch(e){e.message&&g.error(e.message)}finally{y.value=!1}},f=re(),M=de([{value:"退/换货申请",url:"/member/return/list",size:0},{value:"申请记录",url:"/member/return/log",size:0}]);return(e,l)=>{const u=Y,p=Z,A=ee,z=te,B=me,P=ve,R=he,D=be,j=ge,G=ye,v=Ie,H=we,O=$e,S=Ee,Q=Ae,J=Ve,K=Re,W=Se;return n(),i(h,null,[a(u),a(p,{title:"退/换货申请"}),o("div",Fe,[o("div",xe,[a(A)]),o("div",qe,[o("div",Ce,[o("div",Le,[o("div",Me,[a(z,{menuList:M},null,8,["menuList"])])])]),y.value?ie((n(),i("div",tt,null,512)),[[W,y.value]]):(n(),i("div",ze,[o("div",Be,[o("table",null,[o("thead",Pe,[o("tr",null,[o("th",De,s(e.$t("商品名称")),1),o("th",je,s(e.$t("商品价格")),1),o("th",Ge,s(e.$t("购买数量")),1),o("th",He,s(e.$t("小计")),1),o("th",Oe,s(e.$t("可退换数量")),1),o("th",Qe,s(e.$t("退/换数量")),1)])]),o("tbody",null,[(n(!0),i(h,null,I(b.value,t=>(n(),i("tr",null,[o("td",null,[a(P,{title:t.productName,to:N(ce)({path:"product",id:t.itemId,sn:t.productSn}),class:"nuxt",target:"_blank"},{default:d(()=>[t.isGift===1?(n(),i("div",Je,s(e.$t("赠品")),1)):k("",!0),o("div",Ke,[a(B,{src:("imageFormat"in e?e.imageFormat:N(pe))(t.picThumb),class:"pro_pic",loading:"lazy",style:{transition:"opacity 0.2s linear"}},null,8,["src"])]),o("div",We,[o("ul",null,[o("li",null,s(e.$t("货号"))+"："+s(t.productSn),1),o("li",null,s(t.productName),1),o("li",null,[(n(!0),i(h,null,I(t.skuData,(m,X)=>(n(),i(h,null,[o("span",Xe,s(m.name)+"：",1),o("span",Ye,s(m.value),1),X<t.skuData?.length-1?(n(),i("span",Ze,"；")):k("",!0)],64))),256))])])])]),_:2},1032,["title","to"])]),o("td",null,[a(R,{modelValue:t.price,"onUpdate:modelValue":m=>t.price=m,fontStyle:{color:"var(--price)"},showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,s(t.quantity),1),o("td",null,[a(R,{modelValue:t.subtotal,"onUpdate:modelValue":m=>t.subtotal=m,fontStyle:{color:"var(--price)"},showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,s(t.canApplyQuantity),1),o("td",null,[a(D,{modelValue:t.number,"onUpdate:modelValue":m=>t.number=m,modelModifiers:{number:!0},max:t.canApplyQuantity,min:0,clearable:"",disabled:t.isGift===1,placeholder:e.$t("请输入数量")},null,8,["modelValue","onUpdate:modelValue","max","disabled","placeholder"])])]))),256))])])]),o("div",et,[a(J,{ref_key:"formRef",ref:V,"label-width":"auto",model:r.value,class:"form-body","label-suffix":"："},{default:d(()=>[a(v,{rules:[{required:!0,message:e.$t("请选择服务类型")}],label:e.$t("服务类型"),prop:"aftersaleType"},{default:d(()=>[a(G,{modelValue:r.value.aftersaleType,"onUpdate:modelValue":l[0]||(l[0]=t=>r.value.aftersaleType=t)},{default:d(()=>[(n(!0),i(h,null,I(C(_.value?_.value:{}),t=>(n(),T(j,{value:t.id},{default:d(()=>[U(s(e.$t(t.name)),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["rules","label"]),a(v,{rules:[{required:!0,message:e.$t("请选择售后原因")}],label:e.$t("售后原因"),prop:"aftersaleReason"},{default:d(()=>[a(O,{modelValue:r.value.aftersaleReason,"onUpdate:modelValue":l[1]||(l[1]=t=>r.value.aftersaleReason=t),placeholder:e.$t("请选择"),style:{width:"500px"}},{default:d(()=>[(n(!0),i(h,null,I($.value,(t,m)=>(n(),T(H,{key:t,label:e.$t(t),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules","label"]),a(v,{label:e.$t("预计退款金额"),prop:"refundAmount"},{default:d(()=>[a(S,{disabled:"",modelValue:r.value.refundAmount,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value.refundAmount=t),clearable:"",placeholder:e.$t("请输入申请金额")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(v,{rules:[{required:!0,message:e.$t("问题描述不能为空")}],label:e.$t("问题描述"),prop:"description"},{default:d(()=>[a(S,{modelValue:r.value.description,"onUpdate:modelValue":l[3]||(l[3]=t=>r.value.description=t),row:4,clearable:"",placeholder:e.$t("请输入问题描述"),type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["rules","label"]),a(v,{label:e.$t("上传文件")},{default:d(()=>[a(Ue,{uploadList:r.value.pics,"onUpdate:uploadList":l[4]||(l[4]=t=>r.value.pics=t),fileTypes:["gif","jpeg","png","word","excel","txt","zip","ppt","pdf"],limit:5},null,8,["uploadList"])]),_:1},8,["label"]),a(v,{label:""},{default:d(()=>[a(Q,{type:"primary",onClick:L},{default:d(()=>[U(s(e.$t("提交")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]))])]),a(K)],64)}}}),Ht=fe(ot,[["__scopeId","data-v-e122dd3a"]]);export{Ht as default};

import{a as ie,E as de}from"./Ckzsp_T1.js";import{E as te}from"./BhwkTUtM.js";import{E as se}from"./B_vjKAZC.js";import{E as ue}from"./BsZFmHoh.js";import{aL as q,b8 as A,e as me,f as ne,z as pe,r as M,v as z,I as be,h as ve,g as Ce,c as p,o as b,F as v,b as r,a as R,w as i,j as s,i as fe,d as C,t as f,av as h,a6 as we,p as w,_ as ye}from"./BjkHNVA8.js";/* empty css        *//* empty css        */import"./Ibc-iJtI.js";import{M as S}from"./DYce8M0P.js";import"./C1B8-dXF.js";import"./FYm-MTMW.js";import"./cfDoaBtk.js";import{_ as x}from"./DbAxkXJA.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./Bnvi_g-K.js";import"./BKu6lkEW.js";import"./d3UjsK-T.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";import"./x_rD_Ya3.js";const Me=t=>q({url:"user/user/sendMobileCodeByMobileValidate",method:"post",data:t}),ge=t=>q({url:"user/user/mobileValidate",method:"post",data:t}),j=t=>q({url:"user/user/sendMobileCodeByModifyMobile",method:"post",data:t}),Ve=t=>q({url:"user/user/modifyMobile",method:"post",data:t}),Ee=t=>q({url:"user/user/sendMobileCodeByModifyPassword",method:"post",data:t}),$e=t=>q({url:"user/user/checkModifyPasswordMobileCode",method:"post",data:t}),Se=t=>A({url:"user/user/sendEmailCodeByEmailValidate",method:"post",data:t}),Ue=t=>A({url:"user/user/emailValidateNew",method:"post",data:t}),Z=t=>A({url:"user/user/sendEmailCodeByModifyEmail",method:"post",data:t}),L=t=>A({url:"user/user/modifyEmail",method:"post",data:t}),qe={style:{padding:"10px"}},ze=me({__name:"VerificationSecurity",props:{params:{type:Object,default:{}}},emits:["loadFilter"],setup(t,{emit:T}){const U=ne(),{t:u}=pe(),g=M(""),k=M(!1),W=z(()=>l.value.mobile==""||l.value.mobileCode==""||k.value==!1),n=M(!1),I=z(()=>l.value.newMobile==""||l.value.newMobileCode==""||n.value==!1),B=M(!1),G=z(()=>l.value.mobile==""||l.value.mobileCode==""||B.value==!1),H=z(()=>l.value.email==""||l.value.newEmail==""),J=()=>{l.value.email=l.value.newEmail},P=t,V=M(!1),c=M(!0),O=M(!0),l=M({}),y=be(),K=async()=>{V.value=!0,c.value=!0,y.value&&await y.value.resetFields(),console.log(P.params),l.value.mobile=P.params.mobile,l.value.email=P.params.email},Q=async()=>{await y.value.validate();try{let o={mobile:l.value.mobile,code:l.value.mobileCode};const e=await ge({...o});c.value=!1}catch(o){o.message&&w.error(o.message)}finally{}},X=async()=>{await y.value.validate();try{let o={email:l.value.email,code:l.value.emailCode};await Ue({...o}),O.value=!1}catch(o){o.message&&w.error(o.message)}finally{}},F=T,D=async()=>{await y.value.validate();try{let o={mobile:U.isOpenMobileAreaCode?g.value+l.value.newMobile:l.value.newMobile,code:l.value.newMobileCode};const e=await Ve({...o});w.success(u("修改成功")),V.value=!1,F("loadFilter")}catch(o){o.message&&w.error(o.message)}finally{}},Y=async()=>{await y.value.validate();try{let o={email:l.value.newEmail,code:l.value.newEmailCode};const e=await L({...o});w.success(u("修改成功")),V.value=!1,F("loadFilter")}catch(o){o.message&&w.error(o.message)}finally{}},_=async()=>{await y.value.validate();try{let o={email:l.value.email,code:l.value.emailCode};await L({...o}),w.success(u("绑定成功")),V.value=!1,F("loadFilter")}catch(o){o.message&&w.error(o.message)}finally{}},ee=ve({password:[{validator:(o,e,d)=>{if(e){if(e.length>20||e.length<6)return d(new Error(u("密码应为6-20位字符")));if(/\s/.test(e))return d(new Error(u("密码中不允许有空格")));if(/^\d+$/.test(e))return d(new Error(u("密码不能全为数字")));if(/^(?=.*[\d\W]).+$/.test(e))if(/^(?=.*[a-zA-Z0-9]).+$/.test(e))if(/^(?!([a-zA-Z0-9])\1*$).+$/.test(e))d();else return d(new Error(u("密码不能全为相同字符或数字")));else return d(new Error(u("密码不能全为符号")));else return d(new Error(u("密码不能全为字母")))}else return d(new Error(u("密码不能为空")))},trigger:"blur",required:!0}],confirmPassword:[{validator:(o,e,d)=>{if(e){if(e!=l.value.password)return d(new Error(u("两次密码不一致")));d()}else return d(new Error(u("请再次输入密码")))},trigger:"change",required:!0}],newMobile:[{validator:(o,e,d)=>{const m=U.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+86)?1(?:3[0-9]|4[5-9]|5[0-35-9]|6[5-7]|7[0-8]|8[0-9]|9[189])\d{8}$/;if(e)if(m.test(e))d();else return d(new Error(u("格式错误，请输入正确的手机号码")));else return d(new Error(u("手机号不能为空")))},required:!0}]}),le=async()=>{await y.value.validate();try{let o={password:l.value.password,code:l.value.mobileCode};await $e({...o}),w.success(u("修改成功")),await N.loginOut(),V.value=!1}catch(o){o.message&&w.error(o.message)}finally{}},N=Ce();N.getUserInfo();const oe=M(""),E=o=>{oe.value=o};return(o,e)=>{const d=de,m=te,$=se,ae=ie,re=ue;return b(),p(v,null,[r(re,{modelValue:V.value,"onUpdate:modelValue":e[31]||(e[31]=a=>V.value=a),"close-on-click-modal":!1,title:t.params.title,"z-index":900,width:"450"},{default:i(()=>[R("div",qe,[r(ae,{ref_key:"formRef",ref:y,model:l.value,rules:s(ee),class:"form-body","label-suffix":"："},{default:i(()=>[t.params.type==1?(b(),p(v,{key:0},[c.value?(b(),p(v,{key:0},[r(d,{label:o.$t("原手机号")},{default:i(()=>[C(f(l.value.mobile),1)]),_:1},8,["label"]),r(d,{rules:[{required:!0,message:o.$t("请输入验证码")}],label:"",prop:"mobileCode"},{default:i(()=>[r(m,{modelValue:l.value.mobileCode,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.mobileCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{mobile:l.value.mobile,"onUpdate:mobile":e[0]||(e[0]=a=>l.value.mobile=a),mobileCode:l.value.mobileCode,"onUpdate:mobileCode":e[1]||(e[1]=a=>l.value.mobileCode=a),mobileCodeSended:k.value,"onUpdate:mobileCodeSended":e[2]||(e[2]=a=>k.value=a),requestApi:s(Me),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{disabled:s(W),style:{width:"100%"},type:"primary",onClick:Q,size:"large"},{default:i(()=>[C(f(o.$t("下一步")),1)]),_:1},8,["disabled"])],64)):(b(),p(v,{key:1},[r(d,{label:"",prop:"newMobile"},{default:i(()=>[r(m,{modelValue:l.value.newMobile,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.newMobile=a),clearable:"",placeholder:o.$t("请输入手机号码"),size:"large"},h({_:2},[s(U).isOpenMobileAreaCode?{name:"prefix",fn:i(()=>[r(x,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=a=>g.value=a)},null,8,["modelValue"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),r(d,{rules:[{required:!0,message:o.$t("请输入验证码")}],label:"",prop:"newMobileCode"},{default:i(()=>[r(m,{modelValue:l.value.newMobileCode,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.newMobileCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{mobile:s(U).isOpenMobileAreaCode?g.value+l.value.newMobile:l.value.newMobile,mobileCode:l.value.newMobileCode,"onUpdate:mobileCode":e[6]||(e[6]=a=>l.value.newMobileCode=a),mobileCodeSended:n.value,"onUpdate:mobileCodeSended":e[7]||(e[7]=a=>n.value=a),requestApi:s(j),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{disabled:s(I),style:{width:"100%"},type:"primary",onClick:D,size:"large"},{default:i(()=>[C(f(o.$t("提交")),1)]),_:1},8,["disabled"])],64))],64)):t.params.type==2?(b(),p(v,{key:1},[r(d,{label:o.$t("手机号")},{default:i(()=>[C(f(l.value.mobile),1)]),_:1},8,["label"]),r(d,{rules:[{required:!0,message:o.$t("请输入验证码")}],label:"",prop:"mobileCode"},{default:i(()=>[r(m,{modelValue:l.value.mobileCode,"onUpdate:modelValue":e[12]||(e[12]=a=>l.value.mobileCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{mobile:l.value.mobile,"onUpdate:mobile":e[9]||(e[9]=a=>l.value.mobile=a),mobileCode:l.value.mobileCode,"onUpdate:mobileCode":e[10]||(e[10]=a=>l.value.mobileCode=a),mobileCodeSended:B.value,"onUpdate:mobileCodeSended":e[11]||(e[11]=a=>B.value=a),requestApi:s(Ee),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r(d,{label:"",prop:"password"},{default:i(()=>[r(m,{modelValue:l.value.password,"onUpdate:modelValue":e[13]||(e[13]=a=>l.value.password=a),clearable:"",placeholder:o.$t("请输入新密码"),size:"large"},null,8,["modelValue","placeholder"])]),_:1}),r(d,{label:"",prop:"confirmPassword"},{default:i(()=>[r(m,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":e[14]||(e[14]=a=>l.value.confirmPassword=a),clearable:"",placeholder:o.$t("请再次输入新密码"),size:"large"},null,8,["modelValue","placeholder"])]),_:1}),r($,{disabled:s(G),style:{width:"100%"},type:"primary",size:"large",onClick:le},{default:i(()=>[C(f(o.$t("提交")),1)]),_:1},8,["disabled"])],64)):t.params.type==3?(b(),p(v,{key:2},[r(d,{label:"",prop:"newMobile"},{default:i(()=>[r(m,{modelValue:l.value.newMobile,"onUpdate:modelValue":e[16]||(e[16]=a=>l.value.newMobile=a),clearable:"",placeholder:o.$t("请输入手机号码"),size:"large"},h({_:2},[s(U).isOpenMobileAreaCode?{name:"prefix",fn:i(()=>[r(x,{modelValue:g.value,"onUpdate:modelValue":e[15]||(e[15]=a=>g.value=a)},null,8,["modelValue"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),r(d,{rules:[{required:!0,message:o.$t("验证码不能为空")}],label:"",prop:"newMobileCode"},{default:i(()=>[r(m,{modelValue:l.value.newMobileCode,"onUpdate:modelValue":e[19]||(e[19]=a=>l.value.newMobileCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{mobile:s(U).isOpenMobileAreaCode?g.value+l.value.newMobile:l.value.newMobile,mobileCode:l.value.newMobileCode,"onUpdate:mobileCode":e[17]||(e[17]=a=>l.value.newMobileCode=a),mobileCodeSended:n.value,"onUpdate:mobileCodeSended":e[18]||(e[18]=a=>n.value=a),requestApi:s(j),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{disabled:s(I),style:{width:"100%"},type:"primary",onClick:D,size:"large"},{default:i(()=>[C(f(o.$t("提交")),1)]),_:1},8,["disabled"])],64)):t.params.type==4?(b(),p(v,{key:3},[O.value?(b(),p(v,{key:0},[r(d,{label:o.$t("原邮箱")},{default:i(()=>[C(f(l.value.email),1)]),_:1},8,["label"]),r(d,{rules:[{required:!0,message:o.$t("验证码不能为空")}],label:"",prop:"emailCode"},{default:i(()=>[r(m,{modelValue:l.value.emailCode,"onUpdate:modelValue":e[22]||(e[22]=a=>l.value.emailCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{email:l.value.email,mobileCode:l.value.emailCode,"onUpdate:mobileCode":e[20]||(e[20]=a=>l.value.emailCode=a),mobileCodeSended:n.value,"onUpdate:mobileCodeSended":e[21]||(e[21]=a=>n.value=a),requestApi:s(Se),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["email","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{disabled:s(H),style:{width:"100%"},type:"primary",onClick:X,size:"large"},{default:i(()=>[C(f(o.$t("下一步")),1)]),_:1},8,["disabled"])],64)):(b(),p(v,{key:1},[r(d,{label:"",prop:"newEmail"},{default:i(()=>[r(m,{modelValue:l.value.newEmail,"onUpdate:modelValue":e[23]||(e[23]=a=>l.value.newEmail=a),clearable:"",placeholder:o.$t("请输入邮箱"),size:"large",onInput:J},null,8,["modelValue","placeholder"])]),_:1}),r(d,{rules:[{required:!0,message:o.$t("请输入验证码")}],label:"",prop:"newEmailCode"},{default:i(()=>[r(m,{modelValue:l.value.newEmailCode,"onUpdate:modelValue":e[26]||(e[26]=a=>l.value.newEmailCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{email:l.value.newEmail,mobileCode:l.value.newEmailCode,"onUpdate:mobileCode":e[24]||(e[24]=a=>l.value.newEmailCode=a),mobileCodeSended:n.value,"onUpdate:mobileCodeSended":e[25]||(e[25]=a=>n.value=a),requestApi:s(Z),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["email","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{style:{width:"100%"},type:"primary",onClick:Y,size:"large"},{default:i(()=>[C(f(o.$t("提交")),1)]),_:1})],64))],64)):t.params.type==5?(b(),p(v,{key:4},[r(d,{label:"",prop:"email"},{default:i(()=>[r(m,{modelValue:l.value.email,"onUpdate:modelValue":e[27]||(e[27]=a=>l.value.email=a),clearable:"",placeholder:o.$t("请输入邮箱"),size:"large"},null,8,["modelValue","placeholder"])]),_:1}),r(d,{rules:[{required:!0,message:o.$t("请输入验证码")}],label:"",prop:"emailCode"},{default:i(()=>[r(m,{modelValue:l.value.emailCode,"onUpdate:modelValue":e[30]||(e[30]=a=>l.value.emailCode=a),placeholder:o.$t("请输入验证码"),type:"text",size:"large"},{suffix:i(()=>[r(s(S),{email:l.value.email,mobileCode:l.value.emailCode,"onUpdate:mobileCode":e[28]||(e[28]=a=>l.value.emailCode=a),mobileCodeSended:n.value,"onUpdate:mobileCodeSended":e[29]||(e[29]=a=>n.value=a),requestApi:s(Z),showMessage:!0,class:"mobile-code-text",onMobileErrorCallback:E},null,8,["email","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),r($,{style:{width:"100%"},type:"primary",onClick:_,size:"large"},{default:i(()=>[C(f(o.$t("提交")),1)]),_:1})],64)):fe("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"]),R("span",{onClick:K},[we(o.$slots,"default",{},void 0,!0)])],64)}}}),_e=ye(ze,[["__scopeId","data-v-6d2b4183"]]);export{_e as default};

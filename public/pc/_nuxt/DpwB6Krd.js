import{E as B}from"./HneMuvcA.js";import{_ as E}from"./CBcH1uzJ.js";import{_ as G}from"./BipSnJcb.js";import{v as R}from"./DWKyHDnW.js";import{e as z,ax as F,ay as f,r as V,h as P,bY as Y,c as l,o as n,a,i,b as m,w as U,t,ad as j,F as g,m as $,x as M,d as r,_ as q}from"./BjkHNVA8.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./CXwPJP5h.js";const A={class:"from"},H={class:"check-box"},J={class:"tit"},K={key:0,class:"from_list"},O={class:"coupon-box"},Q={key:0,class:"coupon_list"},W=["onClick"],X={class:"item-selected-cancel"},Z={key:0,class:"priceNum"},ee={key:0,class:"coupon-globle"},oe={key:1,class:"zk"},se={key:0,class:"coupon-globle"},te={class:"time"},le={class:"detail"},ne={key:2,class:"coupon-notice"},ae={key:3,class:"coupon-notice"},ie={class:"item-selected-cancel"},de={key:0,class:"priceNum"},ue={key:0,class:"coupon-globle"},ce={key:1,class:"zk"},pe={key:0,class:"coupon-globle"},re={class:"time"},me={class:"detail"},ve={key:2,class:"coupon-notice"},_e={key:3,class:"coupon-notice"},fe={key:1,class:"no-cou"},Ce=z({__name:"CouponInfo",props:{useCoupon:{type:Boolean},useCouponModifiers:{},couponList:{},couponListModifiers:{},couponLoading:{},couponLoadingModifiers:{},selectedIds:{},selectedIdsModifiers:{},selectedUserCouponIds:{},selectedUserCouponIdsModifiers:{}},emits:F(["change"],["update:useCoupon","update:couponList","update:couponLoading","update:selectedIds","update:selectedUserCouponIds"]),setup(v,{emit:L}){const k=L,C=f(v,"useCoupon"),u=f(v,"couponList"),N=f(v,"couponLoading"),x=V(0);P(["商品优惠券","优惠码兑换"]);const D=()=>{C.value===!1?(I.value=[],h.value=[],k("change")):k("change",!0)},I=f(v,"selectedIds"),h=f(v,"selectedUserCouponIds"),d=V([]);Y(()=>{u.value&&u.value.enableCoupons&&(d.value=u.value.enableCoupons.filter(o=>o.selected))});const T=o=>h.value?h.value.includes(o):!1,w=o=>{const s=Number(o.userCouponId);T(s)?d.value=d.value.filter(p=>p.userCouponId!==s):(d.value.findIndex(c=>c.shopId===o.shopId)>-1?d.value=d.value.filter(c=>c.shopId!==o.shopId):d.value.findIndex(_=>_.id===o.id)>-1&&(d.value=d.value.filter(_=>_.id!==o.id)),d.value.push(o)),I.value=d.value.map(({id:p})=>Number(p)),h.value=d.value.map(({userCouponId:p})=>Number(p)),k("change")};return(o,s)=>{const p=B,c=E,_=G,S=R;return n(),l("div",null,[a("div",A,[a("div",H,[m(p,{modelValue:C.value,"onUpdate:modelValue":s[0]||(s[0]=e=>C.value=e),onChange:D},{default:U(()=>[a("div",J,t(o.$t("使用优惠券")),1)]),_:1},8,["modelValue"])])]),C.value?(n(),l("div",K,[s[10]||(s[10]=a("div",{class:"arrow"},null,-1)),a("div",O,[i("",!0),j((n(),l("div",null,[x.value==0?(n(),l("div",Q,[u.value&&(u.value?.enableCoupons.length>0||u.value?.disableCoupons.length>0)?(n(),l(g,{key:0},[u.value?.enableCoupons.length>0?(n(!0),l(g,{key:0},$(u.value.enableCoupons,(e,y)=>(n(),l("div",{class:M(["coupon_item hand-pointer",{active:e.selected}]),type:"checkbox",onClick:b=>w(e)},[s[3]||(s[3]=a("div",{class:"c-top-dong"},null,-1)),a("div",X,t(o.$t("取消勾选")),1),e.couponType==1?(n(),l("div",Z,[m(c,{modelValue:e.couponMoney,"onUpdate:modelValue":b=>e.couponMoney=b},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(n(),l("span",ee,"["+t(o.$t("全场券"))+"]",1)):i("",!0)])):i("",!0),e.couponType==2?(n(),l("div",oe,[r(t(e.couponDiscount)+" ",1),a("span",null,t(o.$t("折")),1),e.isGlobal?(n(),l("span",se,"["+t(o.$t("全场券"))+"]",1)):i("",!0)])):i("",!0),a("div",te,t(o.$t("有效期至"))+t(e.endDate),1),a("div",le,t(e.couponName),1),s[4]||(s[4]=a("i",{class:"icon-gou"},null,-1)),e.disableReason?(n(),l("div",ne,[s[1]||(s[1]=a("i",{class:"iconfont-pc icon-tishi"},null,-1)),r(t(e.disableReason),1)])):i("",!0),e.selected&&e.couponType==1?(n(),l("div",ae,[s[2]||(s[2]=a("i",{class:"iconfont-pc icon-tishi"},null,-1)),r(" "+t(o.$t("已减")),1),m(c,{modelValue:e.couponMoney,"onUpdate:modelValue":b=>e.couponMoney=b},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0)],10,W))),256)):i("",!0),u.value&&u.value?.disableCoupons.length>0?(n(!0),l(g,{key:1},$(u.value.disableCoupons,e=>(n(),l("div",{class:M(["coupon_item hand-pointer disabled",{active:e.selected}]),type:"checkbox"},[s[7]||(s[7]=a("div",{class:"c-top-dong"},null,-1)),a("div",ie,t(o.$t("取消勾选")),1),e.couponType==1?(n(),l("div",de,[m(c,{modelValue:e.couponMoney,"onUpdate:modelValue":y=>e.couponMoney=y},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(n(),l("span",ue,"["+t(o.$t("全场券"))+"]",1)):i("",!0)])):i("",!0),e.couponType==2?(n(),l("div",ce,[r(t(e.couponDiscount)+" ",1),a("span",null,t(o.$t("折")),1),e.isGlobal?(n(),l("span",pe,"["+t(o.$t("全场券"))+"]",1)):i("",!0)])):i("",!0),a("div",re,t(o.$t("有效期至"))+t(e.endDate),1),a("div",me,t(e.couponName),1),s[8]||(s[8]=a("i",{class:"icon-gou"},null,-1)),e.disableReason?(n(),l("div",ve,[s[5]||(s[5]=a("i",{class:"iconfont-pc icon-tishi"},null,-1)),r(t(e.disableReason),1)])):i("",!0),e.selected&&e.couponType==2?(n(),l("div",_e,[s[6]||(s[6]=a("i",{class:"iconfont-pc icon-tishi"},null,-1)),r(" "+t(o.$t("已减")),1),m(c,{modelValue:e.couponMoney,"onUpdate:modelValue":y=>e.couponMoney=y},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0)],2))),256)):i("",!0)],64)):(n(),l("div",fe,[r(t(o.$t("暂无可用优惠券"))+"～",1),m(_,{target:"_blank",class:"font-color",to:"/coupon/list"},{default:U(()=>[r(t(o.$t("去领券")),1)]),_:1})]))])):i("",!0)])),[[S,N.value]]),i("",!0)])])):i("",!0)])}}}),Le=q(Ce,[["__scopeId","data-v-41e492e6"]]);export{Le as default};

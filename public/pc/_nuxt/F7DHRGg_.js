import{_ as E}from"./Drr4mNEN.js";import{_ as O}from"./paAvucAg.js";import{_ as S}from"./CBcH1uzJ.js";import{e as U,G as T,v as L,r as s,z as M,y as N,p as _,ah as Q,T as q,c as f,o as v,b as n,a as o,t,d as c,j as l,E as z,_ as D}from"./BjkHNVA8.js";import{_ as F}from"./B85mN9rA.js";import{E as H}from"./Csy7st1x.js";import"./B_vjKAZC.js";/* empty css        */import"./Ibc-iJtI.js";import{Q as j}from"./OUv6bgZh.js";import{e as G,f as W,d as x}from"./CfoQFCHA.js";import{s as A}from"./x_rD_Ya3.js";import"./XdJ5ILcf.js";import"./BipSnJcb.js";import"./n1vI1_Nv.js";import"./BNVM5YSV.js";import"./BhwkTUtM.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";const J={class:"wechat-com"},K={class:"wechat container"},X={class:"message"},Y={class:"message"},Z={class:"payment"},ee={class:"title"},oe={class:"image-div"},te={class:"left-image"},ae={key:0,class:"ewm"},se={key:1,class:"ewm-empty"},ne={class:"pw-box-ft"},re=U({__name:"wechat",setup(ie){const w=T(),m=L(()=>w.query.id),h=s(!0);s({});const g=s(""),d=s({amount:0});(async()=>{try{const e=await W({orderId:m.value});d.value=e.order}catch(e){_.error(e.message)}finally{}})();const C=async()=>{h.value=!0;try{const e=await x({id:m.value,type:"wechat"});await $(e?.payInfo.codeUrl)}catch(e){_.error(e.message)}finally{h.value=!1}},{t:r}=M(),p=s(0);let i=null;N(()=>{C(),i=A(()=>{I(),p.value++,p.value===50&&(clearInterval(i),_.error(r("支付已超时，您可以刷新页面重新支付")))},2e3)});const I=()=>{G({id:m.value}).then(e=>{e==1&&(clearInterval(i),H.confirm(r("充值成功"),r("提示"),{confirmButtonText:r("查看充值详情"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{Q("/member/account/detail")}).catch(()=>{}))})},$=async e=>{const a=e;let u={margin:1,width:500,height:500};g.value=await j.toDataURL(a,u)},k=()=>{window.close()},y=()=>{window.location.reload()};return q(()=>{clearInterval(i)}),(e,a)=>{const u=E,P=O,B=S,R=z,V=F;return v(),f("div",null,[n(u,{title:"微信支付"}),n(P,{showLogin:!1}),o("div",J,[o("div",K,[o("div",X,t(e.$t("订单提交成功，请尽快付款")),1),o("div",Y,[c(t(e.$t("应付金额"))+"： ",1),n(B,{modelValue:l(d).amount,"onUpdate:modelValue":a[0]||(a[0]=b=>l(d).amount=b),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),o("div",Z,[o("div",ee,t(e.$t("微信支付")),1),o("div",oe,[o("div",te,[o("div",null,[c(t(e.$t("如果二维码已过期"))+"，",1),o("span",{onClick:y,class:"font-color",style:{cursor:"pointer"}},t(e.$t("刷新")),1),c(t(e.$t("重新获取二维码"))+"。 ",1)]),l(p)<=50?(v(),f("div",ae,[n(R,{class:"image",src:l(g)},null,8,["src"])])):(v(),f("div",se,[c(t(e.$t("已超时"))+"，",1),o("a",{class:"font-color",onClick:y},t(e.$t("点击刷新")),1)])),o("div",ne,[o("div",null,t(e.$t("请使用微信扫一扫")),1),o("div",null,t(e.$t("扫描二维码支付")),1)])]),a[1]||(a[1]=o("div",{class:"right-image"},[o("div",{class:"image"})],-1))]),o("div",{onClick:k,class:"button-title"},"< "+t(e.$t("选择其他支付方式")),1)])])]),n(V,{bg:"white",mt30:!1,type:1})])}}}),Ue=D(re,[["__scopeId","data-v-851a2321"]]);export{Ue as default};

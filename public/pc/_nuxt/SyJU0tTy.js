import{_ as U}from"./Drr4mNEN.js";import{_ as z}from"./paAvucAg.js";import{_ as N}from"./CBcH1uzJ.js";import{e as T,G as q,r as l,z as L,y as M,p as g,ah as I,T as Q,c as a,o as n,b as i,a as s,t,j as o,d as y,i as c,E as D,_ as F}from"./BjkHNVA8.js";import{_ as H}from"./B85mN9rA.js";import{E as j}from"./Csy7st1x.js";import"./B_vjKAZC.js";/* empty css        */import"./Ibc-iJtI.js";import{Q as G}from"./OUv6bgZh.js";import{w as W,z as Y}from"./DzflT03m.js";import{y as A}from"./CelpMH_K.js";import{e as J,f as K,d as X}from"./CfoQFCHA.js";import{s as Z}from"./x_rD_Ya3.js";import"./XdJ5ILcf.js";import"./BipSnJcb.js";import"./n1vI1_Nv.js";import"./BNVM5YSV.js";import"./BhwkTUtM.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";const x={class:"wechat-com"},ee={class:"wechat container"},te={class:"message"},oe={class:"message"},se={class:"payment"},ae={key:0,class:"title"},ne={key:1,class:"title"},re={class:"image-div"},ie={class:"left-image"},ce={key:0,class:"ewm"},le={key:1,class:"ewm-empty"},me={class:"pw-box-ft"},de={key:0},ue={key:1},pe={key:2},_e={class:"right-image"},ye={key:0,class:"image"},fe={key:1,class:"image"},he={key:2,class:"image"},ve=T({__name:"yunpay",setup(ge){const w=q(),f=l(w.query.id),r=l(w.query.type),k=l(!0);l({});const $=l(""),m=l({orderSn:"",amount:0}),{t:d}=L();(async()=>{try{const e=await K({orderId:f.value});m.value=e.order}catch(e){g.error(e.message),I("/member/account/detail")}finally{}})();const P=async()=>{k.value=!0;try{const e=await X({id:f.value,type:"yunpay_"+r.value});B(e?.payInfo.codeUrl)}catch(e){g.error(e.message)}finally{k.value=!1}},h=l(0);let u=null;M(()=>{P(),u=Z(()=>{b(),h.value++,h.value===50&&(clearInterval(u),g.error(d("支付已超时，您可以刷新页面重新支付")))},2e3)});const b=()=>{J({id:f.value}).then(e=>{e==1&&(clearInterval(u),j.confirm(d("订单支付成功"),d("提示"),{confirmButtonText:d("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{I("/member/account/detail")}).catch(()=>{}))})},B=async e=>{const p=e;let v={margin:1,width:500,height:500};$.value=await G.toDataURL(p,v)},S=()=>{window.close()},C=()=>{window.location.reload()};return Q(()=>{clearInterval(u)}),(e,p)=>{const v=U,V=z,R=N,_=D,E=H;return n(),a("div",null,[i(v,{title:"YunPay"}),i(V,{showLogin:!1}),s("div",x,[s("div",ee,[s("div",te,t(e.$t("订单提交成功，请尽快付款"))+"！"+t(e.$t("订单号"))+"："+t(o(m).orderSn),1),s("div",oe,[y(t(e.$t("应付金额"))+"： ",1),i(R,{modelValue:o(m).amount,"onUpdate:modelValue":p[0]||(p[0]=O=>o(m).amount=O),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),s("div",se,[o(r)=="wechat"?(n(),a("div",ae,t(e.$t("微信支付")),1)):c("",!0),o(r)=="alipay"?(n(),a("div",ne,t(e.$t("支付宝支付")),1)):c("",!0),s("div",re,[s("div",ie,[s("div",null,[y(t(e.$t("如果二维码已过期"))+"，"+t(e.$t("请")),1),s("span",{onClick:C,class:"font-color",style:{cursor:"pointer"}},t(e.$t("刷新")),1),y(t(e.$t("页面重新获取二维码"))+"。 ",1)]),o(h)<=50?(n(),a("div",ce,[i(_,{class:"image",src:o($)},null,8,["src"])])):(n(),a("div",le,[y(t(e.$t("已超时"))+"，",1),s("a",{class:"font-color",onClick:C},t(e.$t("点击刷新")),1)])),s("div",me,[o(r)=="wechat"?(n(),a("div",de,t(e.$t("请使用微信扫一扫")),1)):c("",!0),o(r)=="alipay"?(n(),a("div",ue,t(e.$t("请使用支付宝扫一扫")),1)):c("",!0),o(r)=="yunshanfu"?(n(),a("div",pe,t(e.$t("请使用云闪付扫一扫")),1)):c("",!0),s("div",null,t(e.$t("扫描二维码支付")),1)])]),s("div",_e,[o(r)=="wechat"?(n(),a("div",ye,[i(_,{src:o(W)},null,8,["src"])])):c("",!0),o(r)=="alipay"?(n(),a("div",fe,[i(_,{src:o(Y)},null,8,["src"])])):c("",!0),o(r)=="yunshanfu"?(n(),a("div",he,[i(_,{src:o(A)},null,8,["src"])])):c("",!0)])]),s("div",{onClick:S,class:"button-title"},"< "+t(e.$t("选择其他支付方式")),1)])])]),i(E,{bg:"white",mt30:!1,type:1})])}}}),Ye=F(ve,[["__scopeId","data-v-882674ff"]]);export{Ye as default};

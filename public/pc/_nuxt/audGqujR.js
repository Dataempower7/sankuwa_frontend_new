import{e,cw as a,as as l,z as s,r as t,cx as u,c as i,o as r,F as o,b as p,x as c,j as d,au as m,ar as n,w as v,X as f,a4 as h,a as y,E as b,cy as g,k as _,_ as T}from"./r4GZdGYg.js";import{E as U}from"./DzkGXNvy.js";import{E as j}from"./C4N9DVAQ.js";import"./bHTXMzV5.js";const $={class:"image"},I=T(e({__name:"UploadImage",props:a({limit:{type:Number,default:1},fileTypes:{type:Array,default:[]}},{uploadList:{default:[]},uploadListModifiers:{}}),emits:["update:uploadList"],setup(e){const a=l(),{t:T}=s(),I=t(),L=e,x=e=>{if(k.value.length>=L.limit)return g.error(T("已经达到上传数量限制")),!1;const a=e.type.replace(/.*\//,"");return L.fileTypes.includes(a)?!(e.size/1024/1024>2)||(g.error(T("只能上传2M以内的图片")),!1):(g.error(`${T("无法上传")} ${a} ${T("文件!")}${T("只能上传")} ${L.fileTypes.join(", ")} ${T("文件!")}`),!1)},E=u(e,"uploadList"),k=t([]);null!=E.value?E.value.length>0&&(E.value.forEach(e=>{e.url=_(e.picUrl)}),k.value=E.value):E.value=[];const w=t(""),F=t(!1),N=(e,a)=>{e&&E.value?E.value=E.value.filter(a=>a.picThumb!==e.picThumb):E.value=[]},V=(e=[],a)=>{1===L.limit&&k.value.length>0&&(k.value.pop(),E.value.pop(),I.value.clearFiles(),I.value.handleStart(e[0]),I.value.submit())},z=e=>{w.value=e.url,F.value=!0},M=(e,a)=>{try{E.value.push({picThumb:e.data.picThumb,picUrl:e.data.picUrl,picId:e.data.picId,picName:e.data.picName})}catch(l){}};return(l,s)=>{const t=f,u=U,g=b,_=j;return r(),i(o,null,[p(u,{ref_key:"upload",ref:I,"file-list":k.value,"onUpdate:fileList":s[0]||(s[0]=e=>k.value=e),action:d(m)+"/user/user/uploadImg",headers:d(a),"before-upload":x,"on-exceed":V,"on-preview":z,"on-remove":N,"on-success":M,limit:e.limit,multiple:e.limit>1,"list-type":"picture-card",class:c({"hide-upload-button":1==e.limit&&k.value.length>0})},n({_:2},[0===k.value.length?{name:"trigger",fn:v(()=>[p(t,null,{default:v(()=>[p(d(h))]),_:1})]),key:"0"}:void 0]),1032,["file-list","action","headers","limit","multiple","class"]),p(_,{modelValue:F.value,"onUpdate:modelValue":s[1]||(s[1]=e=>F.value=e)},{default:v(()=>[y("div",$,[p(g,{src:w.value,alt:"",fit:"cover"},null,8,["src"])])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-e6bcd535"]]);export{I as U};

import{_ as R}from"./Drr4mNEN.js";import{_ as T}from"./paAvucAg.js";import{_ as U}from"./CBcH1uzJ.js";import{e as L,G as M,r as a,z as N,y as O,p as _,ah as w,T as Q,c as f,o as v,b as n,a as e,t,j as r,d as m,E as q,_ as z}from"./BjkHNVA8.js";import{_ as A}from"./B85mN9rA.js";import{E as D}from"./Csy7st1x.js";import"./B_vjKAZC.js";/* empty css        */import"./Ibc-iJtI.js";import{a as F,o as H,c as j}from"./Dk0-O2Ek.js";import{Q as G}from"./OUv6bgZh.js";import{s as W}from"./x_rD_Ya3.js";import"./XdJ5ILcf.js";import"./BipSnJcb.js";import"./n1vI1_Nv.js";import"./BNVM5YSV.js";import"./BhwkTUtM.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";const J={class:"wechat-com"},K={class:"wechat container"},X={class:"message"},Y={class:"message"},Z={class:"payment"},x={class:"title"},oo={class:"image-div"},eo={class:"left-image"},to={key:0,class:"ewm"},so={key:1,class:"ewm-empty"},ao={class:"pw-box-ft"},no=L({__name:"wechat",setup(ro){const I=M(),d=a(I.query.id),h=a(!0);a({});const y=a(""),i=a({});(async()=>{try{const o=await H({id:d.value});i.value=o.order}catch(o){_.error(o.message),w("/member/order/list/")}finally{}})();const C=async()=>{h.value=!0;try{const o=await j({id:d.value,type:"wechat"});k(o?.payInfo.codeUrl)}catch(o){_.error(o.message)}finally{h.value=!1}},{t:l}=N(),p=a(0);let c=null;O(()=>{C(),c=W(()=>{$(),p.value++,p.value===50&&(clearInterval(c),_.error(l("支付已超时，您可以刷新页面重新支付")))},2e3)});const $=()=>{F({id:d.value}).then(o=>{o==1&&(clearInterval(c),D.confirm(l("订单支付成功"),l("提示"),{confirmButtonText:l("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{w("/member/order/list")}).catch(()=>{}))})},k=async o=>{const s=o;let u={margin:1,width:500,height:500};y.value=await G.toDataURL(s,u)},P=()=>{window.close()},g=()=>{window.location.reload()};return Q(()=>{clearInterval(c)}),(o,s)=>{const u=R,b=T,B=U,S=q,V=A;return v(),f("div",null,[n(u,{title:"微信支付"}),n(b,{showLogin:!1}),e("div",J,[e("div",K,[e("div",X,t(o.$t("订单提交成功，请尽快付款"))+"！"+t(o.$t("订单号"))+"："+t(r(i).orderSn),1),e("div",Y,[m(t(o.$t("应付金额"))+"： ",1),n(B,{modelValue:r(i).unpaidAmount,"onUpdate:modelValue":s[0]||(s[0]=E=>r(i).unpaidAmount=E),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),e("div",Z,[e("div",x,t(o.$t("微信支付")),1),e("div",oo,[e("div",eo,[e("div",null,[m(t(o.$t("如果二维码已过期"))+"，",1),e("span",{onClick:g,class:"font-color",style:{cursor:"pointer"}},t(o.$t("刷新")),1),m(t(o.$t("重新获取二维码"))+"。 ",1)]),r(p)<=50?(v(),f("div",to,[n(S,{class:"image",src:r(y)},null,8,["src"])])):(v(),f("div",so,[m(t(o.$t("已超时"))+"，",1),e("a",{class:"font-color",onClick:g},t(o.$t("点击刷新")),1)])),e("div",ao,[e("div",null,t(o.$t("请使用微信扫一扫")),1),e("div",null,t(o.$t("扫描二维码支付")),1)])]),s[1]||(s[1]=e("div",{class:"right-image"},[e("div",{class:"image"})],-1))]),e("div",{onClick:P,class:"button-title"},"< "+t(o.$t("选择其他支付方式")),1)])])]),n(V,{bg:"white",mt30:!1,type:1})])}}}),Uo=z(no,[["__scopeId","data-v-97b5e9d7"]]);export{Uo as default};

import{_ as e}from"./IO9hpqeh.js";import{_ as l}from"./Dw0vWOz4.js";import{E as a}from"./YKVlRHu9.js";import{_ as o}from"./y-2lx1u-.js";import{E as s,a as i}from"./Ceu3XlbY.js";import{_ as r}from"./BPBPggU1.js";import{E as t}from"./5EY5iYNX.js";import{_ as d}from"./DkwXwj3h.js";import{e as m,f as u,g as n,z as p,r as v,I as b,v as c,c as f,o as g,b as y,a as w,j as C,F as j,m as _,x as E,t as V,w as k,n as T,ar as $,d as h,l as x,cy as q,ad as A,_ as U}from"./r4GZdGYg.js";import{_ as S}from"./Csg6w5sP.js";import{s as F,a as M,u as z}from"./f4ICNxti.js";import{M as R}from"./C1r_DWrf.js";import"./CBKhgGlL.js";import"./DXQ6s2L8.js";import"./70QeHNk8.js";import"./Bd103Yf7.js";import"./g8XVjk5f.js";import"./CIKxL71l.js";import"./DL5ZnEaR.js";import"./DONyGZrs.js";import"./BNGL4P8m.js";import"./CDFFSI_k.js";import"./DgAv7tgp.js";import"./DSXY0Md2.js";import"./VWWcEZs1.js";const Z={class:"full-height-div"},I={class:"register-info"},O={key:0,class:"register-menu"},L={class:"menu-box"},N=["onClick"],W={key:1,class:"title"},Q={class:"label"},X={class:"area-code-input"},Y={class:"area-code-select"},B={class:"label"},D={class:"label"},G={class:"label"},H={class:"extra",style:{width:"330px"}},J=U(m({__name:"Register",setup(m){const U=u(),J=n(),{t:K}=p(),P=v(!1),ee=v("86"),le=b(),ae=[{label:K("手机号注册"),value:""},{label:K("邮箱注册"),value:"email"}],oe=(e,l,a)=>{me.value.tigTips[e]=l?{type:"valid",message:a}:{type:"error",message:a}},se=e=>{me.value.tigTips[e]={type:"info",message:re[e]}},ie=(e,l,a)=>l?6!=l.length?a(new Error(K("请输入6位验证码"))):void a():a(new Error(K("验证码不能为空"))),re={mobile:K("请填写正确的手机号码，以便接收订单通知，找回密码等"),email:K("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobileCode:K("请输入验证码"),password:K("6-20个大小写英文字母、符号或数字的组合")},te={mobile:[{validator:(e,l,a)=>{const o=U.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;return l?o.test(l)?void a():a(new Error(K("格式错误，请输入正确的手机号码"))):a(new Error(K("手机号不能为空")))},trigger:"blur",required:!0}],email:[{validator:(e,l,a)=>l?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(l)?void a():a(new Error(K("格式错误，请输入正确的邮箱地址"))):a(new Error(K("邮箱不能为空"))),trigger:"blur",required:!0}],mobileCode:[{validator:ie,trigger:"blur",required:!0}],emailCode:[{validator:ie,trigger:"blur",required:!0}],password:[{validator:(e,l,a)=>l?l.length>20||l.length<6?a(new Error(K("密码应为6-20位字符"))):/\s/.test(l)?a(new Error(K("密码中不允许有空格"))):/^\d+$/.test(l)?a(new Error(K("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(l)?/^(?=.*[a-zA-Z0-9]).+$/.test(l)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(l)?void a():a(new Error(K("密码不能全为相同字符或数字"))):a(new Error(K("密码不能全为符号"))):a(new Error(K("密码不能全为字母"))):a(new Error(K("密码不能为空"))),trigger:"blur",required:!0}]},de=v(!1),me=v({tigTips:{},registType:""}),ue=c(()=>U.isOpenMobileAreaCode?ee.value+me.value.mobile:me.value.mobile),ne=async()=>{await le.value.validate();try{de.value=!0;const e=await z({...me.value,mobile:ue.value});q.success(K("注册成功")),J.setToken(e.token),J.userInfoLoaded=!1,A("/member/")}catch(e){q.error(e.message)}finally{de.value=!1}},pe=e=>{q.error(e)};return(m,u)=>{const n=e,p=l,v=a,b=o,c=s,q=r,A=t,z=i,J=d;return g(),f(j,null,[y(n,{title:"注册"}),y(p,{type:"register"}),w("div",Z,[w("div",I,[1===C(U).openEmailRegister?(g(),f("div",O,[w("div",L,[(g(),f(j,null,_(ae,(e,l)=>w("div",{key:l,class:E(["menu-item",{active:me.value.registType===e.value}]),onClick:l=>{return a=e.value,me.value.registType=a,me.value.tigTips={},void("email"===a?(me.value.mobile="",me.value.mobileCode="",me.value.tigTips.mobile={type:"info",message:re.mobile}):(me.value.email="",me.value.tigTips.email={type:"info",message:re.email}));var a}},V(e.label),11,N)),64))])])):(g(),f("div",W,V(m.$t("会员注册")),1)),y(z,{ref_key:"formRef",ref:le,"hide-required-asterisk":!0,model:me.value,rules:te,"show-message":!1,class:"form-body","label-width":"auto",onValidate:oe},{default:k(()=>[me.value.registType?(g(),T(c,{key:1,prop:"email"},{default:k(()=>[w("div",B,V(m.$t("邮箱")),1),y(v,{modelValue:me.value.email,"onUpdate:modelValue":u[3]||(u[3]=e=>me.value.email=e),class:"input-border-style",onFocus:u[4]||(u[4]=e=>se("email"))},null,8,["modelValue"]),y(b,{info:me.value.tigTips.email},null,8,["info"])]),_:1})):(g(),T(c,{key:0,prop:"mobile"},{default:k(()=>[w("div",Q,V(m.$t("手机号")),1),w("div",X,[y(v,{modelValue:me.value.mobile,"onUpdate:modelValue":u[1]||(u[1]=e=>me.value.mobile=e),class:"input-border-style",onFocus:u[2]||(u[2]=e=>se("mobile"))},$({_:2},[C(U).isOpenMobileAreaCode?{name:"prefix",fn:k(()=>[w("div",Y,[y(S,{modelValue:ee.value,"onUpdate:modelValue":u[0]||(u[0]=e=>ee.value=e)},null,8,["modelValue"])])]),key:"0"}:void 0]),1032,["modelValue"])]),y(b,{info:me.value.tigTips.mobile},null,8,["info"])]),_:1})),y(c,{prop:me.value.registType?"emailCode":"mobileCode"},{default:k(()=>[w("div",D,V(m.$t("验证码")),1),me.value.registType?(g(),T(v,{key:0,modelValue:me.value.emailCode,"onUpdate:modelValue":u[6]||(u[6]=e=>me.value.emailCode=e),class:"input-border-style",onFocus:u[7]||(u[7]=e=>se("emailCode"))},{suffix:k(()=>[y(C(R),{class:"mobile-code-text",email:me.value.email,mobileCodeSended:P.value,"onUpdate:mobileCodeSended":u[5]||(u[5]=e=>P.value=e),requestApi:C(F),onMobileErrorCallback:pe},null,8,["email","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])):(g(),T(v,{key:1,modelValue:me.value.mobileCode,"onUpdate:modelValue":u[9]||(u[9]=e=>me.value.mobileCode=e),class:"input-border-style",onFocus:u[10]||(u[10]=e=>se("mobileCode"))},{suffix:k(()=>[y(C(R),{class:"mobile-code-text",mobile:C(ue),mobileCodeSended:P.value,"onUpdate:mobileCodeSended":u[8]||(u[8]=e=>P.value=e),requestApi:C(M),onMobileErrorCallback:pe},null,8,["mobile","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])),y(b,{info:me.value.tigTips.mobileCode},null,8,["info"])]),_:1},8,["prop"]),y(c,{prop:"password"},{default:k(()=>[w("div",G,V(m.$t("设置密码")),1),y(v,{modelValue:me.value.password,"onUpdate:modelValue":u[11]||(u[11]=e=>me.value.password=e),class:"input-border-style","show-password":"",type:"password",onFocus:u[12]||(u[12]=e=>se("password"))},null,8,["modelValue"]),y(b,{info:me.value.tigTips.password},null,8,["info"])]),_:1}),w("div",H,[h(V(m.$t("点击注册，表示您同意"))+" ",1),y(q,{class:"font-color",target:"_blank",to:"/article/issue/info?articleSn=zcxy"},{default:k(()=>[h(" 《"+V(C(x)()?m.$t("{0}注册协议！",[C(U).shopName]):`${C(U).shopName}注册协议！`)+"》 ",1)]),_:1})]),y(c,{label:"",prop:"firstWord"},{default:k(()=>[y(A,{loading:de.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:ne},{default:k(()=>[h(V(m.$t("同意协议并注册")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])]),y(J,{bg:"white",type:0})],64)}}}),[["__scopeId","data-v-a6775f3f"]]);export{J as default};

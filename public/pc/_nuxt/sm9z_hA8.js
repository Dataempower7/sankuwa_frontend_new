import{_ as e}from"./IO9hpqeh.js";import{_ as l}from"./Dw0vWOz4.js";import{E as a}from"./YKVlRHu9.js";import{_ as o}from"./BPBPggU1.js";import{E as i}from"./mwh1qCMm.js";import{E as s}from"./5EY5iYNX.js";import{e as t,z as n,f as r,g as c,r as d,h as u,v as A,G as m,aw as v,B as g,y as p,H as b,ax as h,c as w,o as k,F as y,a as f,b as C,w as V,a9 as R,i as U,m as B,x as E,j as F,t as I,ay as S,n as L,az as M,aA as x,d as G,aa as j,q as z,E as N,aB as O,aC as Z,ad as D,p as Y,aD as T,aE as X,aF as J,_ as H,aG as K,l as q,k as W}from"./r4GZdGYg.js";import{M as Q,_ as P}from"./C1r_DWrf.js";import"./CBKhgGlL.js";import"./DXQ6s2L8.js";import{Q as _}from"./xSPxQ0UB.js";import{s as $}from"./DSXY0Md2.js";import{_ as ee}from"./Csg6w5sP.js";import{_ as le,e as ae}from"./DkwXwj3h.js";import"./70QeHNk8.js";import"./Bd103Yf7.js";import"./g8XVjk5f.js";import"./CIKxL71l.js";import"./DL5ZnEaR.js";import"./BNGL4P8m.js";import"./DONyGZrs.js";import"./VWWcEZs1.js";import"./CDFFSI_k.js";import"./DgAv7tgp.js";const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDRUJDNUJGMUNGRDlFNDExQjEyNUNBNjVFNTJGM0U4QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNTREQjI3NDNERTgxMUU3OTE2OUZBMDQ1MTdFNTJGRCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNTREQjI3MzNERTgxMUU3OTE2OUZBMDQ1MTdFNTJGRCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDE4MDExNzQwNzIwNjgxMTgyMkFCNzNBRTc2REZEOUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0VCQzVCRjFDRkQ5RTQxMUIxMjVDQTY1RTUyRjNFOEIiLz4gPC9yZGY6RGVzY3Jp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",ie=""+new URL("google.BMBUbSLn.png",import.meta.url).href,se=""+new URL("Facebook.C_w-5oy9.png",import.meta.url).href,te={class:"overseas-login-box flex align-center justify-end"},ne={class:"login-content"},re={class:"login-main"},ce={class:"menu"},de=["onClick"],ue={class:"content"},Ae={key:0,class:"form-box"},me={class:"form-item"},ve={class:"form-item-label"},ge={class:"form-item-input"},pe={class:"form-item"},be={class:"form-item-label"},he={class:"form-item-input"},we={key:0,class:"form-box"},ke={class:"form-item"},ye={class:"form-item-label"},fe={class:"form-item-input"},Ce={class:"form-item"},Ve={class:"form-item-label"},Re={class:"form-item-input"},Ue={key:0,class:"error-notice"},Be={class:"agreement-box"},Ee={class:"btn-box"},Fe={key:0,class:"text"},Ie={class:"other-login-img"},Se={class:"register"},Le={class:"register-text"},Me={class:"wechat-main-back-text"},xe={class:"tow-title"},Ge={class:"wechat-desc"},je={class:"two-image-box"},ze={key:0,class:"refresh-con"},Ne={class:"refresh-text"},Oe=H(t({__name:"OverseasLogin",setup(e){const{t:l}=n(),t=r(),H=c(),K=[{name:"账号登录",value:"password"},{name:"手机号登录",value:"mobile"}],q=d("password"),W=u({username:"",password:""}),ee=u({mobile:"",mobileCode:""}),le=d(!0),ae=d("86"),Oe=d(!1),Ze=d(""),De=d(!1),Ye=e=>{Ze.value=e},Te=d(!0),Xe=d(),Je=d(""),He=e=>{Je.value=e.verifyToken,Pe()},Ke=d(!1),qe=A(()=>"password"===q.value?""==W.username||""==W.password:""==ee.mobile||""==ee.mobileCode||0==Oe.value),We=m(),Qe=We.query.returnUrl?String(We.query.returnUrl):"/",Pe=()=>{if(!De.value)return Ze.value=l("请同意服务协议和隐私政策");(async()=>{try{Ke.value=!0;const e=await J({loginType:q.value,username:W.username,password:W.password,mobile:t.isOpenMobileAreaCode?ae.value+ee.mobile:ee.mobile,mobileCode:ee.mobileCode,verifyToken:Je.value});H.setToken(e.token),H.userInfoLoaded=!1,D(Qe,{replace:!0})}catch(e){1002==e.code?Xe.value&&Xe.value.show():e.code>0&&(Ze.value=e.message)}finally{Ke.value=!1}})()},_e=v("oauthPath"),$e=async e=>{_e.value=e;try{const l=await O(e,window.location.href);window.open(l,"_blank","width=500,height=700,top="+(screen.height/2-350))}catch(l){console.error(l)}},el=d(""),ll=d(""),al=d(0),ol=d(!1),il=d(!1);let sl;const tl=async e=>{try{const l=await T();sl&&clearInterval(sl),ll.value=l.url,el.value=l.ticket,await nl(l.url),le.value=e,ol.value=!0,il.value=!1,al.value=0,sl=$(()=>{al.value++,al.value>30&&(il.value=!0,clearInterval(sl)),rl()},1e3)}catch(l){}},nl=async e=>{const l=e;ll.value=await _.toDataURL(l,{margin:4})},rl=async()=>{const e=await X({key:el.value});(e.type>0||!1===ol.value)&&cl(),1==e.type&&(H.setToken(e.token),H.userInfoLoaded=!1,D("/member",{replace:!0})),2==e.type&&1===t.wechatRegisterBindPhone&&(H.openData=e.openData,D("/member/BindMobilePhone"))},cl=()=>{ol.value=!1,clearInterval(sl),sl=null,al.value=0},dl=()=>{le.value=!1,cl()};g(()=>{sl&&cl()});const ul=d(0);return p(()=>{const e=document.querySelector(".login-main");ul.value=e?e.clientHeight:0,console.log("height",ul.value)}),b(We.query,()=>{We.query.code&&(async e=>{try{const l=await Z(_e.value,window.location.href,e);H.setToken(l.token),H.userInfoLoaded=!1,D(Qe,{replace:!0})}catch(a){console.error(a),Y.error(l("授权失败"))}})(We.query)},{immediate:!0}),(e,l)=>{const n=a,r=h("MobileAreaCode"),c=o,d=i,u=s,A=N;return k(),w(y,null,[f("div",te,[f("div",ne,[C(S,{name:"slide-fade",onAfterLeave:l[15]||(l[15]=e=>le.value=!0)},{default:V(()=>[R(f("div",re,[f("div",ce,[(k(),w(y,null,B(K,(l,a)=>f("div",{key:a,class:E(["menu-item",{active:l.value===F(q)}]),onClick:e=>{return a=l.value,q.value=a,void(Te.value=!1);var a}},I(e.$t(l.name)),11,de)),64))]),f("div",ue,[C(S,{name:"slide-fade",onAfterLeave:l[3]||(l[3]=e=>Te.value=!0)},{default:V(()=>["password"===F(q)&&F(Te)?(k(),w("div",Ae,[f("div",me,[f("div",ve,I(e.$t("用户名/手机")),1),f("div",ge,[C(n,{modelValue:F(W).username,"onUpdate:modelValue":l[0]||(l[0]=e=>F(W).username=e),clearable:"",placeholder:e.$t(1===F(t).openEmailRegister?"用户名/手机/邮箱":"用户名/手机"),type:"text"},null,8,["modelValue","placeholder"])])]),f("div",pe,[f("div",be,[f("div",null,I(e.$t("密码")),1),f("div",{class:"special",onClick:l[1]||(l[1]=l=>e.$router.push("reset"))},I(e.$t("忘记密码？")),1)]),f("div",he,[C(n,{modelValue:F(W).password,"onUpdate:modelValue":l[2]||(l[2]=e=>F(W).password=e),clearable:"",placeholder:e.$t("密码"),"show-password":"",type:"password"},null,8,["modelValue","placeholder"])])])])):U("",!0)]),_:1}),C(S,{name:"slide-fade2",onAfterLeave:l[9]||(l[9]=e=>Te.value=!0)},{default:V(()=>["mobile"===F(q)&&F(Te)?(k(),w("div",we,[f("div",ke,[f("div",ye,I(e.$t("手机号")),1),f("div",fe,[C(n,{modelValue:F(ee).mobile,"onUpdate:modelValue":l[5]||(l[5]=e=>F(ee).mobile=e),clearable:"",placeholder:e.$t("您的手机号"),type:"text"},{prefix:V(()=>[F(t).isOpenMobileAreaCode?(k(),L(r,{key:0,modelValue:F(ae),"onUpdate:modelValue":l[4]||(l[4]=e=>M(ae)?ae.value=e:null)},null,8,["modelValue"])):U("",!0)]),_:1},8,["modelValue","placeholder"])])]),f("div",Ce,[f("div",Ve,I(e.$t("验证码")),1),f("div",Re,[C(n,{modelValue:F(ee).mobileCode,"onUpdate:modelValue":l[8]||(l[8]=e=>F(ee).mobileCode=e),placeholder:e.$t("请输入验证码"),type:"text"},{suffix:V(()=>[C(F(Q),{mobile:F(t).isOpenMobileAreaCode?F(ae)+F(ee).mobile:F(ee).mobile,mobileCode:F(ee).mobileCode,"onUpdate:mobileCode":l[6]||(l[6]=e=>F(ee).mobileCode=e),mobileCodeSended:F(Oe),"onUpdate:mobileCodeSended":l[7]||(l[7]=e=>M(Oe)?Oe.value=e:null),requestApi:F(x),class:"mobile-code-text",onMobileErrorCallback:Ye},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])])])])):U("",!0)]),_:1})]),F(Ze)?(k(),w("div",Ue,I(F(Ze)),1)):U("",!0),f("div",Be,[C(d,{modelValue:F(De),"onUpdate:modelValue":l[10]||(l[10]=e=>M(De)?De.value=e:null)},{default:V(()=>[l[18]||(l[18]=f("span",null,"我已阅读并同意",-1)),C(c,{class:"agreement-link",target:"_blank",to:"/article/issue/info?articleSn=fwxy"},{default:V(()=>[G("《"+I(e.$t("服务协议"))+"》 ",1)]),_:1}),l[19]||(l[19]=f("span",null,"和",-1)),C(c,{class:"agreement-link",target:"_blank",to:"/article/issue/info?articleSn=ysxy"},{default:V(()=>[G("《"+I(e.$t("隐私协议"))+"》 ",1)]),_:1})]),_:1,__:[18,19]},8,["modelValue"])]),f("div",Ee,[C(u,{disabled:F(qe),loading:F(Ke),class:"login-btn",type:"primary",onClick:Pe},{default:V(()=>[G(I(e.$t("登录")),1)]),_:1},8,["disabled","loading"]),1===F(t).openWechatOauth&&1===F(t).openWechatRegister||1===F(t).googleLoginOn||1===F(t).facebookLoginOn?(k(),w("div",Fe,I(e.$t("或")),1)):U("",!0),f("div",Ie,[1===F(t).openWechatOauth&&1===F(t).openWechatRegister?(k(),w("div",{key:0,class:"login-img",onClick:l[11]||(l[11]=e=>tl(!1))},l[20]||(l[20]=[f("img",{src:oe,alt:"",class:"login-img"},null,-1)]))):U("",!0),F(t).googleLoginOn?(k(),w("div",{key:1,class:"login-img googleRight",onClick:l[12]||(l[12]=e=>$e("google"))},l[21]||(l[21]=[f("img",{src:ie,alt:"",class:"login-img"},null,-1)]))):U("",!0),F(t).facebookLoginOn?(k(),w("div",{key:2,class:"login-img",onClick:l[13]||(l[13]=e=>$e("facebook"))},l[22]||(l[22]=[f("img",{src:se,alt:"",class:"login-img"},null,-1)]))):U("",!0)])]),f("div",Se,[f("div",Le,I(e.$t("还没有账号？")),1),f("div",{class:"register-btn",onClick:l[14]||(l[14]=l=>e.$router.push("register"))},I(e.$t("去注册")),1)])],512),[[j,!1===F(ol)&&F(le)]])]),_:1}),C(S,{name:"slide-fade2",onAfterLeave:l[17]||(l[17]=e=>le.value=!0)},{default:V(()=>[R(f("div",{style:z({height:`${F(ul)}px`}),class:"wechat-main"},[f("div",{class:"wechat-main-back",onClick:dl},[l[23]||(l[23]=f("span",{class:"iconfont-pc icon-shangjiantou"},null,-1)),f("span",Me,I(e.$t("返回")),1)]),f("div",xe,I(e.$t("扫码登录")),1),f("div",Ge,I(e.$t("请使用微信移动端扫描二维码")),1),f("div",je,[F(il)?(k(),w("div",ze,[f("div",Ne,I(e.$t("二维码已失效")),1)])):U("",!0),C(A,{fit:"cover",class:"two-image",src:F(ll)},null,8,["src"])]),f("div",{class:"refresh-qecode",onClick:l[16]||(l[16]=e=>tl(!0))},[l[24]||(l[24]=f("span",{class:"iconfont-pc icon-svg27"},null,-1)),f("span",null,I(e.$t("刷新二维码")),1)]),f("div",{onClick:cl,class:"qiehuan"})],4),[[j,F(ol)&&F(le)]])]),_:1})])]),C(P,{ref_key:"verify",ref:Xe,imgSize:{width:"310px",height:"155px"},captchaType:"blockPuzzle",mode:"pop",onOkCallback:He},null,512)],64)}}}),[["__scopeId","data-v-44a7d9f2"]]),Ze={class:"login-center flex align-center justify-end"},De={class:"login_border"},Ye={key:0,class:"login-main"},Te={class:"login-title-box"},Xe={class:"login-title"},Je={key:0,class:"register-box"},He={class:""},Ke={class:"login-top flex align-center justify-between"},qe={class:"login-tab flex align-center hand-pointer"},We={class:"login-body"},Qe={key:0,class:"login-mode-normal"},Pe={class:"login-input flex align-center"},_e={class:"login-input flex align-center"},$e={class:"login-mode-normal"},el={class:"login-input flex align-center"},ll={key:1,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAbwAAAG8B8aLcQwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFzSURBVFiF7ZexSwMxFMa/3F3a0kLVrZubFAfRraNr15KCtEv/BHVydXBw0a5uXa5Ic7eJ4OZ/IDi5ScGhmyI91Avec2nB4Xq9XNU65JsC+fK9H8kb8hgRYZly5hl6vV6hVCqtZgkPguCl0+m8J3lY0g1IKQ8BHAD4zAIAwAZw3mw2z7QB+v3+Guf8LgzDrXa7/Zqluuu65Vwud6+U2mm1Ws9xnplPwDlfBzDK5/M1KeUFAKZZP3IcRwAYTbL0AL5pE8AVgBOd6kR0atv2xrwmTwMAxlgghBjpAAwGg7c0Pksn9DdkAAyAATAABsAAGIClA6T6kBBRTUp5pBPMGNsGcLswgGVZXhRFK1EUFTQBrsMwvOGc7y8E0Gg0ngAcx+15nrcHAEKIy1nnpZSJ+Zl7wPf9KhF1iajr+341a06qHohTsVh8HI/HD9P1jwMopYac84rruuW4waRer38A2E0KnwwmFaXUcJbn/45mUy11OP0LfQH1UI9HR+JVhwAAAABJRU5ErkJggg=="},al={class:"login-input flex align-center"},ol={key:1,class:"error-notice"},il={class:"agreement-box"},sl={class:"login_last"},tl={key:2,class:"forget-text"},nl={key:3,class:"login_bottom"},rl={class:"tit"},cl={class:"other-login"},dl={key:1,class:"login-main wechat-main"},ul={class:"tow-title"},Al=H(t({__name:"BaseLogin",setup(e){const l=c(),t=m(),n=t.query.returnUrl?String(t.query.returnUrl):"/",u=r();u.loadNav();const v=d(1),b=d(""),h=d(""),y=d(""),B=d(""),S=d(!1),M=d(!1),z=d(""),O=d(),Z=d(""),Y=d(0),H=d(0),q=d(!1),W=d("86");p(()=>{re()});const le=()=>{if(!q.value)return Z.value="请同意服务协议和隐私政策";ae()},ae=async()=>{try{M.value=!0;const e=await J({loginType:1===v.value?"password":"mobile",username:b.value,password:h.value,mobile:u.isOpenMobileAreaCode?W.value+y.value:y.value,mobileCode:B.value,verifyToken:z.value});l.setToken(e.token),l.userInfoLoaded=!1,D(n,{replace:!0})}catch(e){1002==e.code?O.value.show():e.code>0&&(Z.value=e.message)}finally{M.value=!1}},ie=e=>{z.value=e.verifyToken,le()},se=A(()=>1==v.value?""==b.value||""==h.value:""==y.value||""==B.value||0==S.value),te=e=>{v.value=e,Z.value=""},ne=e=>{Z.value=e},re=async()=>{const e=await K();Y.value=e.showOauth,H.value=e.wechatLogin},ce=d(!1),de=d(1),ue=d(""),Ae=d(0),me=d("");let ve;const ge=async()=>{ce.value=!0,de.value=2;try{const e=await T();e.url&&(me.value=e.ticket,await be(e.url),ve&&clearInterval(ve),Ae.value=0,ve=$(()=>{Ae.value++,he()},1e3))}catch(e){console.log(e)}finally{ce.value=!1}},pe=()=>{de.value=1,clearInterval(ve),ve=null,Ae.value=0},be=async e=>{const l=e;ue.value=await _.toDataURL(l,{margin:10})},he=async()=>{const e=await X({key:me.value});(e.type>0||2!==de.value)&&(clearInterval(ve),ve=null,Ae.value=0),1==e.type&&(l.setToken(e.token),l.userInfoLoaded=!1,D("/member",{replace:!0})),2==e.type&&1===u.wechatRegisterBindPhone&&(l.openData=e.openData,D("/member/BindMobilePhone"))};function we(e){"Enter"!==e.key||se.value||(console.log("Enter key pressed"),le())}return p(()=>{document.addEventListener("keydown",we)}),g(()=>{document.removeEventListener("keydown",we),ve&&clearInterval(ve)}),(e,l)=>{const t=o,n=a,r=i,c=s,d=N;return k(),w("div",Ze,[f("div",De,[1==de.value?(k(),w("div",Ye,[f("div",Te,[f("div",Xe,I(e.$t("欢迎登录")),1),0===F(u).shopRegClosed?(k(),w("div",Je,[f("span",He,I(e.$t("没有账号？")),1),C(t,{class:"register-main-text",to:"/member/register/"},{default:V(()=>[G(I(e.$t("去注册")),1)]),_:1})])):U("",!0)]),f("div",Ke,[f("div",qe,[f("div",{class:E([1==v.value?"login-on":"","login_mode"]),onClick:l[0]||(l[0]=e=>te(1))},I(e.$t("普通登录")),3),f("div",{class:E([2==v.value?"login-on":"","login_mode"]),onClick:l[1]||(l[1]=e=>te(2))},I(e.$t("手机登录")),3)])]),f("div",We,[1==v.value?(k(),w("div",Qe,[f("div",Pe,[C(n,{modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),clearable:"",placeholder:e.$t(1===F(u).openEmailRegister?"用户名/手机/邮箱":"用户名/手机"),type:"text"},{prefix:V(()=>l[12]||(l[12]=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAbwAAAG8B8aLcQwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAN/SURBVFiFxZdBaBxVGMd/30wgbSwm1/SwRKlaE0HM1kKVoiB4WlTCPMISYk8qaOnFYluwhIVIa2lP1V56SS2BWd6yRBFaBClStFJLqCBJhaJuD01LKIg0LSk783nYt5KmndnOJMXvNsz3//9/7817M29EVfk/qyuPqFKpeIODg1tFZBuAql6am5u7MjExEWf1kiwzUKvV3lTVT4Fh4IlVt5eAWRGZDILgu3UFmJ6efrK7u/uoqr4HxMAVEZmN43gWwPO8YVUdBrYCnoicXF5e3js2NvbPmgGstVuA74EC8Fscx7tGR0dnH9ZbrVaHPc87BbwAXAPeMMZcTfP30m5WKhUPmAIKqnoMKCaFA7h7RddbAKacR2KlzkCtVvtYVY8CXxtj3kkzWl3W2hngbRHZGwTBsaS+RDprbUFVJ4FbzWbzgyzhAE5zS1UnrbWFzAAi8jqwQVUPl8vlm1kByuXyTVU9DGxwXtkAgKID+TlreLtWaIuZAVS1SGvLXc4L4LSx88oGADwPLBhjbudNd9oF55UZYBHot9ZuygvgtP3OKzPAn7Teai/lBXBaz3llBjgLEMfxK3kBVmjP5gGoApGI7A/DcHPW8DAMN4vIfiByXtkAjDE3RGQf0Of7/smsAE7TJyL7jDE3kvoe5WP0FTAOfAF8Yoy526F/I3AE2A2cNsa8m9af+qEAWFpaeh+46AwvW2t3pITvoLX3dwMXnTa1Op6IGo3GvaGhoXOquh14FvjJWntVVS+JyC8AqvqyOx1taetE5Fyj0bjXyT/1EVhrnwJOATuBpqqeFpGn3fXq2YuB86r6h4iMu8GdB3YZYxK3YSKAtfY14FtgE/ANref/O0C9Xu+PouhFVR1wo/3L9/1fR0ZGFpz2OVrr4C3gNlAyxvzwyADW2kHgR1qr+KMgCE4kjSCtarXah6r6JfA38KoxZm51zwOLsF6v9wNnXPievOEAQRCcEJE9QB9wxnmnAzSbzc9oHcEOBUFwPG/4CojjqnoIKDjvZIAwDAfcArre09Mzudbwdjmv6yIyHobhQCKA7/sHgC5VPVgqle6sF0CpVLqjqgeBLpfxUAABRoHF+fn5qfUKb5fzXHQZ8gBAtVp9BugFLuT5xepUzvMC0Ouy7gfwPG8brO0M2Kna3u0suP9VvCgin0dRNPO4AKIomvF9v1dV/zshZfo5fRz1L43KgKdhFrX9AAAAAElFTkSuQmCC"},null,-1)])),_:1},8,["modelValue","placeholder"])]),f("div",_e,[C(n,{modelValue:h.value,"onUpdate:modelValue":l[3]||(l[3]=e=>h.value=e),placeholder:e.$t("密码"),"show-password":"",type:"password"},{prefix:V(()=>l[13]||(l[13]=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAbwAAAG8B8aLcQwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJbSURBVFiFxdc9iBZXGAXgZ6NoYRAFQUUkQZAYLMSEaBYLRUJA7WJeLBX8KwRJFRL8wwhqK4KIGqys3iZE0SaKFusvrqiNiaAWEcVgowgGDGsxs/Jp5tv9ZnZiTjPcO3fOOXPmvXfu7RsaGtIEmTkbCzEXv+N6RDyqy9NX10BmrsN+TK+4/Sd+iIgTrRvIzFk4ihV4hrO4jj/wKRZhGSbhF2yOiCetGMjMiaXYfJzGpoh4WDHuY/yM5RjE4oh4NRL3B6OqF9hdiu+LiFVV4hARD/AVDuAz/Dga8agJZOZCXMMN9I/2RuUzw4nNxYKIuNNtbC8JrMI4bOhFHCLib2zBBEXNdEUvBr7A04i42Yt4BwbwEp+P1cAiRZy1UKZ1qw0DM3C/roES9zFzrAb+U/zvBrpOw8zsV6xse3Eb5xrwr8BH2IXfIuJftVRpIDP3YHsDwZEwhG0RsW9EA5k5X/HG6zUvvip8gkOYFxF3hzvHVwxcir6ION6iuMy8jMNYjDcGqopwcpvCFfiws1GVQE8oNyQ7FL/i2/gpIh7X5Wk0DTNzBs7jL3yP5xjIzGl1uZom8B1ORcS2sn2pFN+KnXWImi5EcxQJdOKsotJroamBQXzzTt8aXKlL1PQTHMSFzPwVJ7EaUxTzvBYaJRARL/Al7uCIYse0JCJevhcDpYlXuFg2ByLinyY8Y/0bXsEZDTYsw2i8EEF5Elo5Fo6qBGp/x5p4i78qgauQmUsUR622MKe8DnZ2dtsPJL5tUXwYxyJiY2dHtxpYg7X4GlNbEL6HoxFx490btU/HbeM1FHm9Y65npM0AAAAASUVORK5CYII="},null,-1)])),_:1},8,["modelValue","placeholder"])])])):U("",!0),R(f("div",$e,[f("div",el,[C(n,{modelValue:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>y.value=e),clearable:"",placeholder:e.$t("您的手机号"),type:"text"},{prefix:V(()=>[F(u).isOpenMobileAreaCode?(k(),L(ee,{key:0,modelValue:W.value,"onUpdate:modelValue":l[4]||(l[4]=e=>W.value=e)},null,8,["modelValue"])):(k(),w("img",ll))]),_:1},8,["modelValue","placeholder"])]),f("div",al,[C(n,{modelValue:B.value,"onUpdate:modelValue":l[8]||(l[8]=e=>B.value=e),placeholder:e.$t("请输入验证码"),type:"text"},{prefix:V(()=>l[14]||(l[14]=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAbwAAAG8B8aLcQwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIjSURBVFiF7ZY/iBNBFMa/mb0YEPFSbCIniNeJpSCx3avtkp1FBK84MNjFQvCsrQSLAyuDFopIkreLKQK2C6KQCFrEwkoQ5K7YgOk23MZ9FncLm5hczB9MwHzlzPC+38x782YEM2ORkgt1XwGsAACsDRsslUqJVCqVlVIm5mEShmHQ6XSahUIhGJwTg9eQiG4CeAxgYx7mMR0AuKeUej0SwHXdNc/zvgM4YOY9IcQfxNOImRNCiLsANtLp9EXDMHrRXF8K2u12FsB5ALuWZb2ah3kkIhIAXh57fIjGB4vwFABEOyeidSLKTmtaLpc3iehSPGbkMQqgT8y8BaBBRDYRrU9ibtv2tqZpXwA8PWndiQCZTKYuhHgEIAfgk+M4V8cZ1+v107ZtP2fmFwC+SSnvTA1gGEbPNM1dIcR1AGfDMHxPRMVR6yuVymXf9xvMvMPMzwBcy+fzX6cGiGSa5ltN064AaALYI6I3tVotFV9j2/a2lPIjgE1mvmVZ1m2llD8u9tBGNEy5XO6H67pbnuc9BHA/CILPjuPcSCaTrW63+4SZdwC0pJTWuF3HNVErNgyjp5R6cJySM2EYvvN9vzXJkc8EECmWkgaAc5Mc+VwAgKOUADCCILgwS9P66xoYJqXULwA/Z4mx8Od46QAOgaPXa95GsZiH8fG+GtB1vel53j6AYrVa5Tk/x0UA+7quN+Nzy/UhibTQL9m/1tLdghXA/wfwG5UF+daMCa/TAAAAAElFTkSuQmCC"},null,-1)])),suffix:V(()=>[C(F(Q),{mobile:F(u).isOpenMobileAreaCode?W.value+y.value:y.value,mobileCode:B.value,"onUpdate:mobileCode":l[6]||(l[6]=e=>B.value=e),mobileCodeSended:S.value,"onUpdate:mobileCodeSended":l[7]||(l[7]=e=>S.value=e),requestApi:F(x),class:"mobile-code-text",onMobileErrorCallback:ne},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue","placeholder"])])],512),[[j,2===v.value]]),Z.value?(k(),w("div",ol,I(Z.value),1)):U("",!0),f("div",il,[C(r,{modelValue:q.value,"onUpdate:modelValue":l[9]||(l[9]=e=>q.value=e)},{default:V(()=>[f("span",null,I(e.$t("我已阅读并同意")),1),C(t,{class:"agreement-link",target:"_blank",to:"/article/issue/info?articleSn=fwxy"},{default:V(()=>[G("《"+I(e.$t("服务协议"))+"》 ",1)]),_:1}),f("span",null,I(e.$t("和")),1),C(t,{class:"agreement-link",target:"_blank",to:"/article/issue/info?articleSn=ysxy"},{default:V(()=>[G("《"+I(e.$t("隐私协议"))+"》 ",1)]),_:1})]),_:1},8,["modelValue"])]),f("div",sl,[C(c,{disabled:F(se),loading:M.value,class:"login_btn submit_btn",type:"primary",onClick:le},{default:V(()=>[G(I(e.$t("登录")),1)]),_:1},8,["disabled","loading"])]),1===v.value?(k(),w("div",tl,[f("a",{onClick:l[10]||(l[10]=l=>e.$router.push("/member/reset"))},I(e.$t("忘记密码？")),1)])):U("",!0),1===Y.value&&1===F(u).openWechatOauth&&1===F(u).openWechatRegister?(k(),w("div",nl,[f("div",rl,I(e.$t("合作网站账号登录")),1),f("li",cl,[1==H.value?(k(),w("a",{key:0,onClick:ge},l[15]||(l[15]=[f("img",{height:"32",src:oe,width:"32"},null,-1)]))):U("",!0)])])):U("",!0),C(P,{ref_key:"verify",ref:O,imgSize:{width:"310px",height:"155px"},captchaType:"blockPuzzle",mode:"pop",onOkCallback:ie},null,512)]),1===F(u).openWechatOauth&&1===F(u).openWechatRegister?(k(),w("div",{key:0,onClick:ge,class:"qiehuan1"})):U("",!0)])):U("",!0),2==de.value?(k(),w("div",dl,[f("div",ul,I(e.$t("使用微信扫码安全登录")),1),f("div",null,[C(d,{fit:"cover",class:"two-image",src:ue.value},{placeholder:V(()=>l[16]||(l[16]=[f("div",{class:"image-text"},"加载中...",-1)])),error:V(()=>l[17]||(l[17]=[f("div",{class:"image-text"},"加载中...",-1)])),_:1},8,["src"])]),f("div",null,[C(c,{style:{width:"140px"},type:"primary",onClick:l[11]||(l[11]=e=>ge())},{default:V(()=>[G(I(e.$t("刷新二维码")),1)]),_:1})]),f("div",{onClick:pe,class:"qiehuan"})])):U("",!0)])])}}}),[["__scopeId","data-v-a63b0552"]]),ml=H(t({__name:"Login",setup(a){c().isAuthenticated&&D("/",{replace:!0});const o=d("");return(async()=>{try{const e=await ae({decorateSn:"pcUserLogin"});o.value=e.data.backgroundPic.picUrl}catch(e){}})(),(a,i)=>{const s=e,t=l,n=Oe,r=Al,c=le;return k(),w(y,null,[C(s,{title:"登录"}),C(t,{type:"login"}),f("div",{style:z({backgroundImage:`url(${F(W)(F(o))})`}),class:"login-warp"},[F(q)()?(k(),L(n,{key:0})):(k(),L(r,{key:1}))],4),C(c,{type:2})],64)}}}),[["__scopeId","data-v-e1f2d0c5"]]);export{ml as default};

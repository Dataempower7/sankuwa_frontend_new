import{_ as R}from"./Drr4mNEN.js";import{_ as T}from"./paAvucAg.js";import{_ as U}from"./CBcH1uzJ.js";import{e as q,G as L,r as i,z as M,y as O,p as g,ah as I,T as Q,c as s,o as n,b as c,a as t,t as o,j as a,d as u,i as l,E as A,_ as D}from"./BjkHNVA8.js";import{_ as F}from"./B85mN9rA.js";import{E as H}from"./Csy7st1x.js";import"./B_vjKAZC.js";/* empty css        */import"./Ibc-iJtI.js";import{a as j,o as G,c as W}from"./Dk0-O2Ek.js";import{Q as Y}from"./OUv6bgZh.js";import{w as J,z as K}from"./DzflT03m.js";import{s as X}from"./x_rD_Ya3.js";import"./XdJ5ILcf.js";import"./BipSnJcb.js";import"./n1vI1_Nv.js";import"./BNVM5YSV.js";import"./BhwkTUtM.js";import"./d3UjsK-T.js";import"./BKu6lkEW.js";import"./BIqqf5dq.js";import"./CH9-T1LE.js";import"./yB3A8U-z.js";import"./CXwPJP5h.js";import"./UVx7YjW9.js";const Z={class:"wechat-com"},x={class:"wechat container"},ee={class:"message"},oe={class:"message"},te={class:"payment"},ae={key:0,class:"title"},se={key:1,class:"title"},ne={class:"image-div"},re={class:"left-image"},ie={key:0,class:"ewm"},ce={key:1,class:"ewm-empty"},le={class:"pw-box-ft"},me={key:0},de={key:1},pe={class:"right-image"},_e={key:0,class:"image"},ue={key:1,class:"image"},ye=q({__name:"yabanpay",setup(fe){const w=L(),y=i(w.query.id),r=i(w.query.type),k=i(!0);i({});const $=i(""),m=i({}),{t:d}=M();(async()=>{try{const e=await G({id:y.value});m.value=e.order}catch(e){g.error(e.message),I("/member/order/list/")}finally{}})();const b=async()=>{k.value=!0;try{const e=await W({id:y.value,type:"yabanpay_"+r.value});B(e?.payInfo.codeUrl)}catch(e){g.error(e.message)}finally{k.value=!1}},f=i(0);let p=null;O(()=>{b(),p=X(()=>{P(),f.value++,f.value===50&&(clearInterval(p),g.error(d("支付已超时，您可以刷新页面重新支付")))},2e3)});const P=()=>{j({id:y.value}).then(e=>{e==1&&(clearInterval(p),H.confirm(d("订单支付成功"),d("提示"),{confirmButtonText:d("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{I("/member/order/list")}).catch(()=>{}))})},B=async e=>{const _=e;let v={margin:1,width:500,height:500};$.value=await Y.toDataURL(_,v)},V=()=>{window.close()},C=()=>{window.location.reload()};return Q(()=>{clearInterval(p)}),(e,_)=>{const v=R,S=T,E=U,h=A,z=F;return n(),s("div",null,[c(v,{title:"YabandPay"}),c(S,{showLogin:!1}),t("div",Z,[t("div",x,[t("div",ee,o(e.$t("订单提交成功，请尽快付款"))+"！"+o(e.$t("订单号"))+"："+o(a(m).orderSn),1),t("div",oe,[u(o(e.$t("应付金额"))+"： ",1),c(E,{modelValue:a(m).totalAmount,"onUpdate:modelValue":_[0]||(_[0]=N=>a(m).totalAmount=N),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),t("div",te,[a(r)=="wechat"?(n(),s("div",ae,o(e.$t("微信支付")),1)):l("",!0),a(r)=="alipay"?(n(),s("div",se,o(e.$t("支付宝支付")),1)):l("",!0),t("div",ne,[t("div",re,[t("div",null,[u(o(e.$t("如果二维码已过期"))+"，"+o(e.$t("请")),1),t("span",{onClick:C,class:"font-color",style:{cursor:"pointer"}},o(e.$t("刷新")),1),u(o(e.$t("页面重新获取二维码"))+"。 ",1)]),a(f)<=50?(n(),s("div",ie,[c(h,{class:"image",src:a($)},null,8,["src"])])):(n(),s("div",ce,[u(o(e.$t("已超时"))+"，",1),t("a",{class:"font-color",onClick:C},o(e.$t("点击刷新")),1)])),t("div",le,[a(r)=="wechat"?(n(),s("div",me,o(e.$t("请使用微信扫一扫")),1)):l("",!0),a(r)=="alipay"?(n(),s("div",de,o(e.$t("请使用支付宝扫一扫")),1)):l("",!0),t("div",null,o(e.$t("扫描二维码支付")),1)])]),t("div",pe,[a(r)=="wechat"?(n(),s("div",_e,[c(h,{src:a(J)},null,8,["src"])])):l("",!0),a(r)=="alipay"?(n(),s("div",ue,[c(h,{src:a(K)},null,8,["src"])])):l("",!0)])]),t("div",{onClick:V,class:"button-title"},"< "+o(e.$t("选择其他支付方式")),1)])])]),c(z,{bg:"white",mt30:!1,type:1})])}}}),Fe=D(ye,[["__scopeId","data-v-06ee2e5c"]]);export{Fe as default};
